(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("request"),require("xmldom"),require("itowns")):"function"==typeof define&&define.amd?define("Gp",["require","require","itowns"],t):"object"==typeof exports?exports.Gp=t(require("request"),require("xmldom"),require("itowns")):e.Gp=t(e[void 0],e[void 0],e.itowns)})(window,function(e,t,o){return function(e){function t(n){if(o[n])return o[n].exports;var a=o[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var o={};return t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var a in e)t.d(n,a,function(t){return e[t]}.bind(null,a));return n},t.n=function(e){var o=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){function o(e,t){for(var a in e)e.hasOwnProperty(a)&&(t.hasOwnProperty(a)?"object"===n(e[a])&&o(e[a],t[a]):t[a]=e[a])}return o(e,t)}o.r(t),o.d(t,"Services",function(){return A}),o.d(t,"Error",function(){return L}),o.d(t,"Helper",function(){return I}),o.d(t,"Protocols",function(){return w}),o.d(t,"servicesDate",function(){return T}),o.d(t,"servicesVersion",function(){return N}),o.d(t,"itownsExtVersion",function(){return O}),o.d(t,"itownsExtDate",function(){return M}),o.d(t,"itownsExtended",function(){return D});var r=o(1),s=o.t(1,1),i=o(2),l=o(20),d=o(28),p=o(143),c=o(146),u=o(148),m=o(151),g=o(153),f=o(155),y=o(156),_=o(157),E=o(158),h=o(133),b=o(142),S=o(159),P=o(34),R=o(149);o.d(t,"LayerUtils",function(){return R["default"]});var x=o(160);o.d(t,"ProxyUtils",function(){return x["default"]});var v=o(161);o.d(t,"ColorUtils",function(){return v["default"]});var C=o(162);o.d(t,"MathUtils",function(){return C["default"]});var A=P["default"].Services,L=P["default"].Error,I=P["default"].Helper,w=P["default"].Protocols,T=P["default"].servicesDate,N=P["default"].servicesVersion,O=r.itownsExtVersion,M=r.date,D={};D.control={},D.control.MousePosition=d["default"],D.control.LayerSwitcher=p["default"],D.control.BoostRelief=c["default"],D.control.Attributions=u["default"],D.control.Scale=m["default"],D.control.MiniGlobe=g["default"],D.layer={},D.layer.GeoportalWMTS=f["default"],D.layer.GeoportalWMS=y["default"],D.layer.GeoportalElevation=_["default"],D.layer.VectorTileLayer=E["default"],D.CRS=b["default"],D.GlobeViewExtended=h["default"],window.itowns&&(a(D,window.itowns),a(window.itowns,D))},function(e){e.exports=JSON.parse("{\"name\":\"geoportal-extensions\",\"description\":\"French Geoportal Extensions for OpenLayers, Leaflet and iTowns libraries\",\"version\":\"2.2.15\",\"date\":\"01/07/2020\",\"leafletExtName\":\"French Geoportal Extension for Leaflet\",\"leafletExtVersion\":\"2.1.6\",\"olExtName\":\"French Geoportal Extension for OpenLayers\",\"olExtVersion\":\"3.0.11\",\"itownsExtName\":\"French Geoportal Extension for Itowns\",\"itownsExtVersion\":\"2.2.10\",\"main\":\"dist/leaflet/GpPluginLeaflet.js, dist/openlayers/GpPluginOpenLayers.js, dist/itowns/GpPluginItowns.js\",\"module\":\"src/Leaflet/index.js, src/OpenLayers/index.js, src/Itowns/index.js\",\"directories\":{},\"scripts\":{\"setup\":\"npm install\",\"clean\":\"echo \\\"Warning: target not yet implemented!\\\" && exit 0\",\"eslint\":\"eslint src/\",\"test\":\"npm run test:serve\",\"test:serve\":\"cd test && webpack-dev-server --hot --config webpack.test.serve.js\",\"sample\":\"npm run sample:serve\",\"sample:serve\":\"npm run sample:ol:serve\",\"sample:itowns:serve\":\"webpack-dev-server --config build/webpack/webpack.config.itowns --https --open-page samples/index-itowns-map.html --content-base . --output-public-path '/dist/itowns/' --port 9001 --open 'google-chrome'\",\"sample:leaflet:serve\":\"webpack-dev-server --config build/webpack/webpack.config.leaflet --https --open-page samples/index-leaflet-map.html --content-base . --output-public-path '/dist/leaflet/' --port 9001 --open 'google-chrome'\",\"sample:ol:serve\":\"webpack-dev-server --config build/webpack/webpack.config.openlayers --https --open-page samples/index-openlayers-map.html --content-base . --output-public-path '/dist/openlayers/' --port 9001 --open 'google-chrome'\",\"doc\":\"npm run doc:serve\",\"doc:serve\":\"npm run doc:ol:serve\",\"doc:itowns:serve\":\"webpack-dev-server --config build/webpack/webpack.config.itowns --content-base jsdoc/itowns --port 9001 --open\",\"doc:leaflet:serve\":\"webpack-dev-server --config build/webpack/webpack.config.leaflet --content-base jsdoc/leaflet --port 9001 --open\",\"doc:ol:serve\":\"webpack-dev-server --config build/webpack/webpack.config.openlayers --content-base jsdoc/openlayers --port 9001 --open\",\"build:dev\":\"npm-run-all --print-label --print-name build:*:dev\",\"build:prod\":\"npm-run-all --print-label --print-name build:*:prod\",\"build:src\":\"npm-run-all --print-label --print-name build:*:src\",\"build\":\"npm-run-all --print-label --print-name build:*:*\",\"build:itowns\":\"npm-run-all --print-label --print-name build:itowns:*\",\"build:itowns:dev\":\"webpack --config build/webpack/webpack.config.itowns --mode=development\",\"build:itowns:prod\":\"webpack --config build/webpack/webpack.config.itowns --mode=production\",\"build:itowns:src\":\"webpack --config build/webpack/webpack.config.itowns --mode=none\",\"build:ol\":\"npm-run-all --print-label --print-name build:ol:*\",\"build:ol:dev\":\"webpack --config build/webpack/webpack.config.openlayers --mode=development\",\"build:ol:prod\":\"webpack --config build/webpack/webpack.config.openlayers --mode=production\",\"build:ol:src\":\"webpack --config build/webpack/webpack.config.openlayers --mode=none\",\"build:leaflet\":\"npm-run-all --print-label --print-name build:leaflet:*\",\"build:leaflet:dev\":\"webpack --config build/webpack/webpack.config.leaflet --mode=development\",\"build:leaflet:prod\":\"webpack --config build/webpack/webpack.config.leaflet --mode=production\",\"build:leaflet:src\":\"webpack --config build/webpack/webpack.config.leaflet --mode=none\"},\"repository\":{\"type\":\"git\",\"url\":\"https://github.com/IGNF/geoportal-extensions.git\"},\"author\":\"IGNF\",\"keywords\":[\"geoportail\",\"javascript\",\"OpenLayers\",\"Leaflet\",\"Itowns\",\"3D\"],\"license\":\"CECILL-B\",\"bugs\":{\"url\":\"https://github.com/IGNF/geoportal-extensions/issues\"},\"homepage\":\"https://github.com/IGNF/geoportal-extensions#readme\",\"dependencies\":{\"@mapbox/mapbox-gl-style-spec\":\"13.11.0\",\"eventbusjs\":\"0.2.0\",\"geoportal-access-lib\":\"2.1.6\",\"itowns\":\"2.25.0\",\"leaflet\":\"1.5.1\",\"leaflet-draw\":\"1.0.4\",\"loglevel\":\"^1.6.7\",\"ol\":\"5.3.0\",\"ol-mapbox-style\":\"4.2.1\",\"proj4\":\"^2.6.2\",\"proj4leaflet\":\"1.0.2\",\"sortablejs\":\"1.8.4\",\"three\":\"^0.117.1\",\"whatwg-fetch\":\"3.0.0\"},\"devDependencies\":{\"@babel/core\":\"^7.4.4\",\"@babel/plugin-transform-template-literals\":\"^7.7.4\",\"@babel/preset-env\":\"^7.4.4\",\"babel-loader\":\"^8.0.5\",\"chai\":\"^4.2.0\",\"chalk\":\"^4.0.0\",\"clean-webpack-plugin\":\"^3.0.0\",\"copy-webpack-plugin\":\"^5.0.3\",\"core-js\":\"^3.6.4\",\"css-loader\":\"^3.4.2\",\"eslint\":\"^6.8.0\",\"eslint-config-standard\":\"^14.1.1\",\"eslint-loader\":\"^4.0.0\",\"eslint-plugin-import\":\"^2.17.2\",\"eslint-plugin-node\":\"^11.1.0\",\"eslint-plugin-promise\":\"^4.1.1\",\"eslint-plugin-standard\":\"^4.0.0\",\"exports-loader\":\"^0.7.0\",\"expose-loader\":\"^0.7.5\",\"fs-extra\":\"^9.0.0\",\"handlebars\":\"^4.7.5\",\"handlebars-layouts\":\"^3.1.4\",\"html-webpack-plugin\":\"^4.0.4\",\"jsdoc-webpack-plugin\":\"^0.3.0\",\"mini-css-extract-plugin\":\"^0.9.0\",\"mocha\":\"^7.1.1\",\"mocha-loader\":\"^5.0.0\",\"npm-run-all\":\"^4.1.5\",\"optimize-css-assets-webpack-plugin\":\"^5.0.1\",\"path\":\"^0.12.7\",\"replace-bundle-webpack-plugin\":\"^1.0.0\",\"requirejs\":\"^2.3.6\",\"responsive-loader\":\"^1.2.0\",\"speed-measure-webpack-plugin\":\"^1.3.0\",\"string-template\":\"^1.0.0\",\"style-loader\":\"^1.1.3\",\"terser-webpack-plugin\":\"^2.0.0\",\"url-loader\":\"^4.0.0\",\"webpack\":\"^4.30.0\",\"webpack-cli\":\"^3.3.1\",\"webpack-dev-server\":\"^3.3.1\",\"webpack-node-externals\":\"^1.7.2\"}}")},function(e,t,o){"use strict";o.r(t);var n=o(3),a=o.n(n),r=o(4),s=o.n(r),i=o(5),l=o.n(i),d=o(6),p=o.n(d),c=o(7),u=o.n(c),m=o(8),g=o.n(m),f=o(9),y=o.n(f),_=o(10),E=o.n(_),h=o(11),b=o.n(h),S=o(12),P=o.n(S),R=o(13),x=o.n(R),v=o(14),C=o.n(v),A=o(15),L=o.n(A),I=o(16),w=o.n(I),T=o(17),N=o.n(T),O=o(18),M=o.n(O),D=o(19),G=o.n(D)},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(e,t,o){"use strict";o.r(t);var n=o(21),a=o.n(n),r=o(22),s=o.n(r),i=o(23),l=o.n(i),d=o(24),p=o.n(d),c=o(25),u=o.n(c),m=o(26),g=o.n(m),f=o(27),y=o.n(f)},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e){if(e=e||{},!(this instanceof a))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(e&&"object"!==n(e))throw new Error("ERROR WRONG_TYPE : options should be an object");this._initialize(e),this._callbacks={};var t=this._initContainer(e);g["default"].call(this,{name:"MousePosition",element:t,target:e.target,position:e.position})}o.r(t);var r=o(29),s=o.n(r),i=o(32),l=o(34),d=o(133),p=o(135),c=o(136),u=o(138),m=o(139),g=o(140),f=o(141),y=o(142),_=i["default"].getLogger("MousePosition");a.prototype=Object.create(g["default"].prototype,{}),p["default"].assign(a.prototype,m["default"]),a.prototype.constructor=a,a.prototype.setGlobe=function(e){if(e)this._centerElement=this._createMapCenter(),e.getTargetElement().appendChild(this._centerElement),this._callbacks.mouseMove=this.onMouseMove.bind(this),this.collapsed||(this._isDesktop?e.listen(d["default"].EVENTS.MOUSE_MOVE,this._callbacks.mouseMove):e.listen(d["default"].EVENTS.CENTER_CHANGED,this.onGlobeMove));else if(null==e){for(this._globe.forget(d["default"].EVENTS.MOUSE_MOVE,this._callbacks.mouseMove);this.getElement().hasChildNodes();)this.getElement().removeChild(this.getElement().lastChild);this.getElement().parentNode.removeChild(this.getElement()),this._globe.getTargetElement().removeChild(this._centerElement)}g["default"].prototype.setGlobe.call(this,e)},a.prototype.addSystem=function(e){if("object"!==n(e))return void _.error("MousePosition:addSystem - system parameter should be an object");if(!e.crs)return void _.error("crs not defined !");e.label||(_.warn("crs label not defined, use crs code by default."),e.label=e.crs),e.type||(_.warn("type srs not defined, use 'Metric' by default."),e.type="Metric");for(var t=0,o;t<this._projectionSystems.length;t++)o=this._projectionSystems[t],e.crs===o.crs&&_.warn("crs '{}' already configured",o.crs);e.code=this._projectionSystems.length,this._projectionSystems.push(e);var a=document.getElementById(this._addUID("GPmousePositionProjectionSystem"));if(a){var r=document.createElement("option");r.value=e.code,r.text=e.label,a.appendChild(r)}},a.prototype.addSystems=function(e){if(e){if(!Array.isArray(e))return void _.error("MousePosition:addSystems - systems parameter should be an array");for(var t=0;t<e.length;t++)this.addSystem(e[t])}},a.prototype.removeSystem=function(e){if(!e||"string"!=typeof e)return void _.error("MousePosition:removeSystem - systemCode parameter should be a string");for(var t=null,o=0,n;o<this._projectionSystems.length;o++)if(n=this._projectionSystems[o],e===n.crs){t=n.code,this._projectionSystems.splice(o,1);break}if(null==t)return void _.warn("MousePosition:removeSystem - system not found");for(var a=[],r=0;r<this._projectionSystems.length;r++)a[+this._projectionSystems[r].code]=r,this._projectionSystems[r].code=r;for(var s=null,l=document.getElementById(this._addUID("GPmousePositionProjectionSystem")),d=0;d<l.childNodes.length;d++){if(t===l.childNodes[d].value){s=d;continue}l.childNodes[d].value=a[+l.childNodes[d].value]}null!=s&&l.removeChild(l.childNodes[s]),this._currentProjectionSystems.code===t&&(l.childNodes[0].setAttribute("selected","selected"),this._setCurrentSystem(l.childNodes[0].value))},a.prototype.setUnits=function(e){e&&Array.isArray(e)&&(this.options.units=e,this._projectionUnits={},this._initProjectionUnits(),this._currentProjectionType&&this._setTypeUnitsPanel(this._currentProjectionType))},a.prototype.setAltitudeOptions=function(e){if(e&&"object"===n(e)&&(this.options.altitude.triggerDelay=e.triggerDelay,this.options.altitude.responseDelay=e.responseDelay,e.serviceOptions))for(var t in e.serviceOptions)e.serviceOptions.hasOwnProperty(t)&&(this.options.altitude.serviceOptions[t]=e.serviceOptions[t])},a.prototype.displayAltitude=function(e){void 0===e||("undefined"==typeof this._noRightManagement&&this._checkRightsManagement(),this.options.displayAltitude=e,this._setElevationPanel(e))},a.prototype.displayCoordinates=function(e){void 0===e||(this.options.displayCoordinates=e,this._setCoordinatesPanel(e),this._setSettingsPanel(e))},a.prototype.setCollapsed=function(e){return void 0===e?void _.error("MousePosition:setCollapsed - missing collapsed parameter"):void(e&&this.collapsed||!e&&!this.collapsed||(!this._isDesktop&&(document.getElementById(this._addUID("GPmapCenter")).className=e?"":"GPmapCenterVisible"),this.onShowMousePositionClick(),this._showMousePositionContainer.checked=!e))},a.prototype._initialize=function(e){if(this.options=e||{},this.options.collapsed=void 0===e.collapsed||e.collapsed,this.collapsed=this.options.collapsed,this.options.units=e.units||[],this.options.displayAltitude=void 0===e.displayAltitude||e.displayAltitude,this.options.displayCoordinates=void 0===e.displayCoordinates||e.displayCoordinates,this.options.systems=e.systems||[],e.altitude){var t=e.altitude;this.options.altitude={triggerDelay:void 0===t.triggerDelay?200:t.triggerDelay,responseDelay:void 0===t.responseDelay?500:t.responseDelay,serviceOptions:t.serviceOptions||{},noDataValue:void 0===t.noDataValue?-99999:t.noDataValue,noDataValueTolerance:void 0===t.noDataValueTolerance?9e4:t.noDataValueTolerance}}else this.options.altitude={triggerDelay:200,responseDelay:500,serviceOptions:{}};this._uid=u["default"].generate(),this._projectionSystems=[],this._initProjectionSystems(),this._projectionUnits={},this._initProjectionUnits(),this._isDesktop=p["default"].detectSupport(),100>this.options.altitude.triggerDelay&&(this.options.altitude.triggerDelay=100),this._timer=this.options.altitude.triggerDelay,this._currentProjectionSystems=this._projectionSystems[0],this._currentProjectionType=this._projectionSystems[0].type,this._currentProjectionUnits=this._projectionUnits[this._currentProjectionType][0].code,this._projectionUnitsContainer=null,this._showMousePositionContainer=null,this.options.displayAltitude||this.options.displayCoordinates||(this.options.displayCoordinates=!0),this.options.displayAltitude&&this._checkRightsManagement()},a.prototype._initProjectionSystems=function(){for(var e=[{label:"G\xE9ographique",crs:"EPSG:4326",type:"Geographical"},{label:"Mercator",crs:"EPSG:3857",type:"Metric"},{label:"Lambert 93",crs:"EPSG:2154",type:"Metric",geoBBox:{left:-9.86,bottom:41.15,right:10.38,top:51.56}},{label:"Lambert II \xE9tendu",crs:"EPSG:27572",type:"Metric",geoBBox:{left:-4.87,bottom:42.33,right:8.23,top:51.14}}],t=this.options.systems,o=0,n;o<t.length;o++)n=t[o],this.addSystem(n);if(0===this._projectionSystems.length)for(var a=0;a<e.length;a++)this.addSystem(e[a])},a.prototype._initProjectionUnits=function(){var e={Geographical:[{code:"DEC",label:"degr\xE9s d\xE9cimaux",convert:this._displayDEC},{code:"DMS",label:"degr\xE9s sexag\xE9simaux",convert:this._displayDMS},{code:"RAD",label:"radians",convert:this._displayRAD},{code:"GON",label:"grades",convert:this._displayGON}],Metric:[{code:"M",label:"m\xE8tres",convert:this._displayMeter},{code:"KM",label:"kilom\xE8tres",convert:this._displayKMeter}]},t=this.options.units;for(var o in e)if(e.hasOwnProperty(o)){for(var a=!1,r=0,s;r<e[o].length;r++){s=e[o][r];for(var l=0,d;l<t.length;l++)d=t[l],s.code===d&&(a=!0,!this._projectionUnits[o]&&(this._projectionUnits[o]=[]),this._projectionUnits[o].push(s))}a||(this._projectionUnits[o]=e[o])}"object"===n(this._projectionUnits)&&0===Object.keys(this._projectionUnits).length&&(this._projectionUnits=e)},a.prototype._checkRightsManagement=function(){var e=c["default"].check({key:this.options.apiKey,resources:["SERVICE_CALCUL_ALTIMETRIQUE_RSC"],services:["Elevation"]});this._noRightManagement=!e,this.options.apiKey||(this.options.apiKey=e.key)},a.prototype._initContainer=function(e){var t=this._createMainContainerElement(),o=this._showMousePositionContainer=this._createShowMousePositionElement();e.collapsed||(o.checked="checked"),t.appendChild(o);var n=this._createShowMousePositionPictoElement(this._isDesktop);t.appendChild(n);var a=this._createMousePositionPanelElement(),r=this._createMousePositionPanelHeaderElement();a.appendChild(r);var s=this._createMousePositionPanelBasicElement(e.displayAltitude,e.displayCoordinates);a.appendChild(s);for(var i=this._createShowMousePositionSettingsElement(e.displayCoordinates),l=0;l<i.length;l++)a.appendChild(i[l]);var d=this._createMousePositionSettingsElement(e.displayCoordinates),p=this._projectionSystemsContainer=this._createMousePositionSettingsSystemsElement(this._projectionSystems),c=this._projectionUnitsContainer=this._createMousePositionSettingsUnitsElement(this._projectionUnits[this._currentProjectionType]);return d.appendChild(p),d.appendChild(c),a.appendChild(d),t.appendChild(a),t},a.prototype._setElevationPanel=function(e){var t=null;e?this._noRightManagement?(t=document.getElementById("GPmousePositionAlt-"+this._uid),t.innerHTML="No rights!"):(t=document.getElementById("GPmousePositionAltitude-"+this._uid),t.style.display=""):(t=document.getElementById("GPmousePositionAltitude-"+this._uid),t.style.display="none")},a.prototype._setCoordinatesPanel=function(e){var t=document.getElementById("GPmousePositionCoordinate-"+this._uid);t.style.display=e?"":"none"},a.prototype._setSettingsPanel=function(e){var t=document.getElementById("GPshowMousePositionSettingsPicto-"+this._uid),o=document.getElementById("GPmousePositionSettings-"+this._uid);e?(t.style.display="",o.style.display=""):(t.style.display="none",o.style.display="none")},a.prototype._setTypeUnitsPanel=function(e){for(var t=this._projectionUnitsContainer;t.firstChild;)t.removeChild(t.firstChild);for(var o=this._projectionUnits[e],n=0;n<o.length;n++){var a=o[n],r=document.createElement("option");r.value=a.code?a.code:n,r.text=a.label||n,t.appendChild(r)}this._currentProjectionType=e,this._currentProjectionUnits=this._projectionUnits[e][0].code},a.prototype._displayDEC=function(e){var t={lat:f["default"].roundToDecimal(e.lat,6),lng:f["default"].roundToDecimal(e.lon,6)};return t},a.prototype._displayDMS=function(e){var t={lat:f["default"].decimalLatToDMS(e.lat),lng:f["default"].decimalLongToDMS(e.lon)};return t},a.prototype._displayRAD=function(e){var t={lat:f["default"].decimalToRadian(e.lat),lng:f["default"].decimalToRadian(e.lon)};return t},a.prototype._displayGON=function(e){var t={lat:f["default"].decimalToGrade(e.lat),lng:f["default"].decimalToGrade(e.lon)};return t},a.prototype._displayMeter=function(e){var t={x:e.lon.toFixed(2),y:e.lat.toFixed(2),unit:"m"};return t},a.prototype._displayKMeter=function(e){var t={x:(e.lon/1e3).toFixed(2),y:(e.lat/1e3).toFixed(2),unit:"km"};return t},a.prototype._setCoordinate=function(e){var t=[],o={},n=this._currentProjectionSystems,a=n.crs;if(!n||!a)return void _.error("system crs not found");"EPSG:4326"===a?o=e:(t=s()(y["default"][a],[e.lon,e.lat]),o.lon=t[0],o.lat=t[1]);for(var r=this._currentProjectionSystems.type,l=null,d=this._projectionUnits[r],p=0;p<d.length;p++)if(d[p].code===this._currentProjectionUnits){l=d[p].convert;break}if(!l||"function"!=typeof l)return void _.warn("coordinates format function not found");t=l(o);t&&0!==Object.keys(t).length&&this.GPdisplayCoords(t)},a.prototype._setElevation=function(e){var t=this.options.altitude.responseDelay;this.GPdisplayElevation(e,t)},a.prototype.onMoveStopped=function(e){this._setElevation(e)},a.prototype.onMouseMove=function(t){var e=this,o=this.getGlobe().getCoordinateFromMouseEvent(t);if(!o)return this.GPdisplayCoords({lon:"---",lat:"---"}),void this.GPresetElevation();var n={lon:o.x,lat:o.y};this._setCoordinate(n),this.options.displayAltitude&&(clearTimeout(this._timer),this._timer=setTimeout(function(){e.onMoveStopped(n)},this.options.altitude.triggerDelay))},a.prototype.onGlobeMove=function(){},a.prototype.onRequestAltitude=function(e,t){if(e&&0!==Object.keys(e).length&&this.options.displayAltitude){if(this._noRightManagement)return _.warn("contract key configuration has no rights to load geoportal elevation "),void(document.getElementById(this._addUID("GPmousePositionAlt")).innerHTML="No rights!");var o=this.options.altitude.serviceOptions||{};o.zonly=!0,o.positions=[{lon:e.lon,lat:e.lat}],o.scope=this,o.onSuccess=o.rawResponse?function(e){_.info("alti service raw response : ",e)}:function(e){e&&Object.keys(e)&&t.call(this,e.elevations[0].z)},o.onFailure=function(e){_.error("[getAltitude] "+e.message)},o.apiKey=o.apiKey||this.options.apiKey,o.ssl=this.options.ssl,l["default"].Services.getAltitude(o)}},a.prototype.onShowMousePositionClick=function(){var e=this.getGlobe();this.collapsed=this._showMousePositionContainer.checked,this._showMousePositionContainer.checked?this._isDesktop?e.forget(d["default"].EVENTS.MOUSE_MOVE,this._callbacks.mouseMove):e.forget(d["default"].EVENTS.CENTER_CHANGED,this.onGlobeMove):this._isDesktop?e.listen(d["default"].EVENTS.MOUSE_MOVE,this._callbacks.mouseMove):e.listen(d["default"].EVENTS.CENTER_CHANGED,this.onGlobeMove),this._setElevationPanel(this.options.displayAltitude),this._setCoordinatesPanel(this.options.displayCoordinates),this.options.displayCoordinates||this._setSettingsPanel(!1)},a.prototype.onMousePositionProjectionSystemChange=function(t){var e=t.target.selectedIndex,o=t.target.options[e].value;this._setCurrentSystem(o)},a.prototype._setCurrentSystem=function(e){for(var t=null,o=0;o<this._projectionSystems.length;++o)if(this._projectionSystems[o].code===+e){t=this._projectionSystems[o].type;break}return t?void(t!==this._currentProjectionType&&this._setTypeUnitsPanel(t),this._currentProjectionSystems=this._projectionSystems[+e],!this._isDesktop&&this.onGlobeMove()):void _.log("system not found in projection systems container")},a.prototype.onMousePositionProjectionSystemMouseOver=function(){var e=this.getGlobe();if(e){var t=e.getExtent(),o=document.getElementById(this._addUID("GPmousePositionProjectionSystem"));o.innerHTML="";for(var n=0,a,r;n<this._projectionSystems.length;n++){if(r=this._projectionSystems[n],r.geoBBox&&(t.west>r.geoBBox.right||t.south>r.geoBBox.top||t.east<r.geoBBox.left||t.north<r.geoBBox.bottom)){r===this._currentProjectionSystems&&(a=document.createElement("option"),a.value=r.code,a.text=r.label||n,a.setAttribute("selected","selected"),a.setAttribute("disabled","disabled"),o.appendChild(a));continue}a=document.createElement("option"),a.value=r.code,a.text=r.label||n,r===this._currentProjectionSystems&&a.setAttribute("selected","selected"),o.appendChild(a)}}},a.prototype.onMousePositionProjectionUnitsChange=function(t){var e=t.target.selectedIndex,o=t.target.options[e].value;this._currentProjectionUnits=o,this._isDesktop||this.onGlobeMove()},t["default"]=a},function(e,t,o){(function(t){e.exports=t.proj4=o(31)}).call(this,o(30))},function(e){var t=function(){return this}();try{t=t||new Function("return this")()}catch(o){"object"==typeof window&&(t=window)}e.exports=t},function(e){(function(t,o){e.exports=o()})(this,function(){'use strict';function e(e,t){if(e[t])return e[t];for(var o=Object.keys(e),n=t.toLowerCase().replace(ye,""),a=-1,r,s;++a<o.length;)if(r=o[a],s=r.toLowerCase().replace(ye,""),s===n)return e[r]}function t(e){if("string"!=typeof e)throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function o(e){var o=new t(e);return o.output()}function n(e,t,o){Array.isArray(t)&&(o.unshift(t),t=null);var n=t?{}:e,r=o.reduce(function(e,t){return a(t,e),e},n);t&&(e[t]=r)}function a(e,t){if(!Array.isArray(e))return void(t[e]=!0);var o=e.shift();if("PARAMETER"===o&&(o=e.shift()),1===e.length)return Array.isArray(e[0])?(t[o]={},void a(e[0],t[o])):void(t[o]=e[0]);if(!e.length)return void(t[o]=!0);if("TOWGS84"===o)return void(t[o]=e);if("AXIS"===o)return o in t||(t[o]=[]),void t[o].push(e);Array.isArray(o)||(t[o]={});var r;switch(o){case"UNIT":case"PRIMEM":case"VERT_DATUM":return t[o]={name:e[0].toLowerCase(),convert:e[1]},void(3===e.length&&a(e[2],t[o]));case"SPHEROID":case"ELLIPSOID":return t[o]={name:e[0],a:e[1],rf:e[2]},void(4===e.length&&a(e[3],t[o]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return e[0]=["name",e[0]],void n(t,o,e);default:for(r=-1;++r<e.length;)if(!Array.isArray(e[r]))return a(e,t[o]);return n(t,o,e);}}function r(e,t){var o=t[0],n=t[1];!(o in e)&&n in e&&(e[o]=e[n],3===t.length&&(e[o]=t[2](e[o])))}function s(e){return e*Ce}function i(e){function t(t){var o=e.to_meter||1;return t*o}if("GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):"object"==typeof e.PROJECTION?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var o="",n=0,a=e.AXIS.length;n<a;++n){var l=e.AXIS[n],d=l[0].toLowerCase();-1===d.indexOf("north")?-1===d.indexOf("south")?-1===d.indexOf("east")?-1!==d.indexOf("west")&&(o+="w"):o+="e":o+="s":o+="n"}2===o.length&&(o+="u"),3===o.length&&(e.axis=o)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var p=e.GEOGCS;"GEOGCS"===e.type&&(p=e),p&&(e.datumCode=p.DATUM?p.DATUM.name.toLowerCase():p.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===e.datumCode||"new_zealand_1949"===e.datumCode)&&(e.datumCode="nzgd49"),("wgs_1984"===e.datumCode||"world_geodetic_system_1984"===e.datumCode)&&("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"_ferro"===e.datumCode.slice(-6)&&(e.datumCode=e.datumCode.slice(0,-6)),"_jakarta"===e.datumCode.slice(-8)&&(e.datumCode=e.datumCode.slice(0,-8)),~e.datumCode.indexOf("belge")&&(e.datumCode="rnb72"),p.DATUM&&p.DATUM.SPHEROID&&(e.ellps=p.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=p.DATUM.SPHEROID.a,e.rf=parseFloat(p.DATUM.SPHEROID.rf,10)),p.DATUM&&p.DATUM.TOWGS84&&(e.datum_params=p.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),"ch1903+"===e.datumCode&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",s],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",s],["x0","false_easting",t],["y0","false_northing",t],["long0","central_meridian",s],["lat0","latitude_of_origin",s],["lat0","standard_parallel_1",s],["lat1","standard_parallel_1",s],["lat2","standard_parallel_2",s],["azimuth","Azimuth"],["alpha","azimuth",s],["srsCode","name"]].forEach(function(t){return r(e,t)}),!e.long0&&e.longc&&("Albers_Conic_Equal_Area"===e.projName||"Lambert_Azimuthal_Equal_Area"===e.projName)&&(e.long0=e.longc),!e.lat_ts&&e.lat1&&("Stereographic_South_Pole"===e.projName||"Polar Stereographic (variant B)"===e.projName)&&(e.lat0=s(0<e.lat1?90:-90),e.lat_ts=e.lat1)}function l(e){var t=this;if(2===arguments.length){var o=arguments[1];l[e]="string"==typeof o?"+"===o.charAt(0)?_e(arguments[1]):Ae(arguments[1]):o}else if(1===arguments.length){if(Array.isArray(e))return e.map(function(e){Array.isArray(e)?l.apply(t,e):l(e)});if("string"!=typeof e)"EPSG"in e?l["EPSG:"+e.EPSG]=e:"ESRI"in e?l["ESRI:"+e.ESRI]=e:"IAU2000"in e?l["IAU2000:"+e.IAU2000]=e:console.log(e);else if(e in l)return l[e]}}function d(e){return"string"==typeof e}function p(e){return e in l}function c(e){return Le.some(function(t){return-1<e.indexOf(t)})}function u(t){var o=e(t,"authority");if(o){var n=e(o,"epsg");return n&&-1<Ie.indexOf(n)}}function m(t){var o=e(t,"extension");return o?e(o,"proj4"):void 0}function g(e){return"+"===e[0]}function f(e){if(d(e)){if(p(e))return l[e];if(c(e)){var t=Ae(e);if(u(t))return l["EPSG:3857"];var o=m(t);return o?_e(o):t}if(g(e))return _e(e)}else return e}function y(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Te(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):!this.k0&&(this.k?this.k0=this.k:this.k0=1)}function _(e){return e}function E(e,t){var o=Ue.length;return e.names?(Ue[o]=e,e.names.forEach(function(e){ke[e.toLowerCase()]=o}),this):(console.log(t),!0)}function h(t,o,n,r){var s=t*t,i=o*o,l=(s-i)/s,d=0;r?(t*=1-l*(re+l*(se+l*ie)),s=t*t,l=0):d=Math.sqrt(l);var p=(s-i)/i;return{es:l,e:d,ep2:p}}function b(t,o,n,r,s){if(!t){var i=e(qe,r);i||(i=je),t=i.a,o=i.b,n=i.rf}return n&&!o&&(o=(1-1/n)*t),(0===n||Math.abs(t-o)<le)&&(s=!0,o=t),{a:t,b:o,rf:n,sphere:s}}function S(e,t,o,n,a,r){var s={};return s.datum_type=void 0===e||"none"===e?5:4,t&&(s.datum_params=t.map(parseFloat),(0!==s.datum_params[0]||0!==s.datum_params[1]||0!==s.datum_params[2])&&(s.datum_type=1),3<s.datum_params.length&&(0!==s.datum_params[3]||0!==s.datum_params[4]||0!==s.datum_params[5]||0!==s.datum_params[6])&&(s.datum_type=2,s.datum_params[3]*=ne,s.datum_params[4]*=ne,s.datum_params[5]*=ne,s.datum_params[6]=s.datum_params[6]/1e6+1)),s.a=o,s.b=n,s.es=a,s.ep2=r,s}function P(t,o){if(!(this instanceof P))return new P(t);o=o||function(e){if(e)throw e};var n=f(t);if("object"!=typeof n)return void o(t);var a=P.projections.get(n.projName);if(!a)return void o(t);if(n.datumCode&&"none"!==n.datumCode){var r=e(Ve,n.datumCode);r&&(n.datum_params=r.towgs84?r.towgs84.split(","):null,n.ellps=r.ellipse,n.datumName=r.datumName?r.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84";var s=b(n.a,n.b,n.rf,n.ellps,n.sphere),i=h(s.a,s.b,s.rf,n.R_A),l=n.datum||S(n.datumCode,n.datum_params,s.a,s.b,i.es,i.ep2);we(this,n),we(this,a),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=i.es,this.e=i.e,this.ep2=i.ep2,this.datum=l,this.init(),o(null,this)}function R(e,t){return e.datum_type===t.datum_type&&!(e.a!==t.a||5e-11<Math.abs(e.es-t.es))&&(1===e.datum_type?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:2!==e.datum_type||e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6])}function x(e,t,o){var n=e.x,a=e.y,r=e.z?e.z:0,s,i,l,d;if(a<-ae&&a>-1.001*ae)a=-ae;else if(a>ae&&a<1.001*ae)a=ae;else{if(a<-ae)return{x:-Infinity,y:-Infinity,z:e.z};if(a>ae)return{x:1/0,y:1/0,z:e.z}}return n>Math.PI&&(n-=2*Math.PI),i=Math.sin(a),d=Math.cos(a),l=i*i,s=o/Math.sqrt(1-t*l),{x:(s+r)*d*Math.cos(n),y:(s+r)*d*Math.sin(n),z:(s*(1-t)+r)*i}}function v(e,t,o,n){var a=1e-12,r=e.x,s=e.y,i=e.z?e.z:0,l,d,p,c,u,m,g,f,y,_,E,h,b,S,R,x;if(l=Math.sqrt(r*r+s*s),d=Math.sqrt(r*r+s*s+i*i),!(l/o<a))S=Math.atan2(s,r);else if(S=0,d/o<a)return R=ae,x=-n,{x:e.x,y:e.y,z:e.z};p=i/d,c=l/d,u=1/Math.sqrt(1-t*(2-t)*c*c),f=c*(1-t)*u,y=p*u,b=0;do b++,g=o/Math.sqrt(1-t*y*y),x=l*f+i*y-g*(1-t*y*y),m=t*g/(g+x),u=1/Math.sqrt(1-m*(2-m)*c*c),_=c*(1-m)*u,E=p*u,h=E*f-_*y,f=_,y=E;while(h*h>a*a&&b<30);return R=Math.atan(E/Math.abs(_)),{x:S,y:R,z:x}}function C(e,t,o){if(1===t)return{x:e.x+o[0],y:e.y+o[1],z:e.z+o[2]};if(2===t){var n=o[0],a=o[1],r=o[2],s=o[3],i=o[4],l=o[5],d=o[6];return{x:d*(e.x-l*e.y+i*e.z)+n,y:d*(l*e.x+e.y-s*e.z)+a,z:d*(-i*e.x+s*e.y+e.z)+r}}}function A(e,t,o){if(1===t)return{x:e.x-o[0],y:e.y-o[1],z:e.z-o[2]};if(2===t){var n=o[0],a=o[1],r=o[2],s=o[3],i=o[4],l=o[5],d=o[6],p=(e.x-n)/d,c=(e.y-a)/d,u=(e.z-r)/d;return{x:p+l*c-i*u,y:-l*p+c+s*u,z:i*p-s*c+u}}}function L(e){return 1===e||2===e}function I(e){if("function"==typeof Number.isFinite){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof e||e!==e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function w(e,t){return(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==t.datumCode||(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode}function T(e,t,o){var n;if(Array.isArray(o)&&(o=He(o)),ze(o),e.datum&&t.datum&&w(e,t)&&(n=new P("WGS84"),o=T(e,n,o),e=n),"enu"!==e.axis&&(o=Fe(e,!1,o)),"longlat"===e.projName)o={x:o.x*de,y:o.y*de,z:o.z||0};else if(e.to_meter&&(o={x:o.x*e.to_meter,y:o.y*e.to_meter,z:o.z||0}),o=e.inverse(o),!o)return;return e.from_greenwich&&(o.x+=e.from_greenwich),o=Be(e.datum,t.datum,o),t.from_greenwich&&(o={x:o.x-t.from_greenwich,y:o.y,z:o.z||0}),"longlat"===t.projName?o={x:o.x*pe,y:o.y*pe,z:o.z||0}:(o=t.forward(o),t.to_meter&&(o={x:o.x/t.to_meter,y:o.y/t.to_meter,z:o.z||0})),"enu"===t.axis?o:Fe(t,!0,o)}function N(e,t,o){var n,a,r;return Array.isArray(o)?(n=T(e,t,o)||{x:NaN,y:NaN},2<o.length?"undefined"!=typeof e.name&&"geocent"===e.name||"undefined"!=typeof t.name&&"geocent"===t.name?"number"==typeof n.z?[n.x,n.y,n.z].concat(o.splice(3)):[n.x,n.y,o[2]].concat(o.splice(3)):[n.x,n.y].concat(o.splice(2)):[n.x,n.y]):(a=T(e,t,o),r=Object.keys(o),2===r.length)?a:(r.forEach(function(n){if("undefined"!=typeof e.name&&"geocent"===e.name||"undefined"!=typeof t.name&&"geocent"===t.name){if("x"===n||"y"===n||"z"===n)return;}else if("x"===n||"y"===n)return;a[n]=o[n]}),a)}function O(e){return e instanceof P?e:e.oProj?e.oProj:P(e)}function M(e,t,o){e=O(e);var n=!1,a;return"undefined"==typeof t?(t=e,e=Xe,n=!0):("undefined"!=typeof t.x||Array.isArray(t))&&(o=t,t=e,e=Xe,n=!0),t=O(t),o?N(e,t,o):(a={forward:function(o){return N(e,t,o)},inverse:function(o){return N(t,e,o)}},n&&(a.oProj=t),a)}function D(e,t){return t=t||5,B(q({lat:e[1],lon:e[0]}),t)}function G(e){var t=j(X(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function k(e){return e*(Math.PI/180)}function U(e){return 180*(e/Math.PI)}function q(e){var t=e.lat,o=e.lon,n=6378137,a=.00669438,r=.9996,s=k(t),i=k(o),l,d,p,c,u,m,g,f,y;y=Math.floor((o+180)/6)+1,180===o&&(y=60),56<=t&&64>t&&3<=o&&12>o&&(y=32),72<=t&&84>t&&(0<=o&&9>o?y=31:9<=o&&21>o?y=33:21<=o&&33>o?y=35:33<=o&&42>o&&(y=37)),l=6*(y-1)-180+3,f=k(l),d=a/(1-a),p=n/Math.sqrt(1-a*Math.sin(s)*Math.sin(s)),c=Math.tan(s)*Math.tan(s),u=d*Math.cos(s)*Math.cos(s),m=Math.cos(s)*(i-f),g=n*((1-a/4-3*a*a/64-5*a*a*a/256)*s-(3*a/8+3*a*a/32+45*a*a*a/1024)*Math.sin(2*s)+(15*a*a/256+45*a*a*a/1024)*Math.sin(4*s)-35*a*a*a/3072*Math.sin(6*s));var _=r*p*(65+65*(65*(65*(1-c+u)))/6+65*(65*(65*(65*(65*(5-18*c+c*c+72*u-58*d)))))/120)+5e5,E=r*(g+p*Math.tan(s)*(4225/2+65*(65*(65*(65*(5-c+9*u+4*u*u))))/24+65*(65*(65*(65*(65*(65*(61-58*c+c*c+600*u-330*d))))))/720));return 0>t&&(E+=1e7),{northing:Math.round(E),easting:Math.round(_),zoneNumber:y,zoneLetter:V(t)}}function j(e){var t=e.northing,o=e.easting,n=e.zoneLetter,r=e.zoneNumber;if(0>r||60<r)return null;var s=.9996,i=6378137,a=.00669438,l=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),d=t,p,c,u,m,g,f,_,E,h,b;"N">n&&(d-=1e7),E=6*(r-1)-180+3,p=a/(1-a),_=d/s,h=_/(i*(1-a/4-3*a*a/64-5*a*a*a/256)),b=h+(3*l/2-27*l*l*l/32)*Math.sin(2*h)+(21*l*l/16-55*l*l*l*l/32)*Math.sin(4*h)+151*l*l*l/96*Math.sin(6*h),c=i/Math.sqrt(1-a*Math.sin(b)*Math.sin(b)),u=Math.tan(b)*Math.tan(b),m=p*Math.cos(b)*Math.cos(b),g=i*(1-a)/Math.pow(1-a*Math.sin(b)*Math.sin(b),1.5),f=(o-5e5)/(c*s);var S=b-c*Math.tan(b)/g*(f*f/2-(5+3*u+10*m-4*m*m-9*p)*f*f*f*f/24+(61+90*u+298*m+45*u*u-252*p-3*m*m)*f*f*f*f*f*f/720);S=U(S);var P=(f-(1+2*u+m)*f*f*f/6+(5-2*m+28*u-3*m*m+8*p+24*u*u)*f*f*f*f*f/120)/Math.cos(b);P=E+U(P);var R;if(e.accuracy){var x=j({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});R={top:x.lat,right:x.lon,bottom:S,left:P}}else R={lat:S,lon:P};return R}function V(e){var t="Z";return 84>=e&&72<=e?t="X":72>e&&64<=e?t="W":64>e&&56<=e?t="V":56>e&&48<=e?t="U":48>e&&40<=e?t="T":40>e&&32<=e?t="S":32>e&&24<=e?t="R":24>e&&16<=e?t="Q":16>e&&8<=e?t="P":8>e&&0<=e?t="N":0>e&&-8<=e?t="M":-8>e&&-16<=e?t="L":-16>e&&-24<=e?t="K":-24>e&&-32<=e?t="J":-32>e&&-40<=e?t="H":-40>e&&-48<=e?t="G":-48>e&&-56<=e?t="F":-56>e&&-64<=e?t="E":-64>e&&-72<=e?t="D":-72>e&&-80<=e&&(t="C"),t}function B(e,t){var o="00000"+e.easting,n="00000"+e.northing;return e.zoneNumber+e.zoneLetter+F(e.easting,e.northing,e.zoneNumber)+o.substr(o.length-5,t)+n.substr(n.length-5,t)}function F(e,t,o){var n=H(o),a=Math.floor(e/1e5),r=Math.floor(t/1e5)%20;return z(a,r,n)}function H(e){var t=e%6;return 0===t&&(t=6),t}function z(e,t,o){var n=o-1,a="AJSAJS".charCodeAt(n),r="AFAFAF".charCodeAt(n),s=a+e-1,i=r+t,l=!1;90<s&&(s=s-90+65-1,l=!0),(73===s||73>a&&73<s||(73<s||73>a)&&l)&&s++,(79===s||79>a&&79<s||(79<s||79>a)&&l)&&(s++,73===s&&s++),90<s&&(s=s-90+65-1),86<i?(i=i-86+65-1,l=!0):l=!1,(73===i||73>r&&73<i||(73<i||73>r)&&l)&&i++,(79===i||79>r&&79<i||(79<i||79>r)&&l)&&(i++,73===i&&i++),86<i&&(i=i-86+65-1);var d=String.fromCharCode(s)+String.fromCharCode(i);return d}function X(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t=e.length,o=null,n="",a=0,r;!/[A-Z]/.test(r=e.charAt(a));){if(2<=a)throw"MGRSPoint bad conversion from: "+e;n+=r,a++}var s=parseInt(n,10);if(0===a||a+3>t)throw"MGRSPoint bad conversion from: "+e;var l=e.charAt(a++);if("A">=l||"B"===l||"Y"===l||"Z"<=l||"I"===l||"O"===l)throw"MGRSPoint zone letter "+l+" not handled: "+e;o=e.substring(a,a+=2);for(var d=H(s),p=Y(o.charAt(0),d),c=W(o.charAt(1),d);c<K(l);)c+=2e6;var u=t-a;if(0!=u%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var m=u/2,g=0,f=0,y,_,E,h,b;return 0<m&&(y=1e5/Math.pow(10,m),_=e.substring(a,a+m),g=parseFloat(_)*y,E=e.substring(a+m),f=parseFloat(E)*y),h=g+p,b=f+c,{easting:h,northing:b,zoneLetter:l,zoneNumber:s,accuracy:y}}function Y(t,e){for(var o="AJSAJS".charCodeAt(e-1),n=1e5,a=!1;o!==t.charCodeAt(0);){if(o++,73===o&&o++,79===o&&o++,90<o){if(a)throw"Bad character: "+t;o=65,a=!0}n+=1e5}return n}function W(e,t){if("V"<e)throw"MGRSPoint given invalid Northing "+e;for(var o="AFAFAF".charCodeAt(t-1),n=0,a=!1;o!==e.charCodeAt(0);){if(o++,73===o&&o++,79===o&&o++,86<o){if(a)throw"Bad character: "+e;o=65,a=!0}n+=1e5}return n}function K(e){var t;if(t="C"===e?11e5:"D"===e?2e6:"E"===e?28e5:"F"===e?37e5:"G"===e?46e5:"H"===e?55e5:"J"===e?64e5:"K"===e?73e5:"L"===e?82e5:"M"===e?91e5:"N"===e?0:"P"===e?8e5:"Q"===e?17e5:"R"===e?26e5:"S"===e?35e5:"T"===e?44e5:"U"===e?53e5:"V"===e?62e5:"W"===e?7e6:"X"===e?79e5:-1,0<=t)return t;throw"Invalid zone letter: "+e}function Q(e,t,o){if(!(this instanceof Q))return new Q(e,t,o);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&"undefined"==typeof t){var n=e.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=e,this.y=t,this.z=o||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function J(e){var o=[],n;return o[0]=e*It,n=e*e,o[0]+=n*wt,o[1]=n*Nt,n*=e,o[0]+=n*Tt,o[1]+=n*Ot,o[2]=n*Mt,o}function Z(e,o){var n=e+e;return e+o[0]*Math.sin(n)+o[1]*Math.sin(n+n)+o[2]*Math.sin(n+n+n)}function $(e,t,o,n){var a;return e<le?(n.value=Zt.AREA_0,a=0):(a=Math.atan2(t,o),Math.abs(a)<=ce?n.value=Zt.AREA_0:a>ce&&a<=ae+ce?(n.value=Zt.AREA_1,a-=ae):a>ae+ce||a<=-(ae+ce)?(n.value=Zt.AREA_2,a=0<=a?a-me:a+me):(n.value=Zt.AREA_3,a+=ae)),a}function ee(e,t){var o=e+t;return o<-me?o+=ue:o>+me&&(o-=ue),o}function te(e,t,o,n){for(var a=t,r;n&&(r=e(a),a-=r,!(Math.abs(r)<o));--n);return a}var oe=5,ne=484813681109536e-20,ae=Math.PI/2,re=.16666666666666666,se=.04722222222222222,ie=.022156084656084655,le=1e-10,de=.017453292519943295,pe=57.29577951308232,ce=Math.PI/4,ue=2*Math.PI,me=3.14159265359,ge={};ge.greenwich=0,ge.lisbon=-9.131906111111,ge.paris=2.337229166667,ge.bogota=-74.080916666667,ge.madrid=-3.687938888889,ge.rome=12.452333333333,ge.bern=7.439583333333,ge.jakarta=106.807719444444,ge.ferro=-17.666666666667,ge.brussels=4.367975,ge.stockholm=18.058277777778,ge.athens=23.7163375,ge.oslo=10.722916666667;var fe={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},ye=/[\s_\-\/\(\)]/g,_e=function(t){var o={},n=t.split("+").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,t){var o=t.split("=");return o.push(!0),e[o[0].toLowerCase()]=o[1],e},{}),a={proj:"projName",datum:"datumCode",rf:function(e){o.rf=parseFloat(e)},lat_0:function(e){o.lat0=e*de},lat_1:function(e){o.lat1=e*de},lat_2:function(e){o.lat2=e*de},lat_ts:function(e){o.lat_ts=e*de},lon_0:function(e){o.long0=e*de},lon_1:function(e){o.long1=e*de},lon_2:function(e){o.long2=e*de},alpha:function(e){o.alpha=parseFloat(e)*de},lonc:function(e){o.longc=e*de},x_0:function(e){o.x0=parseFloat(e)},y_0:function(e){o.y0=parseFloat(e)},k_0:function(e){o.k0=parseFloat(e)},k:function(e){o.k0=parseFloat(e)},a:function(e){o.a=parseFloat(e)},b:function(e){o.b=parseFloat(e)},r_a:function(){o.R_A=!0},zone:function(e){o.zone=parseInt(e,10)},south:function(){o.utmSouth=!0},towgs84:function(e){o.datum_params=e.split(",").map(function(e){return parseFloat(e)})},to_meter:function(e){o.to_meter=parseFloat(e)},units:function(t){o.units=t;var n=e(fe,t);n&&(o.to_meter=n.to_meter)},from_greenwich:function(e){o.from_greenwich=e*de},pm:function(t){var n=e(ge,t);o.from_greenwich=(n?n:parseFloat(t))*de},nadgrids:function(e){"@null"===e?o.datumCode="none":o.nadgrids=e},axis:function(e){3===e.length&&-1!=="ewnsud".indexOf(e.substr(0,1))&&-1!=="ewnsud".indexOf(e.substr(1,1))&&-1!=="ewnsud".indexOf(e.substr(2,1))&&(o.axis=e)}},r,s,i;for(r in n)s=n[r],r in a?(i=a[r],"function"==typeof i?i(s):o[i]=s):o[r]=s;return"string"==typeof o.datumCode&&"WGS84"!==o.datumCode&&(o.datumCode=o.datumCode.toLowerCase()),o},Ee=1,he=2,be=3,Se=4,Pe=5,Re=-1,xe=/[,\]]/,ve=/[\d\.E\-\+]/;t.prototype.readCharicter=function(){var e=this.text[this.place++];if(this.state!==Se)for(;/\s/.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case Ee:return this.neutral(e);case he:return this.keyword(e);case Se:return this.quoted(e);case Pe:return this.afterquote(e);case be:return this.number(e);case Re:}},t.prototype.afterquote=function(e){if("\""===e)return this.word+="\"",void(this.state=Se);if(xe.test(e))return this.word=this.word.trim(),void this.afterItem(e);throw new Error("havn't handled \""+e+"\" in afterquote yet, index "+this.place)},t.prototype.afterItem=function(e){return","===e?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=Ee)):"]"===e?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=Ee,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=Re))):void 0},t.prototype.number=function(e){if(ve.test(e))return void(this.word+=e);if(xe.test(e))return this.word=parseFloat(this.word),void this.afterItem(e);throw new Error("havn't handled \""+e+"\" in number yet, index "+this.place)},t.prototype.quoted=function(e){return"\""===e?void(this.state=Pe):void(this.word+=e)},t.prototype.keyword=function(e){if(/[A-Za-z84]/.test(e))return void(this.word+=e);if("["===e){var t=[];return t.push(this.word),this.level++,null===this.root?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,void(this.state=Ee)}if(xe.test(e))return void this.afterItem(e);throw new Error("havn't handled \""+e+"\" in keyword yet, index "+this.place)},t.prototype.neutral=function(e){if(/[A-Za-z]/.test(e))return this.word=e,void(this.state=he);if("\""===e)return this.word="",void(this.state=Se);if(ve.test(e))return this.word=e,void(this.state=be);if(xe.test(e))return void this.afterItem(e);throw new Error("havn't handled \""+e+"\" in neutral yet, index "+this.place)},t.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===Re)return this.root;throw new Error("unable to parse string \""+this.text+"\". State is "+this.state)};var Ce=.017453292519943295,Ae=function(e){var t=o(e),n=t.shift(),r=t.shift();t.unshift(["name",r]),t.unshift(["type",n]);var s={};return a(t,s),i(s),s};(function(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]})(l);var Le=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],Ie=["3857","900913","3785","102113"],we=function(e,t){e=e||{};var o,n;if(!t)return e;for(n in t)o=t[n],void 0!==o&&(e[n]=o);return e},Te=function(e,t,o){var n=e*t;return o/Math.sqrt(1-n*n)},Ne=function(e){return 0>e?-1:1},Oe=function(e){return Math.abs(e)<=me?e:e-Ne(e)*ue},Me=function(e,t,o){var n=e*o;return n=Math.pow((1-n)/(1+n),.5*e),Math.tan(.5*(ae-t))/n},De=function(e,t){for(var o=ae-2*Math.atan(t),n=0,a,r;15>=n;n++)if(a=e*Math.sin(o),r=ae-2*Math.atan(t*Math.pow((1-a)/(1+a),.5*e))-o,o+=r,1e-10>=Math.abs(r))return o;return-9999},Ge=[{init:y,forward:function(e){var t=e.x,o=e.y;if(90<o*pe&&-90>o*pe&&180<t*pe&&-180>t*pe)return null;var n,a;if(Math.abs(Math.abs(o)-ae)<=le)return null;if(this.sphere)n=this.x0+this.a*this.k0*Oe(t-this.long0),a=this.y0+this.a*this.k0*Math.log(Math.tan(ce+.5*o));else{var r=Math.sin(o),s=Me(this.e,o,r);n=this.x0+this.a*this.k0*Oe(t-this.long0),a=this.y0-this.a*this.k0*Math.log(s)}return e.x=n,e.y=a,e},inverse:function(e){var t=e.x-this.x0,o=e.y-this.y0,n,a;if(this.sphere)a=ae-2*Math.atan(Math.exp(-o/(this.a*this.k0)));else{var r=Math.exp(-o/(this.a*this.k0));if(a=De(this.e,r),-9999===a)return null}return n=Oe(this.long0+t/(this.a*this.k0)),e.x=n,e.y=a,e},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:_,inverse:_,names:["longlat","identity"]}],ke={},Ue=[],qe={};qe.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},qe.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},qe.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},qe.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},qe.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},qe.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},qe.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},qe.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},qe.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},qe.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},qe.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},qe.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},qe.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},qe.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},qe.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},qe.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},qe.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},qe.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},qe.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},qe.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},qe.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},qe.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},qe.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},qe.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},qe.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},qe.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},qe.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},qe.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},qe.hough={a:6378270,rf:297,ellipseName:"Hough"},qe.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},qe.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},qe.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},qe.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},qe.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},qe.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},qe.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},qe.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},qe.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},qe.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},qe.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},qe.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var je=qe.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};qe.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Ve={};Ve.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},Ve.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},Ve.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},Ve.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},Ve.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},Ve.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},Ve.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},Ve.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},Ve.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},Ve.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},Ve.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},Ve.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},Ve.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},Ve.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},Ve.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},Ve.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},Ve.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},P.projections={start:function(){Ge.forEach(E)},add:E,get:function(e){if(!e)return!1;var t=e.toLowerCase();if("undefined"!=typeof ke[t]&&Ue[ke[t]])return Ue[ke[t]]}},P.projections.start(),"use strict";var Be=function(e,t,o){return R(e,t)?o:e.datum_type===oe||t.datum_type===oe?o:e.es!==t.es||e.a!==t.a||L(e.datum_type)||L(t.datum_type)?(o=x(o,e.es,e.a),L(e.datum_type)&&(o=C(o,e.datum_type,e.datum_params)),L(t.datum_type)&&(o=A(o,t.datum_type,t.datum_params)),v(o,t.es,t.a,t.b)):o},Fe=function(e,o,n){var a=n.x,r=n.y,s=n.z||0,l={},d,p,c;for(c=0;3>c;c++)if(!(o&&2===c&&void 0===n.z))switch(0===c?(d=a,p=-1==="ew".indexOf(e.axis[c])?"y":"x"):1===c?(d=r,p=-1==="ns".indexOf(e.axis[c])?"x":"y"):(d=s,p="z"),e.axis[c]){case"e":case"w":case"n":case"s":l[p]=d;break;case"u":void 0!==n[p]&&(l.z=d);break;case"d":void 0!==n[p]&&(l.z=-d);break;default:return null;}return l},He=function(e){var t={x:e[0],y:e[1]};return 2<e.length&&(t.z=e[2]),3<e.length&&(t.m=e[3]),t},ze=function(e){I(e.x),I(e.y)},Xe=P("WGS84");Q.fromMGRS=function(e){return new Q(G(e))},Q.prototype.toMGRS=function(e){return D([this.x,this.y],e)};var Ye=.046875,We=.01953125,Ke=.01068115234375,Qe=function(e){var o=[];o[0]=1-e*(.25+e*(Ye+e*(We+e*Ke))),o[1]=e*(.75-e*(Ye+e*(We+e*Ke)));var n=e*e;return o[2]=n*(.46875-e*(.013020833333333334+e*.007120768229166667)),n*=e,o[3]=n*(.3645833333333333-e*.005696614583333333),o[4]=n*e*.3076171875,o},Je=function(e,t,o,n){return o*=t,t*=t,n[0]*e-o*(n[1]+t*(n[2]+t*(n[3]+t*n[4])))},Ze=function(e,o,n){for(var a=e,r=20;r;--r){var l=Math.sin(a),s=1-o*l*l;if(s=(Je(a,l,Math.cos(a),n)-e)*(s*Math.sqrt(s))*(1/(1-o)),a-=s,Math.abs(s)<le)return a}return a},$e={init:function(){this.x0=void 0===this.x0?0:this.x0,this.y0=void 0===this.y0?0:this.y0,this.long0=void 0===this.long0?0:this.long0,this.lat0=void 0===this.lat0?0:this.lat0,this.es&&(this.en=Qe(this.es),this.ml0=Je(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(e){var o=e.x,n=e.y,a=Oe(o-this.long0),r=Math.sin(n),s=Math.cos(n),i,l,d;if(!this.es){var p=s*Math.sin(a);if(Math.abs(Math.abs(p)-1)<le)return 93;if(l=.5*this.a*this.k0*Math.log((1+p)/(1-p))+this.x0,d=s*Math.cos(a)/Math.sqrt(1-Math.pow(p,2)),p=Math.abs(d),1<=p){if(p-1>le)return 93;d=0}else d=Math.acos(d);0>n&&(d=-d),d=this.a*this.k0*(d-this.lat0)+this.y0}else{var u=s*a,m=Math.pow(u,2),g=this.ep2*Math.pow(s,2),c=Math.pow(g,2),f=Math.abs(s)>le?Math.tan(n):0,_=Math.pow(f,2),t=Math.pow(_,2);i=1-this.es*Math.pow(r,2),u/=Math.sqrt(i);var E=Je(n,r,s,this.en);l=this.a*(this.k0*u*(1+m/6*(1-_+g+m/20*(5-18*_+t+14*g-58*_*g+m/42*(61+179*t-t*_-479*_)))))+this.x0,d=this.a*(this.k0*(E-this.ml0+r*a*u/2*(1+m/12*(5-_+9*g+4*c+m/30*(61+t-58*_+270*g-330*_*g+m/56*(1385+543*t-t*_-3111*_))))))+this.y0}return e.x=l,e.y=d,e},inverse:function(e){var o=(e.x-this.x0)*(1/this.a),n=(e.y-this.y0)*(1/this.a),a,r,s,i;if(!this.es){var l=Math.exp(o/this.k0),p=.5*(l-1/l),u=this.lat0+n/this.k0,m=Math.cos(u);a=Math.sqrt((1-Math.pow(m,2))/(1+Math.pow(p,2))),s=Math.asin(a),0>n&&(s=-s),i=0===p&&0===m?0:Oe(Math.atan2(p,m)+this.long0)}else if(a=this.ml0+n/this.k0,r=Ze(a,this.es,this.en),Math.abs(r)<ae){var g=Math.sin(r),f=Math.cos(r),y=Math.abs(f)>le?Math.tan(r):0,_=this.ep2*Math.pow(f,2),c=Math.pow(_,2),E=Math.pow(y,2),t=Math.pow(E,2);a=1-this.es*Math.pow(g,2);var h=o*Math.sqrt(a)/this.k0,d=Math.pow(h,2);a*=y,s=r-.5*(a*d/(1-this.es))*(1-d/12*(5+3*E-9*_*E+_-4*c-d/30*(61+90*E-252*_*E+45*t+46*_-d/56*(1385+3633*E+4095*t+1574*t*E)))),i=Oe(this.long0+h*(1-d/6*(1+2*E+_-d/20*(5+28*E+24*t+8*_*E+6*_-d/42*(61+662*E+1320*t+720*t*E))))/f)}else s=ae*Ne(n),i=0;return e.x=i,e.y=s,e},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},et=function(e){var t=Math.exp(e);return t=(t-1/t)/2,t},tt=function(e,t){e=Math.abs(e),t=Math.abs(t);var o=Math.max(e,t),n=Math.min(e,t)/(o?o:1);return o*Math.sqrt(1+Math.pow(n,2))},ot=function(e){var t=1+e,o=t-1;return 0===o?e:e*Math.log(t)/o},nt=function(e){var t=Math.abs(e);return t=ot(t*(1+t/(tt(1,t)+1))),0>e?-t:t},at=function(e,t){for(var o=2*Math.cos(2*t),n=e.length-1,a=e[n],r=0,s;0<=--n;)s=-r+o*a+e[n],r=a,a=s;return t+s*Math.sin(2*t)},rt=function(e,t){for(var o=2*Math.cos(t),n=e.length-1,a=e[n],r=0,s;0<=--n;)s=-r+o*a+e[n],r=a,a=s;return Math.sin(t)*s},st=function(e){var t=Math.exp(e);return t=(t+1/t)/2,t},it=function(e,t,o){for(var n=Math.sin(t),a=Math.cos(t),s=et(o),l=st(o),d=2*a*l,p=-2*n*s,c=e.length-1,u=e[c],m=0,g=0,f=0,y,_;0<=--c;)y=g,_=m,g=u,m=f,u=-y+d*g-p*m+e[c],f=-_+p*g+d*m;return d=n*l,p=a*s,[d*u-p*f,d*f+p*u]},lt={init:function(){if(void 0===this.es||0>=this.es)throw new Error("incorrect elliptical usage");this.x0=void 0===this.x0?0:this.x0,this.y0=void 0===this.y0?0:this.y0,this.long0=void 0===this.long0?0:this.long0,this.lat0=void 0===this.lat0?0:this.lat0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),o=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),o*=t,this.cgb[1]=o*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=o*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),o*=t,this.cgb[2]=o*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=o*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),o*=t,this.cgb[3]=o*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=o*(1237/630+t*(-12/5+t*(-24832/14175))),o*=t,this.cgb[4]=o*(4174/315+t*(-144838/6237)),this.cbg[4]=o*(-734/315+t*(109598/31185)),o*=t,this.cgb[5]=o*(601676/22275),this.cbg[5]=o*(444337/155925),o=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+o*(1/4+o*(1/64+o/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=o*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=o*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),o*=t,this.utg[2]=o*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=o*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),o*=t,this.utg[3]=o*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=o*(49561/161280+t*(-179/168+t*(6601661/7257600))),o*=t,this.utg[4]=o*(-4583/161280+t*(108847/3991680)),this.gtu[4]=o*(34729/80640+t*(-3418889/1995840)),o*=t,this.utg[5]=o*(-20648693/638668800),this.gtu[5]=o*(212378941/319334400);var n=at(this.cbg,this.lat0);this.Zb=-this.Qn*(n+rt(this.gtu,2*n))},forward:function(e){var t=Oe(e.x-this.long0),o=e.y;o=at(this.cbg,o);var n=Math.sin(o),a=Math.cos(o),r=Math.sin(t),s=Math.cos(t);o=Math.atan2(n,s*a),t=Math.atan2(r*a,tt(n,a*s)),t=nt(Math.tan(t));var i=it(this.gtu,2*o,2*t);o+=i[0],t+=i[1];var l,d;return 2.623395162778>=Math.abs(t)?(l=this.a*(this.Qn*t)+this.x0,d=this.a*(this.Qn*o+this.Zb)+this.y0):(l=1/0,d=1/0),e.x=l,e.y=d,e},inverse:function(e){var t=(e.x-this.x0)*(1/this.a),o=(e.y-this.y0)*(1/this.a);o=(o-this.Zb)/this.Qn,t/=this.Qn;var n,a;if(2.623395162778>=Math.abs(t)){var r=it(this.utg,2*o,2*t);o+=r[0],t+=r[1],t=Math.atan(et(t));var s=Math.sin(o),i=Math.cos(o),l=Math.sin(t),d=Math.cos(t);o=Math.atan2(s*d,tt(l,d*i)),t=Math.atan2(l,d*i),n=Oe(t+this.long0),a=at(this.cgb,o)}else n=1/0,a=1/0;return e.x=n,e.y=a,e},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},dt=function(e,t){if(void 0===e){if(e=Math.floor(30*(Oe(t)+Math.PI)/Math.PI)+1,0>e)return 0;if(60<e)return 60}return e},pt={init:function(){var e=dt(this.zone,this.long0);if(void 0===e)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*de,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,lt.init.apply(this),this.forward=lt.forward,this.inverse=lt.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},ct=function(e,t){return Math.pow((1-e)/(1+e),t)},ut={init:function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ce)/(Math.pow(Math.tan(.5*this.lat0+ce),this.C)*ct(this.e*e,this.ratexp))},forward:function(e){var t=e.x,o=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*o+ce),this.C)*ct(this.e*Math.sin(o),this.ratexp))-ae,e.x=this.C*t,e},inverse:function(e){for(var t=e.x/this.C,o=e.y,n=Math.pow(Math.tan(.5*o+ce)/this.K,1/this.C),a=20;0<a&&(o=2*Math.atan(n*ct(this.e*Math.sin(e.y),-.5*this.e))-ae,!(Math.abs(o-e.y)<1e-14));--a)e.y=o;return a?(e.x=t,e.y=o,e):null},names:["gauss"]},mt={init:function(){ut.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,!this.title&&(this.title="Oblique Stereographic Alternative"))},forward:function(e){var t,o,n,a;return e.x=Oe(e.x-this.long0),ut.forward.apply(this,[e]),t=Math.sin(e.y),o=Math.cos(e.y),n=Math.cos(e.x),a=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*o*n),e.x=a*o*Math.sin(e.x),e.y=a*(this.cosc0*t-this.sinc0*o*n),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function(e){var t,o,n,a,r;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,r=Math.sqrt(e.x*e.x+e.y*e.y)){var s=2*Math.atan2(r,this.R2);t=Math.sin(s),o=Math.cos(s),a=Math.asin(o*this.sinc0+e.y*t*this.cosc0/r),n=Math.atan2(e.x*t,r*this.cosc0*o-e.y*this.sinc0*t)}else a=this.phic0,n=0;return e.x=n,e.y=a,ut.inverse.apply(this,[e]),e.x=Oe(e.x+this.long0),e},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},gt={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=le&&(this.k0=.5*(1+Ne(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=le&&(0<this.lat0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=le&&(this.k0=.5*this.cons*Te(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Me(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Te(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-ae,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(e){var t=e.x,o=e.y,n=Math.sin(o),a=Math.cos(o),r=Oe(t-this.long0),s,i,l,d,p,c;return Math.abs(Math.abs(t-this.long0)-Math.PI)<=le&&Math.abs(o+this.lat0)<=le?(e.x=NaN,e.y=NaN,e):this.sphere?(s=2*this.k0/(1+this.sinlat0*n+this.coslat0*a*Math.cos(r)),e.x=65*this.a*a*Math.sin(r)+this.x0,e.y=65*this.a*(this.coslat0*n-this.sinlat0*a*Math.cos(r))+this.y0,e):(i=2*Math.atan(this.ssfn_(o,n,this.e))-ae,d=Math.cos(i),l=Math.sin(i),Math.abs(this.coslat0)<=le)?(p=Me(this.e,o*this.con,this.con*n),c=2*this.a*this.k0*p/this.cons,e.x=this.x0+c*Math.sin(t-this.long0),e.y=this.y0-this.con*c*Math.cos(t-this.long0),e):(Math.abs(this.sinlat0)<le?(s=2*this.a*this.k0/(1+d*Math.cos(r)),e.y=65*l):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*l+this.cosX0*d*Math.cos(r))),e.y=65*(this.cosX0*l-this.sinX0*d*Math.cos(r))+this.y0),e.x=65*d*Math.sin(r)+this.x0,e)},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=Math.sqrt(e.x*e.x+e.y*e.y),o,n,a,r,s;if(this.sphere){var i=2*Math.atan(t/(2*this.a*this.k0));return(o=this.long0,n=this.lat0,t<=le)?(e.x=o,e.y=n,e):(n=Math.asin(Math.cos(i)*this.sinlat0+e.y*Math.sin(i)*this.coslat0/t),o=Math.abs(this.coslat0)<le?0<this.lat0?Oe(this.long0+Math.atan2(e.x,-1*e.y)):Oe(this.long0+Math.atan2(e.x,e.y)):Oe(this.long0+Math.atan2(e.x*Math.sin(i),t*this.coslat0*Math.cos(i)-e.y*this.sinlat0*Math.sin(i))),e.x=o,e.y=n,e)}if(Math.abs(this.coslat0)<=le){if(t<=le)return n=this.lat0,o=this.long0,e.x=o,e.y=n,e;e.x*=this.con,e.y*=this.con,a=t*this.cons/(2*this.a*this.k0),n=this.con*De(this.e,a),o=this.con*Oe(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else r=2*Math.atan(t*this.cosX0/(2*this.a*this.k0*this.ms1)),o=this.long0,t<=le?s=this.X0:(s=Math.asin(Math.cos(r)*this.sinX0+e.y*Math.sin(r)*this.cosX0/t),o=Oe(this.long0+Math.atan2(e.x*Math.sin(r),t*this.cosX0*Math.cos(r)-e.y*this.sinX0*Math.sin(r)))),n=-1*De(this.e,Math.tan(.5*(ae+s)));return e.x=o,e.y=n,e},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(e,t,o){return t*=o,Math.tan(.5*(ae+e))*Math.pow((1-t)/(1+t),.5*o)}},ft={init:function(){var t=this.lat0;this.lambda0=this.long0;var o=Math.sin(t),n=this.a,a=this.rf,r=1/a,s=2*r-Math.pow(r,2),i=this.e=Math.sqrt(s);this.R=this.k0*n*Math.sqrt(1-s)/(1-s*Math.pow(o,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(o/this.alpha);var e=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+t/2)),d=Math.log((1+i*o)/(1-i*o));this.K=e-this.alpha*l+this.alpha*i/2*d},forward:function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),o=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),n=-this.alpha*(t+o)+this.K,a=2*(Math.atan(Math.exp(n))-Math.PI/4),r=this.alpha*(e.x-this.lambda0),s=Math.atan(Math.sin(73)/(Math.sin(this.b0)*Math.tan(a)+Math.cos(this.b0)*Math.cos(73))),i=Math.asin(Math.cos(this.b0)*Math.sin(a)-Math.sin(this.b0)*Math.cos(a)*Math.cos(73));return e.y=this.R/2*Math.log((1+Math.sin(i))/(1-Math.sin(i)))+this.y0,e.x=this.R*s+this.x0,e},inverse:function(e){for(var t=e.x-this.x0,o=e.y-this.y0,n=t/this.R,a=2*(Math.atan(Math.exp(o/this.R))-Math.PI/4),r=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(n)),s=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(a))),i=this.lambda0+73/this.alpha,l=0,d=r,p=-1e3,c=0;1e-7<Math.abs(d-p);){if(20<++c)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+r/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(d))/2)),p=d,d=2*Math.atan(Math.exp(l))-Math.PI/2}return e.x=i,e.y=d,e},names:["somerc"]},yt={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var e=Math.sin(this.lat0),t=Math.cos(this.lat0),o=this.e*e;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(t,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-o*o);var n=Me(this.e,this.lat0,e),a=this.bl/t*Math.sqrt((1-this.es)/(1-o*o));1>a*a&&(a=1);var r,s;if(!isNaN(this.longc))r=0<=this.lat0?a+Math.sqrt(a*a-1):a-Math.sqrt(a*a-1),this.el=r*Math.pow(n,this.bl),s=.5*(r-1/r),this.gamma0=Math.asin(Math.sin(this.alpha)/a),this.long0=this.longc-Math.asin(s*Math.tan(this.gamma0))/this.bl;else{var i=Me(this.e,this.lat1,Math.sin(this.lat1)),l=Me(this.e,this.lat2,Math.sin(this.lat2));this.el=0<=this.lat0?(a+Math.sqrt(a*a-1))*Math.pow(n,this.bl):(a-Math.sqrt(a*a-1))*Math.pow(n,this.bl);var d=Math.pow(i,this.bl),p=Math.pow(l,this.bl);r=this.el/d,s=.5*(r-1/r);var c=(this.el*this.el-p*d)/(this.el*this.el+p*d),u=Oe(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(c*Math.tan(.5*this.bl*u)/((p-d)/(p+d)))/this.bl,this.long0=Oe(this.long0);var m=Oe(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*m)/s),this.alpha=Math.asin(a*Math.sin(this.gamma0))}this.uc=this.no_off?0:0<=this.lat0?this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(a*a-1),Math.cos(this.alpha))},forward:function(e){var o=e.x,n=e.y,a=Oe(o-this.long0),r,s,i;if(Math.abs(Math.abs(n)-ae)<=le)i=0<n?-1:1,s=this.al/this.bl*Math.log(Math.tan(ce+.5*(i*this.gamma0))),r=-1*i*ae*this.al/this.bl;else{var l=Me(this.e,n,Math.sin(n)),t=this.el/Math.pow(l,this.bl),d=.5*(t-1/t),p=Math.sin(this.bl*a),c=(d*Math.sin(this.gamma0)-p*Math.cos(this.gamma0))/(.5*(t+1/t));s=Math.abs(Math.abs(c)-1)<=le?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-c)/(1+c))/this.bl,r=Math.abs(Math.cos(this.bl*a))<=le?this.al*this.bl*a:this.al*Math.atan2(d*Math.cos(this.gamma0)+p*Math.sin(this.gamma0),Math.cos(this.bl*a))/this.bl}return this.no_rot?(e.x=this.x0+r,e.y=this.y0+s):(r-=this.uc,e.x=this.x0+s*Math.cos(this.alpha)+r*Math.sin(this.alpha),e.y=this.y0+r*Math.cos(this.alpha)-s*Math.sin(this.alpha)),e},inverse:function(e){var t,o;this.no_rot?(o=e.y-this.y0,t=e.x-this.x0):(o=(e.x-this.x0)*Math.cos(this.alpha)-(e.y-this.y0)*Math.sin(this.alpha),t=(e.y-this.y0)*Math.cos(this.alpha)+(e.x-this.x0)*Math.sin(this.alpha),t+=this.uc);var n=Math.exp(-1*this.bl*o/this.al),a=.5*(n-1/n),r=Math.sin(this.bl*t/this.al),s=(r*Math.cos(this.gamma0)+a*Math.sin(this.gamma0))/(.5*(n+1/n)),i=Math.pow(this.el/Math.sqrt((1+s)/(1-s)),1/this.bl);return Math.abs(s-1)<le?(e.x=this.long0,e.y=ae):Math.abs(s+1)<le?(e.x=this.long0,e.y=-1*ae):(e.y=De(this.e,i),e.x=Oe(this.long0-Math.atan2(a*Math.cos(this.gamma0)-r*Math.sin(this.gamma0),Math.cos(this.bl*t/this.al))/this.bl)),e},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},_t={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<le)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),o=Math.cos(this.lat1),n=Te(this.e,t,o),a=Me(this.e,this.lat1,t),r=Math.sin(this.lat2),s=Math.cos(this.lat2),i=Te(this.e,r,s),l=Me(this.e,this.lat2,r),d=Me(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>le?Math.log(n/i)/Math.log(a/l):t,isNaN(this.ns)&&(this.ns=t),this.f0=n/(this.ns*Math.pow(a,this.ns)),this.rh=this.a*this.f0*Math.pow(d,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(e){var t=e.x,o=e.y;Math.abs(2*Math.abs(o)-Math.PI)<=le&&(o=Ne(o)*(ae-2*le));var n=Math.abs(Math.abs(o)-ae),a,r;if(n>le)a=Me(this.e,o,Math.sin(o)),r=this.a*this.f0*Math.pow(a,this.ns);else{if(n=o*this.ns,0>=n)return null;r=0}var s=this.ns*Oe(t-this.long0);return e.x=this.k0*(r*Math.sin(s))+this.x0,e.y=this.k0*(this.rh-r*Math.cos(s))+this.y0,e},inverse:function(e){var t=(e.x-this.x0)/this.k0,o=this.rh-(e.y-this.y0)/this.k0,n,a,r,s,i;0<this.ns?(n=Math.sqrt(t*t+o*o),a=1):(n=-Math.sqrt(t*t+o*o),a=-1);var l=0;if(0!==n&&(l=Math.atan2(a*t,a*o)),!(0!==n||0<this.ns))s=-ae;else if(a=1/this.ns,r=Math.pow(n/(this.a*this.f0),a),s=De(this.e,r),-9999===s)return null;return i=Oe(l/this.ns+this.long0),e.x=i,e.y=s,e},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},Et={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(e){var t=e.x,o=e.y,n=Oe(t-this.long0),a,r,i,l,p,c,m;return a=Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.alfa*this.e/2),r=2*(Math.atan(this.k*Math.pow(Math.tan(o/2+this.s45),this.alfa)/a)-this.s45),i=-n*this.alfa,l=Math.asin(Math.cos(this.ad)*Math.sin(r)+Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),p=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(l)),c=this.n*p,m=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(l/2+this.s45),this.n),e.y=m*Math.cos(c)/1,e.x=m*Math.sin(c)/1,this.czech||(e.y*=-1,e.x*=-1),e},inverse:function(e){var t=e.x,o,n,a,r,i,l,p,c;e.x=e.y,e.y=t,this.czech||(e.y*=-1,e.x*=-1),l=Math.sqrt(e.x*e.x+e.y*e.y),i=Math.atan2(e.y,e.x),r=i/Math.sin(this.s0),a=2*(Math.atan(Math.pow(this.ro0/l,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),o=Math.asin(Math.cos(this.ad)*Math.sin(a)-Math.sin(this.ad)*Math.cos(a)*Math.cos(r)),n=Math.asin(Math.cos(a)*Math.sin(r)/Math.cos(o)),e.x=this.long0-n/this.alfa,p=o,c=0;var m=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(o/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(p))/(1-this.e*Math.sin(p)),this.e/2))-this.s45),1e-10>Math.abs(p-e.y)&&(c=1),p=e.y,m+=1;while(0===c&&15>m);return 15<=m?null:e},names:["Krovak","krovak"]},ht=function(e,t,o,n,a){return e*a-t*Math.sin(2*a)+o*Math.sin(4*a)-n*Math.sin(6*a)},bt=function(e){return 1-.25*e*(1+e/16*(3+1.25*e))},St=function(e){return .375*e*(1+.25*e*(1+.46875*e))},Pt=function(e){return .05859375*e*e*(1+.75*e)},Rt=function(e){return e*e*e*(35/3072)},xt=function(t,o,e){var n=o*e;return t/Math.sqrt(1-n*n)},vt=function(e){return Math.abs(e)<ae?e:e-Ne(e)*Math.PI},Ct=function(e,t,o,n,a){var r,s;r=e/t;for(var l=0;15>l;l++)if(s=(e-(t*r-o*Math.sin(2*r)+n*Math.sin(4*r)-a*Math.sin(6*r)))/(t-2*o*Math.cos(2*r)+4*n*Math.cos(4*r)-6*a*Math.cos(6*r)),r+=s,1e-10>=Math.abs(s))return r;return NaN},At={init:function(){this.sphere||(this.e0=bt(this.es),this.e1=St(this.es),this.e2=Pt(this.es),this.e3=Rt(this.es),this.ml0=this.a*ht(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(e){var t=e.x,o=e.y,n,a;if(t=Oe(t-this.long0),this.sphere)n=this.a*Math.asin(Math.cos(o)*Math.sin(t)),a=this.a*(Math.atan2(Math.tan(o),Math.cos(t))-this.lat0);else{var r=Math.sin(o),s=Math.cos(o),i=xt(this.a,this.e,r),l=Math.tan(o)*Math.tan(o),d=t*Math.cos(o),p=d*d,c=this.es*s*s/(1-this.es),u=this.a*ht(this.e0,this.e1,this.e2,this.e3,o);n=i*d*(1-p*l*(1/6-(8-l+8*c)*p/120)),a=u-this.ml0+i*r/s*p*(.5+(5-l+6*c)*p/24)}return e.x=n+this.x0,e.y=a+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,o=e.y/this.a,n,a;if(this.sphere){var r=o+this.lat0;n=Math.asin(Math.sin(r)*Math.cos(t)),a=Math.atan2(Math.tan(t),Math.cos(r))}else{var s=this.ml0/this.a+o,i=Ct(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(i)-ae)<=le)return e.x=this.long0,e.y=ae,0>o&&(e.y*=-1),e;var l=xt(this.a,this.e,Math.sin(i)),d=l*l*l/this.a/this.a*(1-this.es),p=Math.pow(Math.tan(i),2),c=t*this.a/l,u=c*c;n=i-l*Math.tan(i)/d*c*c*(.5-(1+3*p)*c*c/24),a=c*(1-u*(p/3+(1+3*p)*p*u/15))/Math.cos(i)}return e.x=Oe(a+this.long0),e.y=vt(n),e},names:["Cassini","Cassini_Soldner","cass"]},Lt=function(e,t){var o;return 1e-7<e?(o=e*t,(1-e*e)*(t/(1-o*o)-.5/e*Math.log((1-o)/(1+o)))):2*t},It=.3333333333333333,wt=.17222222222222222,Tt=.10257936507936508,Nt=.06388888888888888,Ot=.0664021164021164,Mt=.016415012942191543,Dt={init:function(){var e=Math.abs(this.lat0);if(this.mode=Math.abs(e-ae)<le?0>this.lat0?this.S_POLE:this.N_POLE:Math.abs(e)<le?this.EQUIT:this.OBLIQ,0<this.es){var t;switch(this.qp=Lt(this.e,1),this.mmf=.5/(1-this.es),this.apa=J(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Lt(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(e){var t=e.x,o=e.y,n,a,r,s,i,l,d,p,c,u;if(t=Oe(t-this.long0),!this.sphere){switch(d=0,p=0,c=0,r=Math.cos(t),s=Math.sin(t),i=Math.sin(o),l=Lt(this.e,i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(d=l/this.qp,p=Math.sqrt(1-d*d)),this.mode){case this.OBLIQ:c=1+this.sinb1*d+this.cosb1*p*r;break;case this.EQUIT:c=1+p*r;break;case this.N_POLE:c=ae+o,l=this.qp-l;break;case this.S_POLE:c=o-ae,l=this.qp+l;}if(Math.abs(c)<le)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),a=this.mode===this.OBLIQ?this.ymf*c*(this.cosb1*d-this.sinb1*p*r):(c=Math.sqrt(2/(1+p*r)))*d*this.ymf,n=this.xmf*c*p*s;break;case this.N_POLE:case this.S_POLE:0<=l?(n=(c=Math.sqrt(l))*s,a=r*(this.mode===this.S_POLE?c:-c)):n=a=0;}}else if(i=Math.sin(o),u=Math.cos(o),r=Math.cos(t),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(a=this.mode===this.EQUIT?1+u*r:1+this.sinph0*i+this.cosph0*u*r,a<=le)return null;a=Math.sqrt(2/a),n=a*u*Math.sin(t),a*=this.mode===this.EQUIT?i:this.cosph0*i-this.sinph0*u*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(o+this.lat0)<le)return null;a=ce-.5*o,a=2*(this.mode===this.S_POLE?Math.cos(a):Math.sin(a)),n=a*Math.sin(t),a*=r}return e.x=this.a*n+this.x0,e.y=this.a*a+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,o=e.y/this.a,n,a,r,s,i,l,d;if(this.sphere){var p=0,c=0,u;if(u=Math.sqrt(t*t+o*o),a=.5*u,1<a)return null;switch(a=2*Math.asin(a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(c=Math.sin(a),p=Math.cos(a)),this.mode){case this.EQUIT:a=Math.abs(u)<=le?0:Math.asin(o*c/u),t*=c,o=p*u;break;case this.OBLIQ:a=Math.abs(u)<=le?this.lat0:Math.asin(p*this.sinph0+o*c*this.cosph0/u),t*=c*this.cosph0,o=(p-Math.sin(a)*this.sinph0)*u;break;case this.N_POLE:o=-o,a=ae-a;break;case this.S_POLE:a-=ae;}n=0===o&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,o)}else{if(d=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,o*=this.dd,l=Math.sqrt(t*t+o*o),l<le)return e.x=this.long0,e.y=this.lat0,e;s=2*Math.asin(.5*l/this.rq),r=Math.cos(s),t*=s=Math.sin(s),this.mode===this.OBLIQ?(d=r*this.sinb1+o*s*this.cosb1/l,i=this.qp*d,o=l*this.cosb1*r-o*this.sinb1*s):(d=o*s/l,i=this.qp*d,o=l*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(o=-o),i=t*t+o*o,!i)return e.x=this.long0,e.y=this.lat0,e;d=1-i/this.qp,this.mode===this.S_POLE&&(d=-d)}n=Math.atan2(t,o),a=Z(Math.asin(d),this.apa)}return e.x=Oe(this.long0+n),e.y=a,e},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},Gt=function(e){return 1<Math.abs(e)&&(e=1<e?1:-1),Math.asin(e)},kt={init:function(){Math.abs(this.lat1+this.lat2)<le||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Te(this.e3,this.sin_po,this.cos_po),this.qs1=Lt(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Te(this.e3,this.sin_po,this.cos_po),this.qs2=Lt(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Lt(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>le?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(e){var t=e.x,o=e.y;this.sin_phi=Math.sin(o),this.cos_phi=Math.cos(o);var n=Lt(this.e3,this.sin_phi,this.cos_phi),a=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,r=this.ns0*Oe(t-this.long0),s=a*Math.sin(r)+this.x0,i=this.rh-a*Math.cos(r)+this.y0;return e.x=s,e.y=i,e},inverse:function(e){var t,o,n,a,r,s;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,0<=this.ns0?(t=Math.sqrt(e.x*e.x+e.y*e.y),n=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),n=-1),a=0,0!==t&&(a=Math.atan2(n*e.x,n*e.y)),n=t*this.ns0/this.a,this.sphere?s=Math.asin((this.c-n*n)/(2*this.ns0)):(o=(this.c-n*n)/this.ns0,s=this.phi1z(this.e3,o)),r=Oe(a/this.ns0+this.long0),e.x=r,e.y=s,e},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(e,t){var o=Gt(.5*t),n,a,r,s,l;if(e<le)return o;for(var d=1;25>=d;d++)if(n=Math.sin(o),a=Math.cos(o),r=e*n,s=1-r*r,l=.5*s*s/a*(t/(1-e*e)-n/s+.5/e*Math.log((1-r)/(1+r))),o+=l,1e-7>=Math.abs(l))return o;return null}},Ut={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(e){var t=e.x,o=e.y,n,a,r,s,i,l,d,p;return r=Oe(t-this.long0),n=Math.sin(o),a=Math.cos(o),s=Math.cos(r),l=this.sin_p14*n+this.cos_p14*a*s,i=1,0<l||Math.abs(l)<=le?(d=this.x0+this.a*i*a*Math.sin(r)/l,p=this.y0+this.a*i*(this.cos_p14*n-this.sin_p14*a*s)/l):(d=this.x0+this.infinity_dist*a*Math.sin(r),p=this.y0+this.infinity_dist*(this.cos_p14*n-this.sin_p14*a*s)),e.x=d,e.y=p,e},inverse:function(e){var t,o,n,a,r,s;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(a=Math.atan2(t,this.rc),o=Math.sin(a),n=Math.cos(a),s=Gt(n*this.sin_p14+e.y*o*this.cos_p14/t),r=Math.atan2(e.x*o,t*this.cos_p14*n-e.y*this.sin_p14*o),r=Oe(this.long0+r)):(s=this.phic0,r=0),e.x=r,e.y=s,e},names:["gnom"]},qt=function(e,t){var o=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(1e-6>Math.abs(Math.abs(t)-o))return 0>t?-1*ae:ae;for(var n=Math.asin(.5*t),a=0,r,s,l,d;30>a;a++)if(s=Math.sin(n),l=Math.cos(n),d=e*s,r=Math.pow(1-d*d,2)/(2*l)*(t/(1-e*e)-s/(1-d*d)+.5/e*Math.log((1-d)/(1+d))),n+=r,1e-10>=Math.abs(r))return n;return NaN},jt={init:function(){this.sphere||(this.k0=Te(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(e){var t=e.x,o=e.y,n=Oe(t-this.long0),a,r;if(this.sphere)a=this.x0+this.a*n*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(o)/Math.cos(this.lat_ts);else{var s=Lt(this.e,Math.sin(o));a=this.x0+this.a*this.k0*n,r=this.y0+.5*(this.a*s)/this.k0}return e.x=a,e.y=r,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,o;return this.sphere?(t=Oe(this.long0+e.x/this.a/Math.cos(this.lat_ts)),o=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(o=qt(this.e,2*e.y*this.k0/this.a),t=Oe(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=o,e},names:["cea"]},Vt={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(e){var t=e.x,o=e.y,n=Oe(t-this.long0),a=vt(o-this.lat0);return e.x=this.x0+this.a*n*this.rc,e.y=this.y0+this.a*a,e},inverse:function(e){var t=e.x,o=e.y;return e.x=Oe(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=vt(this.lat0+(o-this.y0)/this.a),e},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Bt={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=bt(this.es),this.e1=St(this.es),this.e2=Pt(this.es),this.e3=Rt(this.es),this.ml0=this.a*ht(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(e){var t=e.x,o=e.y,n=Oe(t-this.long0),a,r,s;if(s=n*Math.sin(o),this.sphere)Math.abs(o)<=le?(a=this.a*n,r=-1*this.a*this.lat0):(a=this.a*Math.sin(s)/Math.tan(o),r=this.a*(vt(o-this.lat0)+(1-Math.cos(s))/Math.tan(o)));else if(Math.abs(o)<=le)a=this.a*n,r=-1*this.ml0;else{var i=xt(this.a,this.e,Math.sin(o))/Math.tan(o);a=i*Math.sin(s),r=this.a*ht(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+i*(1-Math.cos(s))}return e.x=a+this.x0,e.y=r+this.y0,e},inverse:function(e){var t,o,n,a,r,s,l,d,p;if(n=e.x-this.x0,a=e.y-this.y0,this.sphere){if(Math.abs(a+this.a*this.lat0)<=le)t=Oe(n/this.a+this.long0),o=0;else{s=this.lat0+a/this.a,l=n*n/this.a/this.a+s*s,d=s;var c;for(r=20;r;--r)if(c=Math.tan(d),p=-1*(s*(d*c+1)-d-.5*(d*d+l)*c)/((d-s)/c-1),d+=p,Math.abs(p)<=le){o=d;break}t=Oe(this.long0+Math.asin(n*Math.tan(d)/this.a)/Math.sin(o))}}else if(Math.abs(a+this.ml0)<=le)o=0,t=Oe(this.long0+n/this.a);else{s=(this.ml0+a)/this.a,l=n*n/this.a/this.a+s*s,d=s;var u,m,g,f,_;for(r=20;r;--r)if(_=this.e*Math.sin(d),u=Math.sqrt(1-_*_)*Math.tan(d),m=this.a*ht(this.e0,this.e1,this.e2,this.e3,d),g=this.e0-2*this.e1*Math.cos(2*d)+4*this.e2*Math.cos(4*d)-6*this.e3*Math.cos(6*d),f=m/this.a,p=(s*(u*f+1)-f-.5*u*(f*f+l))/(this.es*Math.sin(2*d)*(f*f+l-2*s*f)/(4*u)+(s-f)*(u*g-2/Math.sin(2*d))-g),d-=p,Math.abs(p)<=le){o=d;break}u=Math.sqrt(1-this.es*Math.pow(Math.sin(o),2))*Math.tan(o),t=Oe(this.long0+Math.asin(n*u/this.a)/Math.sin(o))}return e.x=t,e.y=o,e},names:["Polyconic","poly"]},Ft={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(e){var t=e.x,o=e.y,a=o-this.lat0,r=t-this.long0,s=1,i=0,l;for(l=1;10>=l;l++)s*=1E-5*(a/ne),i+=this.A[l]*s;var d=i,p=r,c=1,u=0,m=0,g=0,f,y;for(l=1;6>=l;l++)f=c*d-u*p,y=u*d+c*p,c=f,u=y,m=m+this.B_re[l]*c-this.B_im[l]*u,g=g+this.B_im[l]*c+this.B_re[l]*u;return e.x=g*this.a+this.x0,e.y=m*this.a+this.y0,e},inverse:function(e){var t=e.x,o=e.y,a=t-this.x0,r=o-this.y0,s=r/this.a,l=a/this.a,d=1,p=0,c=0,u=0,m,g,f;for(m=1;6>=m;m++)g=d*s-p*l,f=p*s+d*l,d=g,p=f,c=c+this.C_re[m]*d-this.C_im[m]*p,u=u+this.C_im[m]*d+this.C_re[m]*p;for(var y=0;y<this.iterations;y++){var _=c,E=u,h=s,b=l,S,P;for(m=2;6>=m;m++)S=_*c-E*u,P=E*c+_*u,_=S,E=P,h+=(m-1)*(this.B_re[m]*_-this.B_im[m]*E),b+=(m-1)*(this.B_im[m]*_+this.B_re[m]*E);_=1,E=0;var R=this.B_re[1],x=this.B_im[1];for(m=2;6>=m;m++)S=_*c-E*u,P=E*c+_*u,_=S,E=P,R+=m*(this.B_re[m]*_-this.B_im[m]*E),x+=m*(this.B_im[m]*_+this.B_re[m]*E);var v=R*R+x*x;c=(h*R+b*x)/v,u=(b*R-h*x)/v}var C=c,A=u,L=1,I=0;for(m=1;9>=m;m++)L*=C,I+=this.D[m]*L;var w=this.lat0+1E5*(I*ne),T=this.long0+A;return e.x=T,e.y=w,e},names:["New_Zealand_Map_Grid","nzmg"]},Ht={init:function(){},forward:function(e){var t=e.x,o=e.y,n=Oe(t-this.long0),a=this.x0+this.a*n,r=this.y0+1.25*(this.a*Math.log(Math.tan(Math.PI/4+o/2.5)));return e.x=a,e.y=r,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=Oe(this.long0+e.x/this.a),o=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=o,e},names:["Miller_Cylindrical","mill"]},zt={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Qe(this.es)},forward:function(e){var t=e.x,o=e.y,n,a;if(t=Oe(t-this.long0),this.sphere){if(!this.m)o=1===this.n?o:Math.asin(this.n*Math.sin(o));else for(var r=this.n*Math.sin(o),l=20,d;l&&(d=(this.m*o+Math.sin(o)-r)/(this.m+Math.cos(o)),o-=d,!(Math.abs(d)<le));--l);n=this.a*this.C_x*t*(this.m+Math.cos(o)),a=this.a*this.C_y*o}else{var p=Math.sin(o),s=Math.cos(o);a=this.a*Je(o,p,s,this.en),n=this.a*t*s/Math.sqrt(1-this.es*p*p)}return e.x=n,e.y=a,e},inverse:function(e){var t,o,n,a;return e.x-=this.x0,n=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,n/=this.C_x*(this.m+Math.cos(t)),this.m?t=Gt((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=Gt(Math.sin(t)/this.n)),n=Oe(n+this.long0),t=vt(t)):(t=Ze(e.y/this.a,this.es,this.en),a=Math.abs(t),a<ae?(a=Math.sin(t),o=this.long0+e.x*Math.sqrt(1-this.es*a*a)/(this.a*Math.cos(t)),n=Oe(o)):a-le<ae&&(n=this.long0)),e.x=n,e.y=t,e},names:["Sinusoidal","sinu"]},Xt={init:function(){},forward:function(e){for(var t=e.x,o=e.y,n=Oe(t-this.long0),a=o,r=Math.PI*Math.sin(o),s;s=-(a+Math.sin(a)-r)/(1+Math.cos(a)),a+=s,!(Math.abs(s)<le););a/=2,Math.PI/2-Math.abs(o)<le&&(n=0);var i=.900316316158*this.a*n*Math.cos(a)+this.x0,l=1.4142135623731*this.a*Math.sin(a)+this.y0;return e.x=i,e.y=l,e},inverse:function(e){var t,o;e.x-=this.x0,e.y-=this.y0,o=e.y/(1.4142135623731*this.a),.999999999999<Math.abs(o)&&(o=.999999999999),t=Math.asin(o);var n=Oe(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),o=(2*t+Math.sin(2*t))/Math.PI,1<Math.abs(o)&&(o=1);var a=Math.asin(o);return e.x=n,e.y=a,e},names:["Mollweide","moll"]},Yt={init:function(){Math.abs(this.lat1+this.lat2)<le||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=bt(this.es),this.e1=St(this.es),this.e2=Pt(this.es),this.e3=Rt(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Te(this.e,this.sinphi,this.cosphi),this.ml1=ht(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<le?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Te(this.e,this.sinphi,this.cosphi),this.ml2=ht(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=ht(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(e){var t=e.x,o=e.y,n;if(this.sphere)n=this.a*(this.g-o);else{var a=ht(this.e0,this.e1,this.e2,this.e3,o);n=this.a*(this.g-a)}var r=this.ns*Oe(t-this.long0),s=this.x0+n*Math.sin(r),i=this.y0+this.rh-n*Math.cos(r);return e.x=s,e.y=i,e},inverse:function(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,o,n,a;0<=this.ns?(o=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(o=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var r=0;if(0!==o&&(r=Math.atan2(t*e.x,t*e.y)),this.sphere)return a=Oe(this.long0+r/this.ns),n=vt(this.g-o/this.a),e.x=a,e.y=n,e;var s=this.g-o/this.a;return n=Ct(s,this.e0,this.e1,this.e2,this.e3),a=Oe(this.long0+r/this.ns),e.x=a,e.y=n,e},names:["Equidistant_Conic","eqdc"]},Wt={init:function(){this.R=this.a},forward:function(e){var t=e.x,o=e.y,n=Oe(t-this.long0),a,r;Math.abs(o)<=le&&(a=this.x0+this.R*n,r=this.y0);var s=Gt(2*Math.abs(o/Math.PI));(Math.abs(n)<=le||Math.abs(Math.abs(o)-ae)<=le)&&(a=this.x0,r=0<=o?this.y0+Math.PI*this.R*Math.tan(.5*s):this.y0+Math.PI*this.R*-Math.tan(.5*s));var i=.5*Math.abs(Math.PI/n-n/Math.PI),l=i*i,d=Math.sin(s),p=Math.cos(s),c=p/(d+p-1),u=c*(2/d-1),m=u*u,g=Math.PI*this.R*(i*(c-m)+Math.sqrt(l*(c-m)*(c-m)-(m+l)*(c*c-m)))/(m+l);0>n&&(g=-g),a=this.x0+g;var f=l+c;return g=Math.PI*this.R*(u*f-i*Math.sqrt((m+l)*(l+1)-f*f))/(m+l),r=0<=o?this.y0+g:this.y0-g,e.x=a,e.y=r,e},inverse:function(e){var t,o,n,a,r,s,i,l,p,c,u,m,g;return e.x-=this.x0,e.y-=this.y0,u=Math.PI*this.R,n=e.x/u,a=e.y/u,r=n*n+a*a,s=-Math.abs(a)*(1+r),i=s-2*a*a+n*n,l=-2*s+1+2*a*a+r*r,g=a*a/l+(2*i*i*i/l/l/l-9*s*i/l/l)/27,p=(s-i*i/3/l)/l,c=2*Math.sqrt(-p/3),u=3*g/p/c,1<Math.abs(u)&&(0<=u?u=1:u=-1),m=Math.acos(u)/3,o=0<=e.y?(-c*Math.cos(m+Math.PI/3)-i/3/l)*Math.PI:-(-c*Math.cos(m+Math.PI/3)-i/3/l)*Math.PI,t=Math.abs(n)<le?this.long0:Oe(this.long0+Math.PI*(r-1+Math.sqrt(1+2*(n*n-a*a)+r*r))/2/n),e.x=t,e.y=o,e},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},Kt={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(e){var t=e.x,o=e.y,n=Math.sin(e.y),a=Math.cos(e.y),r=Oe(t-this.long0),i,l,d,p,u,m,g,f,y,_,E,h,b,S,P,R,x,v,C,A,L,I,w;return this.sphere?Math.abs(this.sin_p12-1)<=le?(e.x=this.x0+this.a*(ae-o)*Math.sin(r),e.y=this.y0-this.a*(ae-o)*Math.cos(r),e):Math.abs(this.sin_p12+1)<=le?(e.x=this.x0+this.a*(ae+o)*Math.sin(r),e.y=this.y0+this.a*(ae+o)*Math.cos(r),e):(v=this.sin_p12*n+this.cos_p12*a*Math.cos(r),R=Math.acos(v),x=R?R/Math.sin(R):1,e.x=this.x0+this.a*x*a*Math.sin(r),e.y=this.y0+this.a*x*(this.cos_p12*n-this.sin_p12*a*Math.cos(r)),e):(i=bt(this.es),l=St(this.es),d=Pt(this.es),p=Rt(this.es),Math.abs(this.sin_p12-1)<=le?(u=this.a*ht(i,l,d,p,ae),m=this.a*ht(i,l,d,p,o),e.x=this.x0+(u-m)*Math.sin(r),e.y=this.y0-(u-m)*Math.cos(r),e):Math.abs(this.sin_p12+1)<=le?(u=this.a*ht(i,l,d,p,ae),m=this.a*ht(i,l,d,p,o),e.x=this.x0+(u+m)*Math.sin(r),e.y=this.y0+(u+m)*Math.cos(r),e):(g=n/a,f=xt(this.a,this.e,this.sin_p12),y=xt(this.a,this.e,n),_=Math.atan((1-this.es)*g+this.es*f*this.sin_p12/(y*a)),E=Math.atan2(Math.sin(r),this.cos_p12*Math.tan(_)-this.sin_p12*Math.cos(r)),C=0===E?Math.asin(this.cos_p12*Math.sin(_)-this.sin_p12*Math.cos(_)):Math.abs(Math.abs(E)-Math.PI)<=le?-Math.asin(this.cos_p12*Math.sin(_)-this.sin_p12*Math.cos(_)):Math.asin(Math.sin(r)*Math.cos(_)/Math.sin(E)),h=this.e*this.sin_p12/Math.sqrt(1-this.es),b=this.e*this.cos_p12*Math.cos(E)/Math.sqrt(1-this.es),S=h*b,P=b*b,A=C*C,L=A*C,I=L*C,w=I*C,R=f*C*(1-A*P*(1-P)/6+L/8*S*(1-2*P)+I/120*(P*(4-7*P)-3*h*h*(1-7*P))-w/48*S),e.x=this.x0+R*Math.sin(E),e.y=this.y0+R*Math.cos(E),e))},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,o,n,a,r,s,i,l,d,p,c,u,m,g,f,y,_,E,h,b,S,P,R,x;return this.sphere?(t=Math.sqrt(e.x*e.x+e.y*e.y),t>2*ae*this.a)?void 0:(o=t/this.a,n=Math.sin(o),a=Math.cos(o),r=this.long0,Math.abs(t)<=le?s=this.lat0:(s=Gt(a*this.sin_p12+e.y*n*this.cos_p12/t),i=Math.abs(this.lat0)-ae,r=Math.abs(i)<=le?0<=this.lat0?Oe(this.long0+Math.atan2(e.x,-e.y)):Oe(this.long0-Math.atan2(-e.x,e.y)):Oe(this.long0+Math.atan2(e.x*n,t*this.cos_p12*a-e.y*this.sin_p12*n))),e.x=r,e.y=s,e):(l=bt(this.es),d=St(this.es),p=Pt(this.es),c=Rt(this.es),Math.abs(this.sin_p12-1)<=le?(u=this.a*ht(l,d,p,c,ae),t=Math.sqrt(e.x*e.x+e.y*e.y),m=u-t,s=Ct(m/this.a,l,d,p,c),r=Oe(this.long0+Math.atan2(e.x,-1*e.y)),e.x=r,e.y=s,e):Math.abs(this.sin_p12+1)<=le?(u=this.a*ht(l,d,p,c,ae),t=Math.sqrt(e.x*e.x+e.y*e.y),m=t-u,s=Ct(m/this.a,l,d,p,c),r=Oe(this.long0+Math.atan2(e.x,e.y)),e.x=r,e.y=s,e):(t=Math.sqrt(e.x*e.x+e.y*e.y),y=Math.atan2(e.x,e.y),g=xt(this.a,this.e,this.sin_p12),_=Math.cos(y),E=this.e*this.cos_p12*_,h=-E*E/(1-this.es),b=3*this.es*(1-h)*this.sin_p12*this.cos_p12*_/(1-this.es),S=t/g,P=S-h*(1+h)*Math.pow(S,3)/6-b*(1+3*h)*Math.pow(S,4)/24,R=1-h*P*P/2-S*P*P*P/6,f=Math.asin(this.sin_p12*Math.cos(P)+this.cos_p12*Math.sin(P)*_),r=Oe(this.long0+Math.asin(Math.sin(y)*Math.sin(P)/Math.cos(f))),x=Math.sin(f),s=Math.atan2((x-this.es*R*this.sin_p12)*Math.tan(f),x*(1-this.es)),e.x=r,e.y=s,e))},names:["Azimuthal_Equidistant","aeqd"]},Qt={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(e){var t=e.x,o=e.y,n,a,r,s,i,l,d,p;return r=Oe(t-this.long0),n=Math.sin(o),a=Math.cos(o),s=Math.cos(r),l=this.sin_p14*n+this.cos_p14*a*s,i=1,(0<l||Math.abs(l)<=le)&&(d=this.a*i*a*Math.sin(r),p=this.y0+this.a*i*(this.cos_p14*n-this.sin_p14*a*s)),e.x=d,e.y=p,e},inverse:function(e){var t,o,n,a,r,s,i;return(e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),o=Gt(t/this.a),n=Math.sin(o),a=Math.cos(o),s=this.long0,Math.abs(t)<=le)?(i=this.lat0,e.x=s,e.y=i,e):(i=Gt(a*this.sin_p14+e.y*n*this.cos_p14/t),r=Math.abs(this.lat0)-ae,Math.abs(r)<=le)?(s=0<=this.lat0?Oe(this.long0+Math.atan2(e.x,-e.y)):Oe(this.long0-Math.atan2(-e.x,e.y)),e.x=s,e.y=i,e):(s=Oe(this.long0+Math.atan2(e.x*n,t*this.cos_p14*a-e.y*this.sin_p14*n)),e.x=s,e.y=i,e)},names:["ortho"]},Jt={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Zt={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4},$t={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.face=this.lat0>=ae-ce/2?Jt.TOP:this.lat0<=-(ae-ce/2)?Jt.BOTTOM:Math.abs(this.long0)<=ce?Jt.FRONT:Math.abs(this.long0)<=ae+ce?0<this.long0?Jt.RIGHT:Jt.LEFT:Jt.BACK,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(e){var o={x:0,y:0},n={value:0},a,i,l,d,p,c;if(e.x-=this.long0,a=0===this.es?e.y:Math.atan(this.one_minus_f_squared*Math.tan(e.y)),i=e.x,this.face===Jt.TOP)d=ae-a,i>=ce&&i<=ae+ce?(n.value=Zt.AREA_0,l=i-ae):i>ae+ce||i<=-(ae+ce)?(n.value=Zt.AREA_1,l=0<i?i-me:i+me):i>-(ae+ce)&&i<=-ce?(n.value=Zt.AREA_2,l=i+ae):(n.value=Zt.AREA_3,l=i);else if(this.face===Jt.BOTTOM)d=ae+a,i>=ce&&i<=ae+ce?(n.value=Zt.AREA_0,l=-i+ae):i<ce&&i>=-ce?(n.value=Zt.AREA_1,l=-i):i<-ce&&i>=-(ae+ce)?(n.value=Zt.AREA_2,l=-i-ae):(n.value=Zt.AREA_3,l=0<i?-i+me:-i-me);else{var u,m,g,f,y,_,E;this.face===Jt.RIGHT?i=ee(i,+ae):this.face===Jt.BACK?i=ee(i,+me):this.face===Jt.LEFT&&(i=ee(i,-ae)),f=Math.sin(a),y=Math.cos(a),_=Math.sin(i),E=Math.cos(i),u=y*E,m=y*_,g=f,this.face===Jt.FRONT?(d=Math.acos(u),l=$(d,g,m,n)):this.face===Jt.RIGHT?(d=Math.acos(m),l=$(d,g,-u,n)):this.face===Jt.BACK?(d=Math.acos(-u),l=$(d,g,-m,n)):this.face===Jt.LEFT?(d=Math.acos(-m),l=$(d,g,u,n)):(d=l=0,n.value=Zt.AREA_0)}return c=Math.atan(12/me*(l+Math.acos(Math.sin(l)*Math.cos(ce))-ae)),p=Math.sqrt((1-Math.cos(d))/(Math.cos(c)*Math.cos(c))/(1-Math.cos(Math.atan(1/Math.cos(l))))),n.value===Zt.AREA_1?c+=ae:n.value===Zt.AREA_2?c+=me:n.value===Zt.AREA_3&&(c+=1.5*me),o.x=p*Math.cos(c),o.y=p*Math.sin(c),o.x=o.x*this.a+this.x0,o.y=o.y*this.a+this.y0,e.x=o.x,e.y=o.y,e},inverse:function(e){var o={lam:0,phi:0},n={value:0},a,i,l,d,p,c,u,m,g;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,i=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),a=Math.atan2(e.y,e.x),0<=e.x&&e.x>=Math.abs(e.y)?n.value=Zt.AREA_0:0<=e.y&&e.y>=Math.abs(e.x)?(n.value=Zt.AREA_1,a-=ae):0>e.x&&-e.x>=Math.abs(e.y)?(n.value=Zt.AREA_2,a=0>a?a+me:a-me):(n.value=Zt.AREA_3,a+=ae),g=me/12*Math.tan(a),p=Math.sin(g)/(Math.cos(g)-1/Math.sqrt(2)),c=Math.atan(p),l=Math.cos(a),d=Math.tan(i),u=1-l*l*d*d*(1-Math.cos(Math.atan(1/Math.cos(c)))),-1>u?u=-1:1<u&&(u=1),this.face===Jt.TOP)m=Math.acos(u),o.phi=ae-m,o.lam=n.value===Zt.AREA_0?c+ae:n.value===Zt.AREA_1?0>c?c+me:c-me:n.value===Zt.AREA_2?c-ae:c;else if(this.face===Jt.BOTTOM)m=Math.acos(u),o.phi=m-ae,o.lam=n.value===Zt.AREA_0?-c+ae:n.value===Zt.AREA_1?-c:n.value===Zt.AREA_2?-c-ae:0>c?-c-me:-c+me;else{var f,y,_;f=u,g=f*f,_=1<=g?0:Math.sqrt(1-g)*Math.sin(c),g+=_*_,y=1<=g?0:Math.sqrt(1-g),n.value===Zt.AREA_1?(g=y,y=-_,_=g):n.value===Zt.AREA_2?(y=-y,_=-_):n.value===Zt.AREA_3&&(g=y,y=_,_=-g),this.face===Jt.RIGHT?(g=f,f=-y,y=g):this.face===Jt.BACK?(f=-f,y=-y):this.face===Jt.LEFT&&(g=f,f=y,y=-g),o.phi=Math.acos(-_)-ae,o.lam=Math.atan2(y,f),this.face===Jt.RIGHT?o.lam=ee(o.lam,-ae):this.face===Jt.BACK?o.lam=ee(o.lam,-me):this.face===Jt.LEFT&&(o.lam=ee(o.lam,+ae))}if(0!==this.es){var E,h,b;E=0>o.phi?1:0,h=Math.tan(o.phi),b=this.b/Math.sqrt(h*h+this.one_minus_f_squared),o.phi=Math.atan(Math.sqrt(this.a*this.a-b*b)/(this.one_minus_f*b)),E&&(o.phi=-o.phi)}return o.lam+=this.long0,e.x=o.lam,e.y=o.phi,e},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},eo=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],to=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,422642e-15],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],oo=.8487,no=1.3523,ao=pe/5,ro=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))},so=function(e,t){return e[1]+t*(2*e[2]+3*t*e[3])},io={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(e){var t=Oe(e.x-this.long0),o=Math.abs(e.y),n=Math.floor(o*ao);0>n?n=0:18<=n&&(n=17),o=pe*(o-1/ao*n);var a={x:ro(eo[n],o)*t,y:ro(to[n],o)};return 0>e.y&&(a.y=-a.y),a.x=a.x*this.a*oo+this.x0,a.y=a.y*this.a*no+this.y0,a},inverse:function(e){var o={x:(e.x-this.x0)/(this.a*oo),y:Math.abs(e.y-this.y0)/(this.a*no)};if(1<=o.y)o.x/=eo[18][0],o.y=0>e.y?-ae:ae;else{var n=Math.floor(18*o.y);for(0>n?n=0:18<=n&&(n=17);;)if(to[n][0]>o.y)--n;else if(to[n+1][0]<=o.y)++n;else break;var a=to[n],r=5*(o.y-a[0])/(to[n+1][0]-a[0]);r=te(function(e){return(ro(a,e)-o.y)/so(a,e)},r,le,100),o.x/=ro(eo[n],r),o.y=(5*n+r)*de,0>e.y&&(o.y=-o.y)}return o.x=Oe(o.x+this.long0),o},names:["Robinson","robin"]},lo={init:function(){this.name="geocent"},forward:function(e){var t=x(e,this.es,this.a);return t},inverse:function(e){var t=v(e,this.es,this.a,this.b);return t},names:["Geocentric","geocentric","geocent","Geocent"]};return M.defaultDatum="WGS84",M.Proj=P,M.WGS84=new M.Proj("WGS84"),M.Point=Q,M.toPoint=He,M.defs=l,M.transform=T,M.mgrs={forward:D,inverse:function(e){var t=j(X(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]},toPoint:G},M.version="2.6.2",function(e){e.Proj.projections.add($e),e.Proj.projections.add(lt),e.Proj.projections.add(pt),e.Proj.projections.add(mt),e.Proj.projections.add(gt),e.Proj.projections.add(ft),e.Proj.projections.add(yt),e.Proj.projections.add(_t),e.Proj.projections.add(Et),e.Proj.projections.add(At),e.Proj.projections.add(Dt),e.Proj.projections.add(kt),e.Proj.projections.add(Ut),e.Proj.projections.add(jt),e.Proj.projections.add(Vt),e.Proj.projections.add(Bt),e.Proj.projections.add(Ft),e.Proj.projections.add(Ht),e.Proj.projections.add(zt),e.Proj.projections.add(Xt),e.Proj.projections.add(Yt),e.Proj.projections.add(Wt),e.Proj.projections.add(Kt),e.Proj.projections.add(Qt),e.Proj.projections.add($t),e.Proj.projections.add(io),e.Proj.projections.add(lo)}(M),M})},function(e,t,o){"use strict";o.r(t);var n=o(33),a=o.n(n);t["default"]={getLogger:function(e){"false".match(/true/)?n.disableAll():n.enableAll();return n.getLogger(e||"default")}}},function(e,t,o){var n,a;(function(r,s){"use strict";n=s,a="function"==typeof n?n.call(t,o,t,e):n,!(a!==void 0&&(e.exports=a))})(this,function(){"use strict";function e(e,t){var o=e[t];if("function"==typeof o.bind)return o.bind(e);try{return Function.prototype.bind.call(o,e)}catch(t){return function(){return Function.prototype.apply.apply(o,[e,arguments])}}}function t(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(o){return"debug"===o&&(o="log"),"undefined"!==typeof console&&("trace"===o&&p?t:void 0===console[o]?void 0===console.log?l:e(console,"log"):e(console,o))}function n(e,t){for(var o=0,n;o<c.length;o++)n=c[o],this[n]=o<e?l:this.methodFactory(n,e,t);this.log=this.debug}function a(e,t,o){return function(){"undefined"!==typeof console&&(n.call(this,t,o),this[e].apply(this,arguments))}}function r(e){return o(e)||a.apply(this,arguments)}function s(e,t,o){function a(e){var t=(c[e]||"silent").toUpperCase();if("undefined"!==typeof window&&l){try{return void(window.localStorage[l]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(l)+"="+t+";"}catch(e){}}}function s(){var e;if("undefined"!==typeof window&&l){try{e=window.localStorage[l]}catch(e){}if("undefined"===typeof e)try{var t=window.document.cookie,o=t.indexOf(encodeURIComponent(l)+"=");-1!==o&&(e=/^([^;]+)/.exec(t.slice(o))[1])}catch(e){}return void 0===i.levels[e]&&(e=void 0),e}}var i=this,l="loglevel",d;"string"==typeof e?l+=":"+e:"symbol"==typeof e&&(l=void 0),i.name=e,i.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},i.methodFactory=o||r,i.getLevel=function(){return d},i.setLevel=function(t,o){if("string"==typeof t&&void 0!==i.levels[t.toUpperCase()]&&(t=i.levels[t.toUpperCase()]),!("number"==typeof t&&0<=t&&t<=i.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;else if(d=t,!1!==o&&a(t),n.call(i,t,e),"undefined"===typeof console&&t<i.levels.SILENT)return"No console available for logging"},i.setDefaultLevel=function(e){s()||i.setLevel(e,!1)},i.enableAll=function(e){i.setLevel(i.levels.TRACE,e)},i.disableAll=function(e){i.setLevel(i.levels.SILENT,e)};var p=s();null==p&&(p=null==t?"WARN":t),i.setLevel(p,!1)}var l=function(){},d="undefined",p=typeof window!==d&&typeof window.navigator!==d&&/Trident\/|MSIE /.test(window.navigator.userAgent),c=["trace","debug","info","warn","error"],u=new s,m={};u.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=m[e];return t||(t=m[e]=new s(e,u.getLevel(),u.methodFactory)),t};var g=typeof window===d?void 0:window.log;return u.noConflict=function(){return typeof window!==d&&window.log===u&&(window.log=g),u},u.getLoggers=function(){return m},u["default"]=u,u})},function(e,t,o){"use strict";o.r(t),o.d(t,"servicesVersion",function(){return D}),o.d(t,"servicesDate",function(){return G});var n=o(35),a=o(49),r=o(61),s=o(62),i=o(110),l=o(111),d=o(66),p=o(67),c=o(68),u=o(69),m=o(70),g=o(71),f=o(72),y=o(73),_=o(74),E=o(75),h=o(76),b=o(78),S=o(79),P=o(77),R=o(100),x=o(102),v=o(101),C=o(107),A=o(132),L=o(124),I=o(125),w=o(43),T=o(39),N=o(41),O=o(50),M=o.t(50,1);const D=O.version,G=O.date;var k={};k.servicesVersion=D,k.servicesDate=G,k.Protocols={},k.Protocols.XHR=w["default"],k.Services=n["default"],k.Services.DefaultUrl=a["default"],k.Services.AltiResponse=r["default"],k.Services.Alti={},k.Services.Alti.Elevation=s["default"],k.Services.AutoCompleteResponse=i["default"],k.Services.AutoComplete={},k.Services.AutoComplete.SuggestedLocation=l["default"],k.Services.GetConfigResponse=d["default"],k.Services.Config={},k.Services.Config.Constraint=p["default"],k.Services.Config.Format=c["default"],k.Services.Config.Layer=u["default"],k.Services.Config.Legend=m["default"],k.Services.Config.Metadata=g["default"],k.Services.Config.Originator=f["default"],k.Services.Config.Service=y["default"],k.Services.Config.Style=_["default"],k.Services.Config.Territory=E["default"],k.Services.Config.Thematic=h["default"],k.Services.Config.TileMatrix=b["default"],k.Services.Config.TileMatrixLimit=S["default"],k.Services.Config.TileMatrixSet=P["default"],k.Services.GeocodeResponse=R["default"],k.Services.Geocode={},k.Services.Geocode.GeocodedLocation=x["default"],k.Services.Geocode.DirectGeocodedLocation=v["default"],k.Services.Geocode.ReverseGeocodedLocation=C["default"],k.Services.IsoCurveResponse=A["default"],k.Services.RouteResponse=L["default"],k.Services.Route={},k.Services.Route.RouteInstruction=I["default"],k.Error=T["default"],k.Helper=N["default"],t["default"]=k},function(e,t,o){"use strict";o.r(t);var n=o(36),a=o(63),r=o(80),s=o(103),i=o(108),l=o(112),d=o(127);t["default"]={getConfig:function(e){var t=new a["default"](e);t.call()},getAltitude:function(e){var t=new n["default"](e);t.call()},geocode:function(e){var t=new r["default"](e);t.call()},reverseGeocode:function(e){var t=new s["default"](e);t.call()},autoComplete:function(e){var t=new i["default"](e);t.call()},route:function(e){var t=new l["default"](e);t.call()},isoCurve:function(e){var t=new d["default"](e);t.call()}}},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError(r["default"].getMessage("CLASS_CONSTRUCTOR","Alti"));if(this.CLASSNAME="Alti",i["default"].apply(this,arguments),this.logger=a["default"].getLogger("Gp.Services.Alti"),this.logger.trace("[Constructeur Alti (options)]"),!e.positions)throw new Error(r["default"].getMessage("PARAM_MISSING","positions"));if(0===e.positions.length)throw new Error(r["default"].getMessage("PARAM_EMPTY","positions"));if(this.options.positions=e.positions,this.options.outputFormat="string"==typeof e.outputFormat?e.outputFormat.toLowerCase():"xml",this.options.sampling=e.sampling||null,this.options.api="string"==typeof e.api?e.api.toUpperCase():"REST","REST"===this.options.api&&(this.options.httpMethod="GET"),this.options.zonly=e.zonly||!1,!this.options.serverUrl){var t=l["default"].Alti.url(this.options.apiKey),o=null;switch(this.options.api){case"WPS":o=t.wps;break;case"REST":var s=(e.sampling?"profil":"elevation")+"-"+this.options.outputFormat;o=t[s];break;default:throw new Error(r["default"].getMessage("PARAM_UNKNOWN","api"));}if(!o)throw new Error("Url by default not found !");this.options.serverUrl=o,this.logger.trace("Server URL by default : "+this.options.serverUrl)}var d=this.options.serverUrl.lastIndexOf(".");if(-1!==d){var p=this.options.serverUrl.substring(d+1);if(p&&5>p.length)switch(this.logger.trace("Server Extension URL : "+p),p.toLowerCase()){case"json":case"xml":this.options.outputFormat=p.toLowerCase();break;default:throw new Error("type of service : unknown or unsupported (json or xml) !");}}}o.r(t);var a=o(37),r=o(38),s=o(39),i=o(40),l=o(49),d=o(51),p=o(58);n.prototype=Object.create(i["default"].prototype,{}),n.prototype.constructor=n,n.prototype.buildRequest=function(e,t){var o={httpMethod:this.options.httpMethod,onSuccess:function(e){this.request=e,t.call(this,this.request)},onError:e,scope:this,positions:this.options.positions,outputFormat:this.options.outputFormat,sampling:this.options.sampling,api:this.options.api,zonly:this.options.zonly};d["default"].build(o)},n.prototype.analyzeResponse=function(e,t){if(this.response){var o={response:this.response,outputFormat:this.options.outputFormat,rawResponse:this.options.rawResponse,onError:e,onSuccess:t,scope:this};p["default"].build(o)}else e.call(this,new s["default"](r["default"].getMessage("SERVICE_RESPONSE_EMPTY")))},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(33),a=o.n(n);t["default"]={getLogger:function(e){"false".match(/true/)?n.disableAll():n.enableAll();return n.getLogger(e||"default")}}},function(e,t,o){"use strict";o.r(t);t["default"]={PARAM_MISSING:"Parameter(s) '%var%' missing",PARAM_EMPTY:"Parameter(s) '%var%' empty",PARAM_TYPE:"Wrong type(s) for parameter(s) '%var%'",PARAM_FORMAT:"Parameter(s) '%var%' not correctly formatted",PARAM_NOT_SUPPORT:"Value(s) for parameter(s) '%var%' not supported",PARAM_NOT_SUPPORT_NODEJS:"Value(s) for parameter(s) '%var%' not supported to NodeJS",PARAM_UNKNOWN:"Value(s) for parameter(s) '%var%' unknown",SERVICE_REQUEST_BUILD:"An error occurred during the request building of the service",SERVICE_REQUEST_EMPTY:"The request sent to the service is empty",SERVICE_RESPONSE_EXCEPTION:"The service returned an exception : '%var%'",SERVICE_RESPONSE_EXCEPTION_2:"The service returned an exception",SERVICE_RESPONSE_ANALYSE:"An error occurred while parsing the response '%var%' of the service",SERVICE_RESPONSE_ANALYSE_2:"An unknown error occurred while parsing the response",SERVICE_RESPONSE_EMPTY:"The response of the service is empty",SERVICE_RESPONSE_EMPTY_2:"The response from the service could not be analyzed or is empty",SERVICE_RESPONSE_FORMAT:"The format of the service response is not supported (handled format(s) : '%var%')",SERVICE_RESPONSE_FORMAT_2:"The format of the service response is not supported",SERVICE_RESPONSE_FORMAT_3:"No suggestion matching the search",CLASS_CONSTRUCTOR:"'%var%' constructor cannot be called as a function.",getMessage:function(){if(0===Object.keys(arguments).length)return"Message indefined !";var e=Array.prototype.slice.call(arguments),t=e.shift(),o=e,n=this[t];try{n=Array.isArray(o)&&0<o.length?n.replace("%var%",o.join(" - ")):n.replace("%var%","%var% (not specified)")}catch(t){}return n}}},function(e,t,o){"use strict";function n(t){if(!(this instanceof n))throw new TypeError("ErrorService constructor cannot be called as a function.");var o=t;"string"==typeof t||t instanceof String?(this.message=t,this.status=-1,this.type=n.TYPE_UNKERR):(this.message=o.message||"undefined!?",this.type=o.type,this.status=o.status||-1),this.name="ErrorService",this.stack=new Error().stack}o.r(t),n.TYPE_SRVERR="SERVICE_ERROR",n.TYPE_USEERR="USAGE_ERROR",n.TYPE_UNKERR="UNKNOWN_ERROR",n.prototype=Object.create(Error.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError(s["default"].getMessage("CLASS_CONSTRUCTOR"));for(var t in this.logger=a["default"].getLogger("CommonService"),this.logger.trace("[Constructeur CommonService (options)]"),this.options={protocol:"XHR",ssl:!0,proxyURL:"",callbackSuffix:null,httpMethod:"GET",timeOut:0,rawResponse:!1,scope:this,onSuccess:function(e){console.log("onSuccess - la reponse est la suivante : ",e)},onFailure:function(e){200!==e.status&&e.status?console.log("onFailure - Erreur (",e.status,") : ",e.message):console.log("onFailure : ",e.message)}},e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);if(!this.options.apiKey&&!this.options.serverUrl)throw new Error(s["default"].getMessage("PARAM_MISSING","apiKey","serverUrl"));this.options.rawResponse&&!this.options.onSuccess&&(this.options.onSuccess=function(e){console.log("onSuccess - la r\xE9ponse brute du service est la suivante : ",e)});var o=null!==this.options.onSuccess&&"function"==typeof this.options.onSuccess;if(!o)throw new Error(s["default"].getMessage("PARAM_MISSING","onSuccess()"));if(!this.options.serverUrl){d["default"].ssl=this.options.ssl;var r=d["default"][this.CLASSNAME].url(this.options.apiKey);"string"==typeof r?this.options.serverUrl=r:this.logger.trace("URL par defaut \xE0 determiner au niveau du composant...")}switch(this.options.httpMethod="string"==typeof e.httpMethod?e.httpMethod.toUpperCase():"GET",this.options.httpMethod){case"POST":case"GET":break;case"PUT":case"DELETE":case"HEAD":case"OPTIONS":throw new Error(s["default"].getMessage("PARAM_NOT_SUPPORT","httpMethod"));default:throw new Error(s["default"].getMessage("PARAM_UNKNOWN","httpMethod"));}switch(this.options.protocol="string"==typeof e.protocol?e.protocol.toUpperCase():"XHR",this.options.protocol){case"JSONP":case"XHR":break;default:throw new Error(s["default"].getMessage("PARAM_UNKNOWN","protocol"));}if("undefined"==typeof window&&"JSONP"===this.options.protocol)throw new Error(s["default"].getMessage("PARAM_NOT_SUPPORT_NODEJS","protocol=JSONP (instead use XHR)"));"JSONP"===this.options.protocol&&(this.options.httpMethod="GET"),this.options.nocache=e.nocache||!1,this.options.outputFormat=null,this.request=null,this.response=null}o.r(t);var a=o(37),r=o(41),s=o(38),i=o(42),l=o(39),d=o(49),p=o(50),c=o.t(50,1);n.prototype={constructor:n,call:function(){function e(e){this.logger.trace("CommonService::onBuildRequest : ",e),this.callService.call(a,n,t)}function t(e){this.logger.trace("CommonService::onCallService : ",e),this.analyzeResponse.call(a,n,o)}function o(e){return this.logger.trace("CommonService::onAnalyzeResponse : ",e),e?void this.options.onSuccess.call(this,e):n.call(this,new l["default"]("Analyse de la reponse en \xE9chec !?"))}function n(t){this.logger.trace("CommonService::onError()");var o=t;o instanceof l["default"]||(o=new l["default"](t.message)),this.options.onFailure.call(this,o)}this.logger.trace("CommonService::call ()");var a=this;(function(){this.logger.trace("CommonService::run ()"),this.buildRequest.call(a,n,e)}).call(a)},buildRequest:function(e,t){this.logger.error("overwritten method !"),e&&e.call(this,"This method must be overwritten !"),t.call(this,"This method must be overwritten !")},callService:function(t,o){var n=null,a=this.request,s=!!(this.options.proxyURL&&"XHR"===this.options.protocol);this.options.serverUrl=r["default"].normalyzeUrl(this.options.serverUrl,{"gp-access-lib":p.version},!1),s&&("GET"===this.options.httpMethod&&(n=this.options.proxyURL+r["default"].normalyzeUrl(this.options.serverUrl,this.request,!0),a=null),"POST"===this.options.httpMethod&&(n=this.options.proxyURL+r["default"].normalyzeUrl(this.options.serverUrl,null,!0),a=this.request));var d=this,c={url:n||this.options.serverUrl,method:this.options.httpMethod,protocol:this.options.protocol,timeOut:this.options.timeOut||0,format:this.options.outputFormat,nocache:this.options.nocache||!1,wrap:"XHR"!==this.options.protocol,callbackSuffix:this.options.callbackSuffix,data:a,headers:null,content:this.options.contentType||"application/xml",scope:this.options.scope||this,onResponse:function(e){d.logger.trace("callService::onResponse()");var n=null;if("XHR"===d.options.protocol&&(d.logger.trace("Response XHR",e),n=e),"JSONP"===d.options.protocol){if(d.logger.trace("Response JSON",e),!e)return void t.call(d,new l["default"]("Le contenu de la reponse est vide !?"));if(e.http){if(200!==e.http.status)return void t.call(d,new l["default"]({status:e.http.status,message:e.http.error,type:l["default"].TYPE_SRVERR}));n=e.xml,d.options.rawResponse&&(n=e)}else n=e}if("function"==typeof d.options.onBeforeParse){var a=d.options.onBeforeParse(n);"string"==typeof a&&(n=a)}d.response=n,o.call(d,n)},onFailure:function(o){d.logger.trace("callService::onFailure()"),o.type=l["default"].TYPE_SRVERR,t.call(d,new l["default"](o))},onTimeOut:function(){d.logger.trace("callService::onTimeOut()"),t.call(d,new l["default"]("TimeOut!"))}};i["default"].send(c)},analyzeResponse:function(e,t){this.logger.error("overwritten method !"),e&&e.call(this,"This method must be overwritten !"),t.call(this,"This method must be overwritten !")}},t["default"]=n},function(e,t,o){"use strict";o.r(t);t["default"]={normalyzeParameters:function(e){var t=null;if(e){var o=[];for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];a||(a=""),o.push(n+"="+a)}t=o.join("&")}return t},normalyzeUrl:function(e,t,o){var n=e;if(e){var a=e.indexOf("?");-1===a&&(n+="?"),-1!==a&&a!==e.length-1&&(n+="&")}return t&&("string"==typeof t?n+=t:n+=this.normalyzeParameters(t)),o&&(n=encodeURIComponent(n)),n},indent:function(e,t){return Array((e||0)+1).join("\t")+t}}},function(e,t,o){"use strict";o.r(t);var n=o(41),a=o(43),r=o(48);t["default"]={send:function(e){var t=e||{method:"GET",protocol:"XHR",timeOut:0,format:null,wrap:!0,nocache:!0,output:"json",callback:null,callbackSuffix:null};if("undefined"==typeof window&&"JSONP"===e.protocol)return void console.log("Value (s) for parameter (s) 'protocol=JSONP (instead use XHR)' not supported to NodeJS");if("XHR"===e.protocol||"json"===e.format?t.wrap=!1:"JSONP"===e.protocol&&"xml"===e.format&&(t.wrap=!0),t.callback="JSONP"===e.protocol?null:null,t.output=t.wrap?"json":null,t.wrap){var o={};o.output=t.output,o.callback=t.callback,delete o.callback,t.url=n["default"].normalyzeUrl(e.url,o)}switch(t.protocol){case"XHR":"GET"===e.method&&e.nocache&&(t.url=n["default"].normalyzeUrl(t.url,{t:new Date().getTime()})),a["default"].call(t);break;case"JSONP":t.data&&(t.url=n["default"].normalyzeUrl(t.url,t.data)),r["default"].call(t);break;default:throw new Error("protocol not supported (XHR|JSONP) !");}}}},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(41),r=o(44),s=o.n(r);t["default"]={call:function(e){var t=n["default"].getLogger("XHR");if(t.trace("[XHR::call()]"),s.a.polyfill(),!e.url)throw new Error("missing parameter : url is not defined !");if(!e.method)throw new Error("missing parameter : method is not defined !");e.format||(e.format="text");var o={url:e.url,data:e.data?e.data:null,method:e.method,timeOut:e.timeOut||0,scope:e.scope||this,proxy:e.proxy||null,content:e.content||null,headers:e.headers||{referer:"http://localhost"}};switch(e.method){case"DELETE":case"GET":break;case"PUT":case"POST":o.content=e.content?e.content:"application/x-www-form-urlencoded",o.headers=e.headers?e.headers:{referer:"http://localhost"};break;case"HEAD":case"OPTIONS":throw new Error("HTTP method not yet supported !");default:throw new Error("HTTP method unknown !");}switch(e.format){case"text":this.__call(o).then(function(o){t.trace(o),e.onResponse.call(this,o)}).catch(function(t){e.onFailure.call(this,t)});break;case"json":this.__callJSON(o).then(function(o){t.trace(o),e.onResponse.call(this,o)}).catch(function(t){e.onFailure.call(this,t)});break;case"xml":this.__callXML(o).then(function(o){t.trace(o),e.onResponse.call(this,o)}).catch(function(t){e.onFailure.call(this,t)});break;default:throw new Error("This output Format is not yet supported !");}},__call:function(e){var t=n["default"].getLogger("XHR");t.trace("[XHR::__call()]");var r=new Promise(function(n,r){var s="POST"===e.method||"PUT"===e.method?1:0;e.data&&("object"==typeof e.data&&Object.keys(e.data).length||"string"==typeof e.data&&e.data.length)&&!s&&(e.url=a["default"].normalyzeUrl(e.url,e.data)),t.trace("URL = ",e.url);var i=null;if("undefined"==typeof window){var l=o(46);e.data&&"string"==typeof e.data&&s&&(e.body=e.data),e.rejectUnauthorized=!1,l(e,function(e,t,o){!e&&200===t.statusCode&&o?n(o):r("Errors Occured on Http Request (nodejs) : "+e)})}else if(window.XMLHttpRequest){t.trace("XMLHttpRequest"),i=new XMLHttpRequest,i.open(e.method,e.url,!0),i.overrideMimeType=e.content;var d=null;0<e.timeOut&&(t.trace("XHR - TimeOut actif !"),d=window.setTimeout(function(){r({message:"TimeOut Occured on Http Request with XMLHttpRequest !",status:-1})},e.timeOut)),s&&(t.trace("data = ",e.data),i.setRequestHeader("Content-type",e.content)),i.onerror=function(t){console.log(t),r(new Error("Errors Occured on Http Request with XMLHttpRequest !"))},i.ontimeout=function(t){console.log(t),r(new Error("TimeOut Occured on Http Request with XMLHttpRequest !"))},i.onreadystatechange=function(t){if(4===i.readyState)if(200===i.status)window.clearTimeout(d),n(i.response);else{var e="Errors Occured on Http Request (status : '"+t.target.statusText+"' | url : '"+t.target.responseURL+"')",o=t.target.status;r({message:e,status:o})}};var p=e.data&&s?e.data:null;i.send(p)}else if(window.XDomainRequest){t.trace("XDomainRequest"),i=new XDomainRequest,i.open(e.method,e.url),i.overrideMimeType=e.content,0<e.timeOut&&(i.timeout=e.timeout,t.trace("XHR - TimeOut actif !")),s&&i.setRequestHeader("Content-type",e.content),i.onerror=function(){r(new Error("Errors Occured on Http Request with XMLHttpRequest !"))},i.ontimeout=function(){r(new Error("TimeOut Occured on Http Request with XMLHttpRequest !"))},i.onload=function(t){if(200===i.status)n(i.responseText);else{var e="Errors Occured on Http Request (status : '"+t.target.statusText+"' | url : '"+t.target.responseURL+"')",o=t.target.status;r({message:e,status:o})}};var c=e.data&&s?e.data:null;i.send(c)}else throw new Error("CORS not supported")});return r},__callJSON:function(e){return this.__call(e).then(JSON.parse).catch(function(t){console.log("_callJSON failed on : ",e.url,t)})},__callXML:function(e){return this.__call(e).then(function(e){var t;if("undefined"==typeof window){var n=o(47).DOMParser;t=new n().parseFromString(e,"text/xml")}else if(window.DOMParser){var a=new window.DOMParser;t=a.parseFromString(e,"text/xml")}else t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e);return t}).catch(function(t){console.log("__callXML failed on : ",e.url,t)})}}},function(e,t,o){(function(t,o){(function(t,o){e.exports=o()})(this,function(){'use strict';function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function n(e){return"function"==typeof e}function a(){return"undefined"==typeof O?r():function(){O(s)}}function r(){var e=setTimeout;return function(){return e(s,1)}}function s(){for(var e=0;e<N;e+=2){var t=V[e],o=V[e+1];t(o),V[e]=void 0,V[e+1]=void 0}N=0}function l(e,t){var o=this,n=new this.constructor(p);void 0===n[F]&&C(n);var a=o._state;if(a){var r=arguments[a-1];D(function(){return R(a,n,r,o._result)})}else S(o,n,e,t);return n}function d(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var o=new t(p);return _(o,e),o}function p(){}function c(){return new TypeError("You cannot resolve a promise with itself")}function u(){return new TypeError("A promises callback cannot return that same promise.")}function m(e,t,o,n){try{e.call(t,o,n)}catch(t){return t}}function g(e,t,o){D(function(e){var n=!1,a=m(o,t,function(o){n||(n=!0,t===o?h(e,o):_(e,o))},function(t){n||(n=!0,b(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&a&&(n=!0,b(e,a))},e)}function f(e,t){1===t._state?h(e,t._result):2===t._state?b(e,t._result):S(t,void 0,function(t){return _(e,t)},function(t){return b(e,t)})}function y(e,t,o){t.constructor===e.constructor&&o===l&&t.constructor.resolve===d?f(e,t):void 0===o?h(e,t):n(o)?g(e,t,o):h(e,t)}function _(t,o){if(t===o)b(t,c());else if(e(o)){var n;try{n=o.then}catch(e){return void b(t,e)}y(t,o,n)}else h(t,o)}function E(e){e._onerror&&e._onerror(e._result),P(e)}function h(e,t){void 0!==e._state||(e._result=t,e._state=1,0!==e._subscribers.length&&D(P,e))}function b(e,t){void 0!==e._state||(e._state=2,e._result=t,D(E,e))}function S(e,t,o,n){var a=e._subscribers,r=a.length;e._onerror=null,a[r]=t,a[r+1]=o,a[r+2]=n,0===r&&e._state&&D(P,e)}function P(e){var t=e._subscribers,o=e._state;if(0!==t.length){for(var n=void 0,a=void 0,r=e._result,s=0;s<t.length;s+=3)n=t[s],a=t[s+o],n?R(o,n,a,r):a(r);e._subscribers.length=0}}function R(e,t,o,a){var r=n(o),s=!0,i,l;if(r){try{i=o(a)}catch(t){s=!1,l=t}if(t===i)return void b(t,u())}else i=a;void 0!==t._state||(r&&s?_(t,i):!1===s?b(t,l):1===e?h(t,i):2===e&&b(t,i))}function x(t,o){try{o(function(e){_(t,e)},function(e){b(t,e)})}catch(o){b(t,o)}}function v(){return X++}function C(e){e[F]=X++,e._state=void 0,e._result=void 0,e._subscribers=[]}function A(){return new Error("Array Methods must be provided an Array")}function L(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function I(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var w=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var T=w,N=0,O=void 0,M=void 0,D=function(e,t){V[N]=e,V[N+1]=t,N+=2,2===N&&(M?M(s):B())},G="undefined"==typeof window?void 0:window,k=G||{},U=k.MutationObserver||k.WebKitMutationObserver,q="undefined"==typeof self&&"undefined"!=typeof t&&"[object process]"==={}.toString.call(t),j="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,V=Array(1e3),B=void 0;B=q?function(){return function(){return t.nextTick(s)}}():U?function(){var e=0,t=new U(s),o=document.createTextNode("");return t.observe(o,{characterData:!0}),function(){o.data=e=++e%2}}():j?function(){var e=new MessageChannel;return e.port1.onmessage=s,function(){return e.port2.postMessage(0)}}():void 0!==G||0?r():function(){try{var e=Function("return this")().require("vertx");return O=e.runOnLoop||e.runOnContext,a()}catch(t){return r()}}();var F=Math.random().toString(36).substring(2),H=void 0,z=2,X=0,i=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(p),this.promise[F]||C(this.promise),T(t)?(this.length=t.length,this._remaining=t.length,this._result=Array(this.length),0===this.length?h(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&h(this.promise,this._result))):b(this.promise,A())}return e.prototype._enumerate=function(e){for(var t=0;this._state===H&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var o=this._instanceConstructor,n=o.resolve;if(n===d){var a=void 0,r=void 0,s=!1;try{a=e.then}catch(t){s=!0,r=t}if(a===l&&e._state!==H)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(o===Y){var i=new o(p);s?b(i,r):y(i,e,a),this._willSettleAt(i,t)}else this._willSettleAt(new o(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,o){var n=this.promise;n._state===H&&(this._remaining--,e===z?b(n,o):this._result[t]=o),0===this._remaining&&h(n,this._result)},e.prototype._willSettleAt=function(e,t){var o=this;S(e,void 0,function(e){return o._settledAt(1,t,e)},function(e){return o._settledAt(z,t,e)})},e}(),Y=function(){function e(t){this[F]=v(),this._result=this._state=void 0,this._subscribers=[],p!==t&&("function"!=typeof t&&L(),this instanceof e?x(this,t):I())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this,o=t.constructor;return n(e)?t.then(function(t){return o.resolve(e()).then(function(){return t})},function(t){return o.resolve(e()).then(function(){throw t})}):t.then(e,e)},e}();return Y.prototype.then=l,Y.all=function(e){return new i(this,e).promise},Y.race=function(e){var t=this;return T(e)?new t(function(o,n){for(var a=e.length,r=0;r<a;r++)t.resolve(e[r]).then(o,n)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},Y.resolve=d,Y.reject=function(e){var t=this,o=new t(p);return b(o,e),o},Y._setScheduler=function(e){M=e},Y._setAsap=function(e){D=e},Y._asap=D,Y.polyfill=function(){var e;if("undefined"!=typeof o)e=o;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(t){}if("[object Promise]"===n&&!t.cast)return}e.Promise=Y},Y.Promise=Y,Y})}).call(this,o(45),o(30))},function(e){function t(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function n(o){if(c===setTimeout)return setTimeout(o,0);if((c===t||!c)&&setTimeout)return c=setTimeout,setTimeout(o,0);try{return c(o,0)}catch(t){try{return c.call(null,o,0)}catch(t){return c.call(this,o,0)}}}function a(t){if(u===clearTimeout)return clearTimeout(t);if((u===o||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(o){try{return u.call(null,t)}catch(o){return u.call(this,t)}}}function r(){g&&y&&(g=!1,y.length?m=y.concat(m):f=-1,m.length&&s())}function s(){if(!g){var e=n(r);g=!0;for(var t=m.length;t;){for(y=m,m=[];++f<t;)y&&y[f].run();f=-1,t=m.length}y=null,g=!1,a(e)}}function l(e,t){this.fun=e,this.array=t}function d(){}var p=e.exports={},c,u;(function(){try{c="function"==typeof setTimeout?setTimeout:t}catch(o){c=t}try{u="function"==typeof clearTimeout?clearTimeout:o}catch(t){u=o}})();var m=[],g=!1,f=-1,y;p.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];m.push(new l(e,t)),1!==m.length||g||n(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=d,p.addListener=d,p.once=d,p.off=d,p.removeListener=d,p.removeAllListeners=d,p.emit=d,p.prependListener=d,p.prependOnceListener=d,p.listeners=function(){return[]},p.binding=function(){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t){t.exports=e},function(e){e.exports=t},function(e,t,o){"use strict";o.r(t);var n=o(37),a={uuid:function(){var e=Math.floor(Date.now());return function(){return e++}}(),call:function(e){var t=n["default"].getLogger("JSONP");if(t.trace("[JSONP::call ()]"),!e)throw t.error("missing parameter : options !"),new Error("missing parameter : options !");if(!e.url)throw t.error("missing parameter : options.url !"),new Error("missing parameter : options.url !");if(e.timeOut||(t.info("setting 'options.timeOut' default value"),e.timeOut=0),!e.onResponse)throw t.error("missing parameter : options.onResponse !"),new Error("missing parameter : options.onResponse !");var o="string"==typeof e.callbackSuffix?e.callbackSuffix:this.uuid(),a=!1,r=!1,s=e.url.indexOf("callback=");if(-1!==s){a=!0;var i=e.url.indexOf("&",s);-1===i&&(i=e.url.length);var l=e.url.substring(s+9,i);l&&(r=!0,e.callbackName=l,t.info("setting 'options.callbackName' value ("+e.callbackName+") from 'options.url' parameter"))}if(!a){var d=e.url.indexOf("?");e.url+=-1===d?"?callback=":d===e.url.length?"callback=":"&callback=",t.info("setting callback default key in 'options.url' : "+e.url)}var p=!!e.callbackName||r;if(r||(!e.callbackName&&(t.info("setting 'options.callbackName' default value"),e.callbackName="callback",(o||""===o)&&(e.callbackName+=o)),e.url=e.url.replace("callback=","callback="+e.callbackName),t.info("setting callback function name in 'options.url' : "+e.url)),e.onTimeOut||(t.info("setting 'options.onTimeOut' default value"),e.onTimeOut=function(){console.log("TimeOut while invoking url : "+e.url)}),!p){var c=this,u=null;0<e.timeOut&&(u=window.setTimeout(function(){window[e.callbackName]=function(){},e.onTimeOut(),c._deleteScript(o)},e.timeOut)),window[e.callbackName]=function(t){window.clearTimeout(u),e.onResponse(t),c._deleteScript(o)}}this._createScript(o,e.url)},_createScript:function(e,t){var o=document.getElementById("results"+e),n;n=document.createElement("script"),n.setAttribute("type","text/javascript"),n.setAttribute("src",t),n.setAttribute("charset","UTF-8"),n.setAttribute("id","results"+e),n.setAttribute("async","true");var a=document.documentElement||document.getElementsByTagName("head")[0];null===o?a.appendChild(n):a.replaceChild(n,o)},_deleteScript:function(e){var t=document.getElementById("results"+e);if(t){var o=t.parentNode||document.documentElement;if(!o)return;o.removeChild(t)}}};t["default"]=a},function(e,t,o){"use strict";o.r(t);var n={ssl:!0,url:function(e,t){var o;return o=!1===n.ssl?"http://":"https://",o+"wxs.ign.fr".concat("/",e,t)},Alti:{_key:{"elevation-json":"/alti/rest/elevation.json","elevation-xml":"/alti/rest/elevation.xml","profil-json":"/alti/rest/elevationLine.json","profil-xml":"/alti/rest/elevationLine.xml",wps:"/alti/wps"},url:function(e){return{"elevation-json":n.url(e,this._key["elevation-json"]),"elevation-xml":n.url(e,this._key["elevation-xml"]),"profil-json":n.url(e,this._key["profil-json"]),"profil-xml":n.url(e,this._key["profil-xml"]),wps:n.url(e,this._key.wps)}}},ProcessIsoCurve:{_key:{"iso-json":"/isochrone/isochrone.json","iso-xml":"/isochrone/isochrone.xml"},url:function(e){return{"iso-json":n.url(e,this._key["iso-json"]),"iso-xml":n.url(e,this._key["iso-xml"])}}},AutoComplete:{_key:"/ols/apis/completion",url:function(e){return n.url(e,this._key)}},ReverseGeocode:{_key:"/geoportail/ols",url:function(e){return n.url(e,this._key)}},AutoConf:{_key:{apiKey:"/autoconf",apiKeys:"/autoconf?keys=%KEYS%",aggregate:"/autoconf/id/"},url:function(e){var t="";if(Array.isArray(e)&&0<e.length){t=e[0];for(var o=1;o<e.length;o++)t+=","+e[o]}return{apiKey:n.url(e,this._key.apiKey),apiKeys:n.url(e[0],this._key.apiKeys).replace("%KEYS%",t),aggregate:n.url(e,this._key.aggregate)}}},Geocode:{_key:"/geoportail/ols",url:function(e){return n.url(e,this._key)}},Route:{_key:{ols:"/itineraire/ols","route-json":"/itineraire/rest/route.json","route-xml":"/itineraire/rest/route.xml"},url:function(e){return{ols:n.url(e,this._key.ols),"route-json":n.url(e,this._key["route-json"]),"route-xml":n.url(e,this._key["route-xml"])}}}};t["default"]=n},function(e){e.exports=JSON.parse("{\"_from\":\"geoportal-access-lib@2.1.6\",\"_id\":\"geoportal-access-lib@2.1.6\",\"_inBundle\":false,\"_integrity\":\"sha512-zQpSjZq8YkGW+ooB1WloQd2KZHCKyg4/pbIFLSPCk3et2Zan/O2hZlKOf2alEX2zbsg7Wd+e8KiLc7cHZKniag==\",\"_location\":\"/geoportal-access-lib\",\"_phantomChildren\":{},\"_requested\":{\"type\":\"version\",\"registry\":true,\"raw\":\"geoportal-access-lib@2.1.6\",\"name\":\"geoportal-access-lib\",\"escapedName\":\"geoportal-access-lib\",\"rawSpec\":\"2.1.6\",\"saveSpec\":null,\"fetchSpec\":\"2.1.6\"},\"_requiredBy\":[\"/\"],\"_resolved\":\"https://registry.npmjs.org/geoportal-access-lib/-/geoportal-access-lib-2.1.6.tgz\",\"_shasum\":\"8bb0d4cc7045c39c3392fe076ba699aace2b6066\",\"_spec\":\"geoportal-access-lib@2.1.6\",\"_where\":\"/var/www/APIv3/geoportal-extensions\",\"author\":{\"name\":\"IGNF\"},\"bugs\":{\"url\":\"https://github.com/IGNF/geoportal-access-lib/issues\"},\"bundleDependencies\":false,\"date\":\"03/10/2019\",\"dependencies\":{\"es6-promise\":\"^4.2.4\",\"request\":\"^2.87.0\",\"xmldom\":\"^0.1.27\"},\"deprecated\":false,\"description\":\"French Geoportal resources access library\",\"devDependencies\":{\"babel-core\":\"^6.26.3\",\"babel-loader\":\"^7.1.2\",\"babel-preset-env\":\"^1.7.0\",\"chai\":\"^4.1.2\",\"clean-webpack-plugin\":\"^0.1.18\",\"copy-webpack-plugin\":\"^4.5.1\",\"eslint\":\"^4.18.2\",\"eslint-config-standard\":\"^11.0.0\",\"eslint-loader\":\"^2.0.0\",\"eslint-plugin-import\":\"^2.9.0\",\"eslint-plugin-node\":\"^6.0.1\",\"eslint-plugin-promise\":\"^3.7.0\",\"eslint-plugin-standard\":\"^3.0.1\",\"glob\":\"^7.1.2\",\"handlebars-layouts\":\"^3.1.4\",\"handlebars-webpack-plugin\":\"^1.4.1\",\"html-webpack-plugin\":\"^2.30.1\",\"istanbul-instrumenter-loader\":\"^3.0.1\",\"jsdoc-webpack-plugin\":\"0.0.1\",\"loglevel\":\"^1.6.1\",\"mocha\":\"^4.0.0\",\"mocha-loader\":\"^1.1.3\",\"mocha-webpack\":\"^1.0.1\",\"nyc\":\"^12.0.2\",\"path\":\"^0.12.7\",\"replace-bundle-webpack-plugin\":\"^1.0.0\",\"sinon\":\"^4.3.0\",\"sinon-es6\":\"0.0.3\",\"speed-measure-webpack-plugin\":\"^1.2.2\",\"string-template\":\"^1.0.0\",\"webpack\":\"^3.11.0\",\"webpack-dev-server\":\"^2.11.3\",\"webpack-node-externals\":\"^1.6.0\",\"webpack-shell-plugin\":\"^0.5.0\"},\"homepage\":\"https://github.com/IGNF/geoportal-access-lib#readme\",\"keywords\":[\"geoportail\",\"webservice\",\"javascript\",\"es6\"],\"license\":\"CECILL-B\",\"main\":\"dist/GpServices-src.js\",\"module\":\"src/Gp.js\",\"name\":\"geoportal-access-lib\",\"nyc\":{\"include\":[\"src/**/*.js\"],\"instrument\":false,\"sourceMap\":false},\"optionalDependencies\":{},\"peerDependencies\":{},\"repository\":{\"type\":\"git\",\"url\":\"git+https://github.com/IGNF/geoportal-access-lib.git\"},\"scripts\":{\"build\":\"webpack\",\"build:dev\":\"webpack --env.development\",\"build:prod\":\"webpack --env.production\",\"clean\":\"echo \\\"Warning: no yet implemented!\\\" && exit 0\",\"cover\":\"nyc --reporter=lcov --reporter=text npm run test\",\"doc\":\"npm run doc:serve\",\"doc:serve\":\"webpack-dev-server --content-base jsdoc --port 9001 --open\",\"sample\":\"npm run sample:serve\",\"sample:serve\":\"webpack-dev-server --open-page samples/index-src.html --https --content-base .  --output-public-path '/dist/' --port 9001 --open 'google-chrome'\",\"sample:serve:dev\":\"webpack-dev-server --env.development --open-page samples/index-map.html --content-base . --output-public-path '/dist/' --port 9001 --open 'google-chrome\",\"sample:serve:prod\":\"webpack-dev-server --env.production --open-page samples/index.html --content-base . --output-public-path '/dist/' --port 9001 --open 'google-chrome\",\"setup\":\"npm install\",\"test\":\"mocha-webpack --webpack-config webpack.test.js --glob \\\"test_*.js\\\" test/spec/\",\"test:end-to-end:serve\":\"webpack-dev-server --hot --config webpack.end-to-end.serve.js\",\"test:serve\":\"webpack-dev-server --hot --config webpack.test.serve.js\"},\"version\":\"2.1.6\"}")},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(39),r=o(52),s=o(56);t["default"]={build:function(e){var t=n["default"].getLogger("AltiRequestFactory");t.trace(["AltiRequestFactory::build()"]);var o=null,i={type:e.sampling?"Profil":"Elevation",method:e.httpMethod,param:{positions:null,delimiter:null,indent:null,crs:null,format:null,sampling:null,zonly:null}};i.param.positions=e.positions,i.param.format=e.outputFormat,i.param.sampling=e.sampling,i.param.zonly=e.zonly;var l=null!==e.onError&&"function"==typeof e.onError,d=null!==e.onSuccess&&"function"==typeof e.onSuccess,p=null;switch(e.api){case"REST":var c=new r["default"](i);if(!c.processRequestString()){if(p="Error in process request (rest) !",l)return void e.onError.call(e.scope,new a["default"](p));throw new Error(p)}o=c.requestString;break;case"WPS":if(i.wps={service:null,version:null,identifier:null,rawdataoutput:null,request:null},o=s["default"].build(i),!o){if(p="Error in process request (wps) !",l)return void e.onError.call(e.scope,new a["default"](p));throw new Error(p)}break;default:if(p="Type of API is not supported by service (REST or WPS) !",l)return void e.onError.call(e.scope,new a["default"](p));throw new Error(p);}return d&&e.onSuccess.call(e.scope,o),o}}},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger("AltiRequestREST"),this.logger.trace("[Constructeur AltiRequestREST ()]"),!(this instanceof n))throw new TypeError("AltiRequestREST constructor cannot be called as a function.");if(this.options=e||{},!this.options)throw new Error(r["default"].getMessage("PARAM_EMPTY","options"));if(!this.options.type)throw new Error(r["default"].getMessage("PARAM_EMPTY","type (Elevation or Profil)"));switch(this.DataObject=null,this.options.type){case"Elevation":this.DataObject=new s["default"](this.options.param);break;case"Profil":this.DataObject=new i["default"](this.options.param);break;default:throw new Error(r["default"].getMessage("PARAM_TYPE","type (Elevation or Profil)"));}this.method=this.options.method||"GET"}o.r(t);var a=o(37),r=o(38),s=o(53),i=o(55);n.prototype={requestString:null,constructor:n,template:{get:{value:"lon=__LON__&lat=__LAT__&indent=__INDENT__&crs='__CRS__'",input:{point:"&zonly=__ZONLY__",profil:"&sampling=__SAMPLING__"}},post:{value:"lon=__LON__\nlat=__LAT__\nindent=__INDENT__\ncrs='__CRS__'\n",input:{point:"zonly=__ZONLY__",profil:"sampling=__SAMPLING__"}}},processRequestString:function(){this.logger.trace("AltiRequestREST::processRequestString ()");var e="";return"POST"===this.method?e=this.template.post.value:"GET"===this.method&&(e=this.template.get.value),e=e.replace(/__LON__/g,this.DataObject.getLon()),e=e.replace(/__LAT__/g,this.DataObject.getLat()),e=e.replace(/__INDENT__/g,this.DataObject.indent),e=e.replace(/__CRS__/g,this.DataObject.crs),e+=this.__addDataInputs(),this.logger.trace("traduction tmpl",e),this.requestString=e,this.requestString},__addDataInputs:function(){this.logger.trace("AltiRequestREST::addDataInput ()");var e;if("POST"===this.method)e=this.template.post;else if("GET"===this.method)e=this.template.get;else throw new Error("No other HTTP method supported by the service !");var t=null;if("AltiElevationRequest"===this.DataObject.CLASSNAME)return t=e.input.point,t.replace(/__ZONLY__/g,this.DataObject.zonly);if("AltiProfilRequest"===this.DataObject.CLASSNAME)return t=e.input.profil,t.replace(/__SAMPLING__/g,this.DataObject.sampling);throw new Error("No other object supported than elevation or profil !?")}},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("AltiElevationRequest constructor cannot be called as a function.");this.CLASSNAME="AltiElevationRequest",r["default"].apply(this,arguments),this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur AltiElevationRequest ()]"),this.zonly=this.options.zonly||!1}o.r(t);var a=o(37),r=o(54);n.prototype=Object.create(r["default"].prototype,{zonly:{get:function(){return this._zonly},set:function(e){this._zonly=e}}}),n.prototype.constructor=n,n.prototype.getData=function(){var e=[{k:"lon",v:this.getLon()},{k:"lat",v:this.getLat()},{k:"indent",v:this.indent},{k:"crs",v:this.crs},{k:"zonly",v:this.zonly},{k:"format",v:this.format}];return e},t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError("AltiRequest constructor cannot be called as a function.");this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur AltiRequest ()]"),this.options=e||{},this.positions=this.options.positions||[],this.delimiter=this.options.delimiter||"|",this.indent=this.options.indent||!1,this.crs=this.options.crs||"CRS:84",this.format=this.options.format||"json"}o.r(t);var a=o(37);n.CLASSNAME="AltiRequest",n.prototype={constructor:n,setPositions:function(e){for(var t=[],n=0,a;n<e.length;n++)a=e[n],a.lon&&a.lat&&t.push(a);this.positions=t},getPositions:function(e){if(!e)return this.positions;var t=this.positions.length-1;return e>t||e<t?(this.logger.warn("index out of range !"),this.positions):this.positions[e]},addPositions:function(e){for(var t=0,n;t<e.length;t++)n=e[t],n.lon&&n.lat&&this.positions.push(e[t])},getLon:function(){for(var e=[],t=0;t<this.positions.length;t++)e.push(this.positions[t].lon);return this.logger.trace(e),e.join(this.delimiter)},getLat:function(){for(var e=[],t=0;t<this.positions.length;t++)e.push(this.positions[t].lat);return this.logger.trace(e),e.join(this.delimiter)}},n.prototype.getData=function(){var e=[{k:"lon",v:this.getLon()},{k:"lat",v:this.getLat()},{k:"delimiter",v:this.delimiter},{k:"indent",v:this.indent},{k:"crs",v:this.crs},{k:"format",v:this.format}];return e},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("AltiProfilRequest constructor cannot be called as a function.");this.CLASSNAME="AltiProfilRequest",r["default"].apply(this,arguments),this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur AltiProfilRequest ()]"),this.sampling=this.options.sampling||3}o.r(t);var a=o(37),r=o(54);n.prototype=Object.create(r["default"].prototype,{sampling:{get:function(){return this._sampling},set:function(e){this._sampling=e}}}),n.prototype.constructor=n,n.prototype.getData=function(){var e=[{k:"lon",v:this.getLon()},{k:"lat",v:this.getLat()},{k:"indent",v:this.indent},{k:"crs",v:this.crs},{k:"sampling",v:this.sampling},{k:"format",v:this.format}];return e},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(38),r=o(57),s=o(53),i=o(55);t["default"]={build:function(e){var t=n["default"].getLogger("AltiRequestWPS");if(t.trace(["AltiRequestWPS::build()"]),!e)throw new Error(a["default"].getMessage("PARAM_EMPTY","options"));if(!e.type)throw new Error(a["default"].getMessage("PARAM_EMPTY","type (Elevation or Profil)"));var o=null;switch(e.type){case"Elevation":e.wps.identifier="gs:WPSElevation",o=new s["default"](e.param);break;case"Profil":e.wps.identifier="gs:WPSLineElevation",o=new i["default"](e.param);break;default:throw new Error(a["default"].getMessage("PARAM_TYPE","type (Elevation or Profil)"));}var l={data:o,method:e.method,param:e.wps},d=new r["default"](l);if(!d.processRequestString())throw new Error("Enable to process request !");return d.requestString}}},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur WPS()]"),!(this instanceof n))throw new TypeError("WPS constructor cannot be called as a function.");if(this.options=e||{},this.DataObject=this.options.data,!this.DataObject)throw new TypeError("This data object is not defined !");this.paramservice=this.options.param.service||"WPS",this.paramversion=this.options.param.version||"1.0.0",this.paramidentifier=this.options.param.identifier||"gs:WPS",this.paramrawdataoutput=this.options.param.rawdataoutput||"result",this.paramrequest=this.options.param.request||"Execute",this.method=this.options.method||"GET"}o.r(t);var a=o(37);n.prototype={requestString:null,constructor:n,template:{get:{value:"service=__SERVICE__&version=__VERSION__&rawdataoutput=__RAWDATAOUTPUT__&identifier=__IDENTIFIER__&request=__REQUEST__&datainputs=<!-- __DATAINPUTS__ -->",input:"__KEY__=__DATA__"},post:{value:"<?xml version=\"1.0\" encoding=\"UTF-8\"?><wps:__REQUEST__ version=\"__VERSION__\" service=\"__SERVICE__\" __NAMESPACE__ __SCHEMALOCATION__><ows:Identifier>__IDENTIFIER__</ows:Identifier><wps:DataInputs><!-- __DATAINPUTS__ --></wps:DataInputs><wps:ResponseForm><wps:RawDataOutput><ows:Identifier>__RAWDATAOUTPUT__</ows:Identifier></wps:RawDataOutput></wps:ResponseForm></wps:__REQUEST__>",input:"<wps:Input><ows:Identifier>__KEY__</ows:Identifier><wps:Data><wps:LiteralData>__DATA__</wps:LiteralData></wps:Data></wps:Input>"}},namespaceByDefault:function(){return["xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"","xmlns=\"http://www.opengis.net/wps/1.0.0\"","xmlns:wfs=\"http://www.opengis.net/wfs\"","xmlns:wps=\"http://www.opengis.net/wps/1.0.0\"","xmlns:ows=\"http://www.opengis.net/ows/1.1\"","xmlns:gml=\"http://www.opengis.net/gml\"","xmlns:ogc=\"http://www.opengis.net/ogc\"","xmlns:wcs=\"http://www.opengis.net/wcs/1.1.1\"","xmlns:xlink=\"http://www.w3.org/1999/xlink\""].join(" ")},schemaLocationByDefault:function(){return"xsi:schemaLocation=\"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd\""},processRequestString:function(){this.logger.trace("WPS::processRequestString ()");var e="";if("POST"===this.method)e=this.template.post.value;else if("GET"===this.method)e=this.template.get.value;else return this.logger.error("No other method supported by the service !"),!1;return(e=e.replace(/__SERVICE__/g,this.paramservice),e=e.replace(/__VERSION__/g,this.paramversion),e=e.replace(/__RAWDATAOUTPUT__/g,this.paramrawdataoutput),e=e.replace(/__IDENTIFIER__/g,this.paramidentifier),e=e.replace(/__REQUEST__/g,this.paramrequest),"POST"===this.method&&(e=e.replace(/__NAMESPACE__/g,this.namespaceByDefault),e=e.replace(/__SCHEMALOCATION__/g,this.schemaLocationByDefault)),e=e.replace(/<!-- __DATAINPUTS__ -->/g,this.__addDataInputs()),!e)?(this.logger.warn("traduction tmpl : empty request !?"),!1):(this.requestString=e,this.logger.trace("traduction tmpl",e),!0)},__addDataInputs:function(){this.logger.trace("WPS::__addDataInputs ()");for(var e="GET"===this.method?this.template.get.input:this.template.post.input,t="GET"===this.method?";":"",o="",n=this,a=this.DataObject.getData(),r=0;r<a.length;r++)(function(r){t&&(t=r===a.length-1?"":";"),o=o.concat(n.__addDataInput(e,a[r].k,a[r].v),t)})(r);return o},__addDataInput:function(e,t,o){var n=e;return n=n.replace(/__KEY__/g,t),n=n.replace(/__DATA__/g,o),n},setMethod:function(e){"GET"===e||"POST"===e?this.method=e:this.logger.warn("support only GET and POST method !")},getMethod:function(){return this.method}},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(38),r=o(39),s=o(59),i=o(60),l=o(61),d=o(62);t["default"]={build:function(t){var o=n["default"].getLogger("AltiResponseFactory");o.trace(["AltiResponseFactory::build()"]);var c=null;if(!t.response)return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_EMPTY")));if(t.rawResponse)o.trace("analyze response : raw"),c=t.response;else{switch(t.outputFormat){case"xml":o.trace("analyze response : xml");try{var u=new s["default"]({reader:i["default"]});if("string"==typeof t.response?u.setXMLString(t.response):u.setXMLDoc(t.response),c=u.parse(),!c)throw new Error(a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION_2"))}catch(o){var p=o.message;return void t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",p),status:200,type:r["default"].TYPE_SRVERR}))}break;case"json":o.trace("analyze response : json"),o.trace("analyze response : ",typeof t.response);var m;if(m="string"==typeof t.response?JSON.parse(t.response):t.response,m.error)return void t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",m.error.description),status:200,type:r["default"].TYPE_SRVERR}));if(m){var g=m.elevations,f=new l["default"],y;if(Array.isArray(g)&&g.length)for(var _=0;_<g.length;_++)y=new d["default"],"object"==typeof g[_]?(g[_].lon&&(y.lon=g[_].lon),g[_].lat&&(y.lat=g[_].lat),g[_].z&&(y.z=g[_].z),g[_].acc&&(y.acc=g[_].acc)):"number"==typeof g[_]&&(y.z=g[_]),Array.isArray(f.elevations)&&f.elevations.push(y);c=f}if(!c)return void t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_ANALYSE_2"),type:r["default"].TYPE_UNKERR,status:-1}));break;default:return void t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_FORMAT_2"),type:r["default"].TYPE_UNKERR,status:-1}));}if(c.exceptionReport)return void t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",c.exceptionReport),type:r["default"].TYPE_SRVERR,status:200}));if(c.error){var e=c.error.description;return void t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",e),type:r["default"].TYPE_SRVERR,status:200}))}}t.onSuccess.call(t.scope,c)}}},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError("XML constructor cannot be called as a function.");this.logger=l["default"].getLogger(),this.logger.trace("[Constructeur XML ()]"),this.xmlString=null,this.xmlDoc=null,this.reader=null,e&&(e.xmlString&&"string"==typeof e.xmlString&&(this.xmlString=e.xmlString,this.xmlDoc=a(e.xmlString)),e.reader&&this.setReader(e.reader))}function a(e){if("undefined"==typeof window){var t=o(47).DOMParser;return new t().parseFromString(e,"text/xml")}var n="Erreur lors du parsing de la r\xE9ponse du service : XML non conforme",a,r;if(window.ActiveXObject){r=new window.ActiveXObject("Microsoft.XMLDOM"),r.async=!1,r.loadXML(e);var s=r.parseError;if(s.errorCode)throw s.line&&s.linepos&&(n+="( ligne "+s.line+", colonne "+s.linepos),s.reason&&(n+=":  "+s.reason+")"),new Error(n);return r}if(window.DOMParser){a=new window.DOMParser;try{r=a.parseFromString(e,"text/xml")}catch(t){if("SyntaxError"===t.message)throw new Error(n);else throw new Error("Erreur lors du parsing de la r\xE9ponse du service : "+t.message)}if(0<r.getElementsByTagName("parsererror").length){for(var l=r.getElementsByTagName("parsererror"),d=0,p;d<l.length;d++)if(p=l[d].innerHTML,-1===p.indexOf("Huge input lookup"))throw n+="("+p+")",new Error(n);}else if(!r.documentElement)throw new Error(n);return r}throw new Error("Incompatible DOM Parser pour ce navigateur !")}function r(e){var t;return 9===e.nodeType?t=e.documentElement:1===e.nodeType&&(t=e),t}function s(e){var t={};if(0<e.attributes.length){var o=i(e);t.attributes=o}if(e.hasChildNodes())for(var n={},a=e.childNodes,r=0,l;r<a.length;r++)if(l=a[r],3===l.nodeType)t.textContent=l.nodeValue;else if(1===l.nodeType)if(n=s(l),!t[l.nodeName])t[l.nodeName]=n;else{if(!Array.isArray(t[l.nodeName])){var d=t[l.nodeName];t[l.nodeName]=[],t[l.nodeName].push(d)}t[l.nodeName].push(n)}return t}function i(e){if(0<e.attributes.length){for(var t={},o=e.attributes,n=0,a;n<o.length;n++)a=o[n],t[a.nodeName]=a.nodeValue;return t}}o.r(t);var l=o(37);n.prototype={constructor:n,getXMLString:function(){return this.xmlString},setXMLString:function(e){e&&"string"==typeof e&&(this.xmlString=e,this.xmlDoc=a(e))},getReader:function(){return this.reader},setReader:function(e){e&&e.read&&"function"==typeof e.read&&(this.reader=e)},getXMLDoc:function(){return this.xmlDoc},setXMLDoc:function(e){this.xmlDoc=e},parse:function(){if(!this.xmlDoc&&this.xmlString&&(this.xmlDoc=a(this.xmlString)),this.xmlDoc){var e=r(this.xmlDoc);if(e){var t;return this.reader&&this.reader.read?t=this.reader.read(e):(t={},t[e.nodeName]=s(e)),t}return{}}}},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(61),a=o(62),r={};r.READERS={elevations:function(e){var t=new n["default"];if(e.hasChildNodes())for(var o=e.childNodes,a=0,s,l;a<o.length;a++)s=o[a],r.READERS[s.nodeName]&&(l=r.READERS[s.nodeName](s),t.elevations.push(l));return t},elevation:function(e){var t=new a["default"];if(e.hasChildNodes())for(var o=e.childNodes,n=0,s;n<o.length;n++)s=o[n],r.READERS[s.nodeName]&&r.READERS[s.nodeName](s,t);return t},lat:function(e,t){var o=e.firstChild;if(o&&3===o.nodeType)t.lat=parseFloat(o.nodeValue);else throw new Error("Erreur dans la lecture de la r\xE9ponse du service : latitude attendue mais absente")},lon:function(e,t){var o=e.firstChild;if(o&&3===o.nodeType)t.lon=parseFloat(o.nodeValue);else throw new Error("Erreur dans la lecture de la r\xE9ponse du service : longitude attendue mais absente")},z:function(e,t){var o=e.firstChild;if(!(o&&3===o.nodeType))throw new Error("Erreur dans la lecture de la r\xE9ponse du service : altitude attendue mais absente");else if(t)t.z=parseFloat(o.nodeValue);else return t=new a["default"],t.z=parseFloat(o.nodeValue),t},acc:function(e,t){var o=e.firstChild;if(o&&3===o.nodeType)t.acc=parseFloat(o.nodeValue);else throw new Error("Erreur dans la lecture de la r\xE9ponse du service : pr\xE9cision (acc) attendue mais absente")},exceptionreport:function(e){var t={};if(e.hasChildNodes())for(var o=e.childNodes,n=0,a;n<o.length;n++)a=o[n],"Exception"===a.nodeName&&(t.exceptionReport=r.READERS.exception(a));return t},exception:function(e){var t={},o=e.getAttribute("exceptionCode");o&&(t.exceptionCode=o);var n=e.firstChild;return n&&3===n.nodeType&&(t.exception=n.nodeValue),t},error:function(e){var t={error:{}};if(e.hasChildNodes())for(var o=e.childNodes,n=0,a;n<o.length;n++){a=o[n];var r;1===a.nodeType&&"code"===a.nodeName&&(r=a.firstChild,r&&3===r.nodeType&&(t.error.code=r.nodeValue)),1===a.nodeType&&"description"===a.nodeName&&(r=a.firstChild,r&&3===r.nodeType&&(t.error.description=r.nodeValue))}return t}},r.read=function(e){if("elevations"===e.nodeName){var t=r.READERS.elevations(e);return t}if("ExceptionReport"===e.nodeName){var o=r.READERS.exceptionreport(e);return o}if("error"===e.nodeName){var n=r.READERS.error(e);return n}throw new Error("Erreur lors de la lecture de la r\xE9ponse : elle n'est pas au format attendu.")},t["default"]=r},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("AltiResponse constructor cannot be called as a function.");this.elevations=[]}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Elevation constructor cannot be called as a function.");this.z=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError(r["default"].getMessage("CLASS_CONSTRUCTOR","AutoConf"));if(this.CLASSNAME="AutoConf",e||(e={}),e.protocol=e.protocol||"JSONP",d["default"].apply(this,arguments),this.logger=a["default"].getLogger("Gp.Services.AutoConf"),this.logger.trace("[Constructeur AutoConf (options)]"),!this.options.serverUrl&&!this.options.serverUrl){var t=l["default"].AutoConf.url(this.options.apiKey);this.options.serverUrl=this.options.layerId?t.aggregate+this.options.layerId:Array.isArray(this.options.apiKey)&&0<this.options.apiKey.length?t.apiKeys:t.apiKey}"XHR"===this.options.protocol&&"POST"===this.options.httpMethod&&(this.logger.warn("Le service ne g\xE9re pas le mode d'interrogation en POST, on bascule sur du GET !"),this.options.httpMethod="GET"),this.options.outputFormat=this.options.rawResponse?"":"xml"}o.r(t);var a=o(37),r=o(38),s=o(41),i=o(39),l=o(49),d=o(40),p=o(64);n.prototype=Object.create(d["default"].prototype,{}),n.prototype.constructor=n,n.prototype.buildRequest=function(e,t){var o="undefined"==typeof window?{}:window;if(o.Gp&&o.Gp.Config&&o.Gp.Config.generalOptions&&o.Gp.Config.layers&&o.Gp.Config.generalOptions.apiKeys[this.options.apiKey]){if(!this.options.layerId)return this.logger.warn("Gp.Config existe d\xE9j\xE0 pour cette cl\xE9"),void this.options.onSuccess.call(this,o.Gp.Config);if(o.Gp.Config.layers[this.options.layerId]&&o.Gp.Config.layers[this.options.layerId].aggregatedLayers)return this.logger.warn("Gp.Config existe d\xE9j\xE0 pour cette cl\xE9 et cette couche"),void this.options.onSuccess.call(this,o.Gp.Config)}this.request="";var n;n=!(-1!==this.options.serverUrl.indexOf("http://")),!n&&this.layerId&&(this.request=s["default"].normalyzeParameters({layerId:this.layerId})),this.request||""===this.request?t.call(this,this.request):e.call(this,new i["default"](r["default"].getMessage("SERVICE_REQUEST_BUILD")))},n.prototype.analyzeResponse=function(e,t){if(this.response){var o={layerId:this.options.layerId,response:this.response,rawResponse:this.options.rawResponse,onSuccess:t,onError:e,scope:this};p["default"].build(o)}else e.call(this,new i["default"](r["default"].getMessage("SERVICE_RESPONSE_EMPTY")))},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(38),r=o(39),s=o(59),i=o(65);t["default"]={build:function(t){var o=n["default"].getLogger("AutoConfResponseFactory");o.trace(["AutoConfResponseFactory::build()"]);var l=null;if(!t.response)return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_EMPTY")));if(t.rawResponse)l=t.response;else{try{var d=new s["default"]({reader:i["default"]});"string"==typeof t.response?d.setXMLString(t.response):d.setXMLDoc(t.response),l=d.parse()}catch(o){var p=o.message;return p+="string"==typeof t.response?"\n (raw response service'"+t.response+"')":"\n (raw response service'"+t.response.documentElement.innerHTML+"')",void t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",p),status:200,type:r["default"].TYPE_SRVERR}))}var c=!0;for(var u in l)l.hasOwnProperty(u)&&(c=!1);if(c)return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_EMPTY_2")));if(l.exceptionReport)return void t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",l.exceptionReport),type:r["default"].TYPE_SRVERR,status:200}))}var m="undefined"==typeof window?{}:window;m.Gp||(m.Gp={}),m.Gp.Config?this.mergeConfig(m.Gp.Config,l,t.layerId):m.Gp.Config=l,t.onSuccess.call(t.scope,m.Gp.Config)},mergeConfig:function(e,t,o){if(t&&e){for(var n in t)if(t.hasOwnProperty(n))if("generalOptions"===n)for(var a in t[n].apiKeys)t[n].apiKeys.hasOwnProperty(a)&&!e.generalOptions.apiKeys[a]&&(e.generalOptions.apiKeys[a]=t[n].apiKeys[a]);else if(e[n])for(var r in t[n])t[n].hasOwnProperty(r)&&!e[n][r]&&(e[n][r]=t[n][r]);if(o){var s=[];for(var i in t.layers)t.layers.hasOwnProperty(i)&&s.push(i);e.layers[o]&&(e.layers[o].aggregatedLayers=s)}}}}},function(e,t,o){"use strict";function n(e){if(0<e.attributes.length){for(var t={},o=e.attributes,n=0,a;n<o.length;n++)a=o[n],t[a.nodeName]=a.nodeValue;return t}}function a(e,t){if(e.hasChildNodes())for(var o=e.childNodes,n=0,r,s,l;n<o.length;n++)if(r=o[n],1===r.nodeType)if(s=r.localName||r.baseName||r.nodeName,l=r.prefix||S.DEFAULTPREFIX,S.READERS[l][s]){var d=S.READERS[l][s];d(r,t)}else a(r,t)}function r(e){var t="",o;return e.hasChildNodes()&&(o=e.firstChild,(3===o.nodeType||4===o.nodeType)&&(t=o.nodeValue)),t}function s(e){if(0<e.attributes.length){var t=n(e);for(var o in t)if(t.hasOwnProperty(o)){if("version"===o&&t.version!==S.VERSION)return void console.log("[AutoConfResponseReader] autoconf version is not the expected one : there may be errors in parsing");if("xmlns"===o){if(t[o]!==S.NAMESPACES.xmlns)return void console.log("[AutoConfResponseReader] autoconf response default namespace is not the expected one");continue}var a=o.split(":")[0],r=o.split(":")[1];if("xmlns"===a&&r&&S.NAMESPACES[r]&&S.NAMESPACES[r]!==t[o])return void console.log("[AutoConfResponseReader] autoconf response "+o+" namespace is not the expected one");if("schemaLocation"===r&&t[o]!==S.SCHEMALOCATION[0]&&t[o]!==S.SCHEMALOCATION[1])return void console.log("[AutoConfResponseReader] autoconf response schema location is not the expected one")}}}o.r(t);var i=o(66),l=o(67),d=o(68),p=o(69),c=o(70),u=o(71),m=o(72),g=o(73),f=o(74),y=o(75),_=o(76),E=o(77),h=o(78),b=o(79),S={};S.VERSION="1.1.0",S.NAMESPACES={xmlns:"http://www.opengis.net/context",gpp:"http://api.ign.fr/geoportail",ows:"http://www.opengis.net/ows/1.1",sld:"http://www.opengis.net/sld",wmts:"http://www.opengis.net/wmts/1.0",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},S.SCHEMALOCATION=["http://www.opengis.net/context http://wxs.ign.fr/schemas/extContext.xsd http://api.ign.fr/geoportail http://wxs.ign.fr/schemas/autoconf/autoconf.xsd","http://www.opengis.net/context http://wxs.ign.fr/schemas/extContext.xsd http://api.ign.fr/geoportail http://wxs.ign.fr/schemas/autoconf.xsd"],S.DEFAULTPREFIX="context",S.READERS={context:{ViewContext:function(e){s(e);var t=new i["default"];return a(e,t),t},Title:function(e,t){t&&t.generalOptions?t.generalOptions.title=r(e):t&&t.lyr&&(t.lyr.title=r(e))},Abstract:function(e,t){t&&t.lyr&&(t.lyr.description=r(e))},Server:function(e,t){var o=e.getAttribute("service"),n=e.getAttribute("title"),r=e.getAttribute("version");if(o)if(t&&t.services&&"object"==typeof t.services&&!t.services[o]){var i=new g["default"];i.title=n,i.version=r,a(e,i),t.services[o]=i}else t&&t.lyr&&(t.lyr.serviceParams||(t.lyr.serviceParams={}),t.lyr.serviceParams.id=o,t.lyr.serviceParams.version=r)},OnlineResource:function(e,t){t&&t.hasOwnProperty("serverUrl")&&(t.serverUrl=e.getAttribute("xlink:href"))},LayerList:function(e,t){if(a(e,t),t&&t.layers&&t.generalOptions&&t.services)for(var o in t.layers)if(t.layers.hasOwnProperty(o)){var n=t.layers[o],r=n.apiKeys;if(r&&Array.isArray(r))for(var l=0,d;l<r.length;l++)d=r[l],t.generalOptions.apiKeys&&((!t.generalOptions.apiKeys[d]||!Array.isArray(t.generalOptions.apiKeys[d]))&&(t.generalOptions.apiKeys[d]=[]),t.generalOptions.apiKeys[d].push(o));var p=n.serviceParams;if(p&&p.id&&!t.services[p.id]){var c=new g["default"];p.serverUrl&&(c.serverUrl=p.serverUrl),p.version&&(c.version=p.version),t.services[p.id]=c}if(n.wmtsOptions&&n.wmtsOptions.tileMatrixSetLink&&t.tileMatrixSets){var s=n.wmtsOptions.tileMatrixSetLink,u=t.tileMatrixSets;for(var m in u)u.hasOwnProperty(m)&&m===s&&(n.defaultProjection=u[m].projection)}}},Layer:function(e,t){if(t&&t.layers){var o={lyr:new p["default"],lyrId:null},n=e.getAttribute("hidden");o.lyr.hidden="1"===n;var r=e.getAttribute("queryable");if(o.lyr.queryable="1"===r,a(e,o),o.lyrId){if(o.lyr.serviceParams&&o.lyr.serviceParams.id){var s=o.lyr.serviceParams.id;if(-1!==s.toUpperCase().indexOf("OPENLS")||-1!==s.toUpperCase().indexOf("ELEVATION")){var i=o.lyrId.split("$")[0];o.lyrId=i+"$"+s}}o.lyr.layerId=o.lyrId,t.layers[o.lyrId]=o.lyr}}},Name:function(e,t){t&&t.lyr&&(t.lyr.name=r(e))},SRS:function(e,t){t&&t.lyr&&(t.lyr.defaultProjection=r(e))},Format:function(e,t){if(t&&t.lyr){var o=new d["default"],n=e.getAttribute("current");o.current=!("1"!==n),o.name=r(e),t.lyr.formats&&Array.isArray(t.lyr.formats)||(t.lyr.formats=[]),t.lyr.formats.push(o)}},Style:function(e,t){if(t&&t.lyr){var o=new f["default"],n=e.getAttribute("current");if(o.current="1"===n||1===n,e.hasChildNodes)for(var a=e.childNodes,s=0,l,d;s<a.length;s++)l=a[s],1===l.nodeType&&(d=l.localName||l.baseName||l.nodeName,"Name"===d?o.name=r(l):"Title"===d?o.title=r(l):"URL"===d&&(o.url=r(l)));t.lyr.styles&&Array.isArray(t.lyr.styles)||(t.lyr.styles=[]),t.lyr.styles.push(o)}},Dimension:function(e,t){var o=e.getAttribute("name"),n=r(e);t&&t.lyr&&(!t.lyr.dimensions&&(t.lyr.dimensions={}),"Type"===o?t.lyr.dimensions.type=n:"VisibilityRange"===o?t.lyr.dimensions.visibilityRange=n:"VisibilityMode "===o?t.lyr.dimensions.visibilityMode=n:"GeometricType"===o?t.lyr.dimensions.geometricType=n:"NoDataValue"===o&&(t.lyr.dimensions.noDataValue=n))}},gpp:{Theme:function(e,t){t&&t.generalOptions&&t.generalOptions.hasOwnProperty("theme")&&(t.generalOptions.theme=r(e))},defaultGMLGFIStyleUrl:function(e,t){t&&t.generalOptions&&t.generalOptions.hasOwnProperty("defaultGMLGFIStyle")&&(t.generalOptions.defaultGMLGFIStyle=r(e))},Territory:function(e,o){var n=e.getAttribute("id");if(n){var r=new y["default"],t=e.getAttribute("default");r.isDefault=!("1"!==t),a(e,r),o&&o.territories&&"object"==typeof o.territories&&(o.territories[n]=r)}},defaultCRS:function(e,t){t&&t.hasOwnProperty("defaultCRS")&&(t.defaultCRS=r(e))},AdditionalCRS:function(e,t){var o=r(e);o&&t&&(Array.isArray(t.additionalCRS)?t.additionalCRS.push(o):((!t.additionalProjections||!Array.isArray(t.additionalProjections))&&(t.additionalProjections=[]),t.additionalProjections.push(o)))},DefaultLayer:function(e,t){var o=e.getAttribute("layerId");o&&t&&Array.isArray(t.defaultLayers)&&t.defaultLayers.push(o)},BoundingBox:function(e,t){if(t){var o=r(e).split(",");if(4===o.length){var n={left:parseFloat(o[0]),right:parseFloat(o[2]),top:parseFloat(o[3]),bottom:parseFloat(o[1])},a=e.getAttribute("minT"),s=e.getAttribute("maxT");if(t.hasOwnProperty("geoBBOX"))t.geoBBOX=n;else if(!t.hasOwnProperty("bbox"))t.globalConstraint||(t.globalConstraint=new l["default"]),t.globalConstraint.bbox=n,t.globalConstraint.temporalExtent=[a,s];else if(t.bbox.left||t.bbox.right||t.bbox.top||t.bbox.bottom){t.multiConstraints||(t.multiConstraints=[]);var i=new l["default"];i.bbox=n,i.temporalExtent=[a,s],t.multiConstraints.push(i)}else t.bbox=n,t.temporalExtent=[a,s]}}},Resolution:function(e,t){var o=r(e);o&&t&&t.defaultOptions&&t.defaultOptions.hasOwnProperty("resolution")&&(t.defaultOptions.resolution=parseFloat(o))},x:function(e,t){var o=r(e);o&&t&&t.geoCenter&&t.geoCenter.hasOwnProperty("lon")&&(t.geoCenter.lon=parseFloat(o))},y:function(e,t){var o=r(e);o&&t&&t.geoCenter&&t.geoCenter.hasOwnProperty("lat")&&(t.geoCenter.lat=parseFloat(o))},Resolutions:function(e,t){t&&t.generalOptions&&t.generalOptions.hasOwnProperty("wgs84Resolutions")&&(t.generalOptions.wgs84Resolutions=r(e).split(","))},Layer:function(e,t){if(t&&t.hasOwnProperty("lyrId")&&t.lyr){t.lyrId=e.getAttribute("id");var o=e.getAttribute("aggregate"),n=e.getAttribute("more");(o||n)&&(t.lyr.isAggregate=!0),a(e,t.lyr)}},Constraint:function(e,t){var o=new l["default"];if(a(e,o),t)if(t.constraints&&Array.isArray(t.constraints)||(t.constraints=[]),o.multiConstraints&&Array.isArray(o.multiConstraints)){var n=new l["default"];n.crs=o.crs,n.bbox=o.bbox,n.minScaleDenominator=o.minScaleDenominator,n.maxScaleDenominator=o.maxScaleDenominator,n.temporalExtent=o.temporalExtent,t.constraints.push(n);for(var r=0;r<o.multiConstraints.length;r++)n=new l["default"],n.crs=o.crs,n.minScaleDenominator=o.minScaleDenominator,n.maxScaleDenominator=o.maxScaleDenominator,n.bbox=o.multiConstraints[r].bbox,n.temporalExtent=o.multiConstraints[r].temporalExtent,t.constraints.push(n)}else t.constraints.push(o)},CRS:function(e,t){t&&t.hasOwnProperty("crs")&&(t.crs=r(e))},Thematic:function(e,o){if(o){var n=new _["default"];n.inspire=!1,n.name=r(e),o.thematics&&Array.isArray(o.thematics)||(o.thematics=[]),o.thematics.push(n)}},InspireThematic:function(e,o){if(o){var n=new _["default"];n.inspire=!0,n.name=r(e),o.thematics&&Array.isArray(o.thematics)||(o.thematics=[]),o.thematics.push(n)}},Originator:function(e,t){if(t){var n=new m["default"];n.name=e.getAttribute("name"),a(e,n),t.originators&&Array.isArray(t.originators)||(t.originators=[]),t.originators.push(n)}},Attribution:function(e,t){t&&t.hasOwnProperty("attribution")&&(t.attribution=r(e))},Logo:function(e,t){t&&t.hasOwnProperty("logo")&&(t.logo=r(e))},URL:function(e,t){t&&t.hasOwnProperty("url")&&(t.url=r(e))},Legend:function(e,t){var o=new c["default"];a(e,o),t&&((!t.legends||!Array.isArray(t.legends))&&(t.legends=[]),t.legends.push(o))},LegendURL:function(e,t){if(t&&t.hasOwnProperty("format")&&(t.format=e.getAttribute("format"),e.hasChildNodes)){var o=e.childNodes[0],n=o.localName||o.baseName||o.nodeName;"OnlineResource"===n&&t.hasOwnProperty("url")&&(t.url=o.getAttribute("xlink:href"))}},QuickLook:function(e,t){if(e.hasChildNodes){var o=e.childNodes[0],n=o.localName||o.baseName||o.nodeName;"OnlineResource"===n&&t&&(t.quicklookUrl=o.getAttribute("xlink:href"))}},MetadataURL:function(e,t){if(t){var o=new u["default"];if(o.format=e.getAttribute("format"),e.hasChildNodes){var n=e.childNodes[0],a=n.localName||n.baseName||n.nodeName;"OnlineResource"===a&&(o.url=n.getAttribute("xlink:href"))}t.metadata||Array.isArray(t.metadata)||(t.metadata=[]),t.metadata.push(o)}},Key:function(e,t){if(t){var o=e.getAttribute("id");t.apiKeys&&Array.isArray(t.apiKeys)||(t.apiKeys=[]),t.apiKeys.push(o);var n=r(e);t.serviceParams||(t.serviceParams={}),t.serviceParams.serverUrl||(t.serviceParams.serverUrl={}),t.serviceParams.serverUrl[o]||(t.serviceParams.serverUrl[o]=n)}}},ows:{Identifier:function(e,t){t&&t.hasOwnProperty("TMS")?t.identifier=r(e):t&&t.hasOwnProperty("matrixId")&&(t.matrixId=r(e))},SupportedCRS:function(e,t){t&&t.TMS&&t.TMS.hasOwnProperty("projection")&&(t.TMS.projection=r(e))}},sld:{MinScaleDenominator:function(e,t){var o=r(e);o&&t&&(t.hasOwnProperty("defaultOptions")?t.defaultOptions.minScaleDenominator=parseFloat(o):t.lyr?(!t.lyr.globalConstraint&&(t.lyr.globalConstraint=new l["default"]),t.lyr.globalConstraint.minScaleDenominator=parseFloat(o)):t.hasOwnProperty("minScaleDenominator")&&(t.minScaleDenominator=parseFloat(o)))},MaxScaleDenominator:function(e,t){var o=r(e);o&&t&&(t.hasOwnProperty("defaultOptions")?t.defaultOptions.maxScaleDenominator=parseFloat(o):t.lyr?(!t.lyr.globalConstraint&&(t.lyr.globalConstraint=new l["default"]),t.lyr.globalConstraint.maxScaleDenominator=parseFloat(o)):t.hasOwnProperty("maxScaleDenominator")&&(t.maxScaleDenominator=parseFloat(o)))}},wmts:{TileMatrixSetLimits:function(e,t){if(t){var o={};a(e,o),t.wmtsOptions||(t.wmtsOptions={}),t.wmtsOptions.tileMatrixSetLimits=o}},TileMatrixLimits:function(e,t){var o=new b["default"],n;if(e.hasChildNodes){for(var a=e.childNodes,s=0;s<a.length;s++){var l=a[s],d=l.localName||l.baseName||l.nodeName;"TileMatrix"===d?n=r(l):"MinTileRow"===d?o.minTileRow=r(l):"MaxTileRow"===d?o.maxTileRow=r(l):"MinTileCol"===d?o.minTileCol=r(l):"MaxTileCol"===d&&(o.maxTileCol=r(l))}n&&t&&!t[n]&&(t[n]=o)}},TileMatrixSet:function(e,t){if(t&&t.tileMatrixSets){var o={};o.TMS=new E["default"],o.resolutions=[],a(e,o);var n=o.TMS.tileMatrices;for(var s in n)n.hasOwnProperty(s)&&o.TMS.matrixIds.push(s);if(("IGNF:WGS84G"===o.TMS.getProjection()||"EPSG:4326"===o.TMS.getProjection())&&t.generalOptions&&Array.isArray(t.generalOptions.wgs84Resolutions))for(var l=t.generalOptions.wgs84Resolutions,d=0;d<l.length;d++)o.resolutions[d]=parseFloat(l[d]);Array.isArray(o.resolutions)&&o.resolutions.sort!==void 0&&o.resolutions.sort(function(e,t){return t-e}),o.TMS.nativeResolutions=o.resolutions,t.tileMatrixSets[o.identifier]=o.TMS}else t&&!t.wmtsOptions&&(t.wmtsOptions={}),t.wmtsOptions.tileMatrixSetLink=r(e)},TileMatrix:function(e,t){if(t){var o=new h["default"];if(a(e,o),t.TMS&&t.TMS.getProjection()){var n=t.TMS.getProjection();if("EPSG:3857"===n||"EPSG:2154"===n){var s=28e-5*o.scaleDenominator;t.resolutions&&Array.isArray(t.resolutions)&&t.resolutions.push(s)}}t.TMS&&t.TMS.tileMatrices&&(t.TMS.tileMatrices[o.matrixId]=o)}},ScaleDenominator:function(e,t){var o=r(e);o&&t&&t.hasOwnProperty("scaleDenominator")&&(t.scaleDenominator=parseFloat(o))},TopLeftCorner:function(e,t){var o=r(e).split(" ");o&&t&&(t.topLeftCorner={},t.topLeftCorner.x=parseFloat(o[0]),t.topLeftCorner.y=parseFloat(o[1]))},TileWidth:function(e,t){var o=r(e);o&&t&&t.hasOwnProperty("tileWidth")&&(t.tileWidth=parseInt(o,10))},TileHeight:function(e,t){var o=r(e);o&&t&&t.hasOwnProperty("tileHeight")&&(t.tileHeight=parseInt(o,10))},MatrixWidth:function(e,t){var o=r(e);o&&t&&t.hasOwnProperty("matrixWidth")&&(t.matrixWidth=parseInt(o,10))},MatrixHeight:function(e,t){var o=r(e);o&&t&&t.hasOwnProperty("matrixHeight")&&(t.matrixHeight=parseInt(o,10))}},serviceException:function(e){var t={};if(e.hasChildNodes())for(var o=e.childNodes,n=0,a;n<o.length;n++)a=o[n],"exception"===a.nodeName&&(t.exceptionReport=S.READERS.exception(a));return t},exception:function(e){var t={},o=e.getAttribute("code");o&&(t.exceptionCode=o);var n=e.firstChild;return n&&3===n.nodeType&&(t.exception=n.nodeValue),t}},S.read=function(e){if("ViewContext"===e.nodeName){var t=e.prefix||S.DEFAULTPREFIX,o=S.READERS[t][e.nodeName](e);return o}if("serviceException"===e.nodeName){var n=S.READERS[e.nodeName](e);return n}throw new Error("Erreur lors de la lecture de la r\xE9ponse : elle n'est pas au format attendu.")},t["default"]=S},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("AutoConfResponse constructor cannot be called as a function.");this.generalOptions={apiKeys:{},title:null,defaultGMLGFIStyle:null,theme:null,wgs84Resolutions:[]},this.layers={},this.territories={},this.tileMatrixSets={},this.services={}}o.r(t),n.prototype={constructor:n,isConfLoaded:function(e){return e?!!this.generalOptions.apiKeys[e]:void 0},getLayersId:function(e){return this.generalOptions.apiKeys[e]},getLayersConf:function(e){var t={},o=this.getLayersId(e);if(o)for(var n=0,a;n<o.length;n++)a=o[n],t[a]=this.layers[a];return t},getLayerConf:function(e){return this.layers?this.layers[e]:void 0},getTileMatrixSets:function(){return this.tileMatrixSets},getTMSConf:function(e){return this.tileMatrixSets?this.tileMatrixSets[e]:void 0},getTerritories:function(){return this.territories},getTerritoryConf:function(e){return this.territories?this.territories[e]:void 0},getServices:function(){return this.services},getServiceConf:function(e){return this.services?this.services[e]:void 0}},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Constraint constructor cannot be called as a function.");this.crs=null,this.bbox={left:null,right:null,top:null,bottom:null},this.minScaleDenominator=null,this.maxScaleDenominator=null,this.temporalExtent=[null,null]}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Format constructor cannot be called as a function.");this.current=null,this.name=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Layer constructor cannot be called as a function.")}o.r(t),n.prototype={constructor:n,getName:function(){return this.name},getTitle:function(){return this.title},getDescription:function(){return this.description},getLayerId:function(){return this.layerId},getQuicklookUrl:function(){return this.quicklookUrl},getDefaultProjection:function(){return this.defaultProjection},getProjections:function(){var e=[this.defaultProjection],t=e.concat(this.additionalProjections);return t},getBBOX:function(){return this.globalConstraint?this.globalConstraint.bbox:void 0},getMinScaleDenominator:function(){return this.globalConstraint?this.globalConstraint.minScaleDenominator:void 0},getMaxScaleDenominator:function(){return this.globalConstraint?this.globalConstraint.maxScaleDenominator:void 0},getTMSID:function(){if(this.wmtsOptions)return this.wmtsOptions.tileMatrixSetLink},getServiceParams:function(){return this.serviceParams},getServerUrl:function(e){return e&&this.serviceParams&&this.serviceParams.serverUrl?this.serviceParams.serverUrl[e]:void 0},getLegends:function(){return this.legends},getMetadata:function(){return this.metadata},getStyles:function(){return this.styles},getDefaultStyle:function(){if(this.styles){for(var e=this.styles,t=0,o;t<e.length;t++)if(!0===e[t].current){o=e[t].name;break}return o}},getThematics:function(){return this.thematics},getDefaultFormat:function(){if(this.formats){for(var e=this.formats,t=0,o;t<e.length;t++)if(!0===e[t].current){o=e[t].name;break}return o}},getConstraints:function(){return this.constraints},getOriginators:function(){return this.originators},getDimensions:function(){return this.dimensions},getAggregatedLayers:function(){if(this.isAggregate)return this.aggregatedLayers}},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Legend constructor cannot be called as a function.");this.format=null,this.url=null,this.minScaleDenominator=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Metadata constructor cannot be called as a function.");this.format=null,this.url=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Originator constructor cannot be called as a function.");this.name=null,this.attribution=null,this.logo=null,this.url=null,this.constraints=[]}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Service constructor cannot be called as a function.");this.title=null,this.serverUrl=null,this.version=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Style constructor cannot be called as a function.");this.name=null,this.title=null,this.current=null,this.url=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Territory constructor cannot be called as a function.");this.isDefault=null,this.defaultCRS=null,this.additionalCRS=[],this.geoBBOX={left:null,right:null,top:null,bottom:null},this.geoCenter={lon:null,lat:null},this.defaultOptions={resolution:null,minScaleDenominator:null,maxScaleDenominator:null},this.defaultLayers=[]}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Thematic constructor cannot be called as a function.");this.inspire=null,this.name=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("TileMatrixSet constructor cannot be called as a function.");this.projection=null,this.nativeResolutions=[],this.matrixIds=[],this.tileMatrices={}}o.r(t),n.prototype={constructor:n,getResolutions:function(){return this.nativeResolutions},getMatrixIds:function(){return this.matrixIds},getProjection:function(){return this.projection},getTileMatrices:function(){return this.tileMatrices},getTopLeftCorner:function(){var e=this.getTileMatrices(),t;if(e)for(var o in e)if(e.hasOwnProperty(o)){t=e[o].topLeftCorner;break}return t}},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("TileMatrix constructor cannot be called as a function.");this.matrixId=null,this.matrixHeight=null,this.matrixWidth=null,this.scaleDenominator=null,this.tileHeight=null,this.tileWidth=null,this.topLeftCorner=null}o.r(t),n.prototype={constructor:n,getTopLeftCorner:function(){return this.topLeftCorner},getScaleDenominator:function(){return this.scaleDenominator},getTileHeight:function(){return this.tileHeight},getTileWidth:function(){return this.tileWidth},getMatrixHeight:function(){return this.matrixHeight},getMatrixWidth:function(){return this.matrixWidth}},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("TileMatrixLimit constructor cannot be called as a function.");this.minTileRow=null,this.maxTileRow=null,this.minTileCol=null,this.maxTileCol=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError(r["default"].getMessage("CLASS_CONSTRUCTOR","Geocode"));if(this.CLASSNAME="Geocode",l["default"].apply(this,arguments),this.logger=a["default"].getLogger("Gp.Services.Geocode"),this.logger.trace("[Constructeur Geocode (options)]"),!e.location)throw new Error(r["default"].getMessage("PARAM_MISSING","location"));if("object"==typeof e.location&&0===Object.keys(e.location).length)throw new Error(r["default"].getMessage("PARAM_EMPTY","location"));else if("string"==typeof e.location&&0===e.location.length)throw new Error(r["default"].getMessage("PARAM_EMPTY","location"));this.options.location=e.location,e.filterOptions&&"object"==typeof e.filterOptions||(this.options.filterOptions=e.filterOptions={type:["StreetAddress"]}),0===Object.keys(e.filterOptions).length&&(this.options.filterOptions={type:["StreetAddress"]});for(var t=Object.keys(e.filterOptions),o=0;o<t.length;o++){var s=t[o];-1!==["department","number","postalCode","insee","importance","ID","IDTR","absorbedCity","sheet","section","inseeRegion","inseeDepartment"].indexOf(s)&&"string"!=typeof e.filterOptions[s]&&(e.filterOptions[s]=e.filterOptions[s].toString()),e.filterOptions[s]||delete this.options.filterOptions[s]}this.options.filterOptions.type=e.filterOptions.type||["StreetAddress"],this.options.maximumResponses=e.maximumResponses||25,this.options.returnFreeForm=e.returnFreeForm||!1,this.options.srs=e.srs||"EPSG:4326",this.options.outputFormat=this.options.rawResponse?"":"xml"}o.r(t);var a=o(37),r=o(38),s=o(39),l=o(40),d=o(81),p=o(98);n.prototype=Object.create(l["default"].prototype,{}),n.prototype.constructor=n,n.prototype.buildRequest=function(e,t){var o={httpMethod:this.options.httpMethod,location:this.options.location,returnFreeForm:this.options.returnFreeForm,filterOptions:this.options.filterOptions,srs:this.options.srs,maximumResponses:this.options.maximumResponses};this.request=d["default"].build(o),this.request?t.call(this,this.request):e.call(this,new s["default"](r["default"].getMessage("SERVICE_REQUEST_BUILD")))},n.prototype.analyzeResponse=function(e,t){if(this.response){var o={response:this.response,rawResponse:this.options.rawResponse,onError:e,onSuccess:t,scope:this};p["default"].build(o)}else e.call(this,new s["default"](r["default"].getMessage("SERVICE_RESPONSE_EMPTY")))},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(82),r=o(86),s=o(89),i=o(93),l=o(95),d=o(96),p=o(97);t["default"]={build:function(e){var t=n["default"].getLogger("DirectGeocodeRequestFactory");t.trace(["DirectGeocodeRequestFactory::build()"]);var o=null,c=new s["default"];c.addFilterExtensions(new p["default"]),c.addFilterExtensions(new i["default"]),c.addFilterExtensions(new l["default"]),c.addFilterExtensions(new d["default"]);var u=new r["default"]({location:e.location,returnFreeForm:e.returnFreeForm,filterOptions:e.filterOptions});u.addFilter(c);var m=new a["default"]({srsName:e.srs,maximumResponses:e.maximumResponses});if(m.namespace=!0,m.setService(u),o=m.build(),"GET"===e.httpMethod){var g="qxml="+encodeURIComponent(o).replace(/-/g,"%2D").replace(/_/g,"%5F").replace(/\./g,"%2E").replace(/!/g,"%21").replace(/~/g,"%7E").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29");o=g}return t.trace(o),o}}},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur XLS()]"),!(this instanceof n))throw new TypeError("XLS constructor cannot be called as a function.");for(var t in this.options={srsName:"EPSG:4326",maximumResponses:25},e)e.hasOwnProperty(t)&&e[t]&&(this.options[t]=e[t])}o.r(t);var a=o(37),r=o(83),s=o(84),i=o(85);n.VERSION="1.2",n.prototype={requestString:null,namespace:!1,oService:null,constructor:n,template:"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<XLS version=\"__VERSION__\"\n__NAMESPACE__ \n__SCHEMALOCATION__>\n__REQUESTHEADER__\n__REQUEST__\n</XLS>\n",namespaceByDefault:function(){return["xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"","xmlns:xls=\"http://www.opengis.net/xls\"","xmlns:gml=\"http://www.opengis.net/gml\""].join(" ")},schemaLocationByDefault:function(){return"xsi:schemaLocation=\"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd\""},setService:function(e){return e?void(e instanceof i["default"]?this.oService=e:this.logger.error("L'objet n'est pas du type 'LocationUtilityService' ou 'RouteService' !?")):void this.logger.trace("L'objet de type Service XSL n'est pas encore defini !?")},getService:function(){return this.oService}},n.prototype.addNamespace=function(e,t){for(var o=e.key,n=!1,a=this.namespaceByDefault().split(" "),r=0;r<a.length;r++){var s=a[r],i=s.split("="),l=i[0];if(l==="xmlns:"+o){n=!0;break}}if(!n)return this.logger.warn("L'ajout d'un nouvel namespace n'est pas encore impl\xE9ment\xE9 !"),t;var d,p;return d=/<(\w+[\s>])/g,p="<"+o+":$1",t=t.replace(d,p),d=/<\/(\w+[\s>])/g,p="</"+o+":$1",t=t.replace(d,p),this.logger.trace("namespace",t),t},n.prototype.build=function(){var e=!!this.getService(),t="";t=this.template,t=t.replace(/__VERSION__/g,n.VERSION),t=t.replace(/__NAMESPACE__/g,this.namespaceByDefault),t=t.replace(/__SCHEMALOCATION__/g,this.schemaLocationByDefault);var o=new r["default"]({srsName:this.options.srsName});t=t.replace(/__REQUESTHEADER__/g,o.toString());var a=new s["default"]({maximumResponses:this.options.maximumResponses,version:n.VERSION,methodName:e?this.getService().CLASSTYPE:null});return(t=t.replace(/__REQUEST__/g,a.toString()),e&&(t=t.replace(/<!-- __REQUESTSERVICE__ -->/g,this.getService().toString())),!t)?void this.logger.warn("traduction tmpl : empty request !?"):(this.namespace&&(t=this.addNamespace({key:"xls",url:"http://www.opengis.net/xls"},t)),this.requestString=t,this.logger.trace("traduction tmpl",t),this.requestString)},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur RequestHeader ()]"),!(this instanceof n))throw new TypeError("RequestHeader constructor cannot be called as a function.");for(var t in this.options=e||{srsName:"EPSG:4326"},e)e.hasOwnProperty(t)&&(this.options[t]=e[t])}o.r(t);var a=o(37);n.prototype={requestString:null,template:"<RequestHeader srsName=\"__SRSNAME__\"/>",constructor:n,toString:function(){var e=null;return e=this.template,e=e.replace(/__SRSNAME__/g,this.options.srsName),this.requestString=e,this.requestString}},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur Request ()]"),!(this instanceof n))throw new TypeError("Request constructor cannot be called as a function.");for(var t in this.options=e||{maximumResponses:25,methodName:null,version:"1.2"},e)e.hasOwnProperty(t)&&(this.options[t]=e[t])}o.r(t);var a=o(37);n.prototype={requestString:null,template:"<Request maximumResponses=\"__MAXRESPONSES__\" methodName=\"__METHODNAME__\" requestID=\"__UUID__\" version=\"__VERSION__\"><!-- __REQUESTSERVICE__ --></Request>",constructor:n,guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=0|16*Math.random(),o="x"===e?t:8|3&t;return o.toString(16)})},toString:function(){var e=null;return e=this.template,e=e.replace(/__MAXRESPONSES__/g,this.options.maximumResponses),e=e.replace(/__METHODNAME__/g,this.options.methodName),e=e.replace(/__UUID__/g,this.guid()),e=e.replace(/__VERSION__/g,this.options.version),this.requestString=e,this.requestString}},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur AbstractService ()]"),!(this instanceof n))throw new TypeError("AbstractService constructor cannot be called as a function.");for(var t in this.options=e||{},e)e.hasOwnProperty(t)&&(this.options[t]=e[t])}o.r(t);var a=o(37);n.prototype={strRequest:null,oRequest:null,oFilter:null,constructor:n,addRequest:function(){this.logger.error("overwritten method !")},addFilter:function(){this.logger.error("overwritten method !")},toString:function(){this.logger.error("overwritten method !")}},t["default"]=n},function(e,t,o){"use strict";function n(){if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur LocationUtilityService ()]"),!(this instanceof n))throw new TypeError("LocationUtilityService constructor cannot be called as a function.");this.CLASSNAME="LocationUtilityService",this.CLASSTYPE=null,r["default"].apply(this,arguments),this.options&&(this.CLASSTYPE=this.options.location?"GeocodeRequest":this.options.position?"ReverseGeocodeRequest":null)}o.r(t);var a=o(37),r=o(85),s=o(87),i=o(90),l=o(89);n.prototype=Object.create(r["default"].prototype,{}),n.prototype.constructor=n,n.prototype.addRequest=function(e){switch(this.CLASSTYPE=e.CLASSNAME,this.CLASSTYPE){case"GeocodeRequest":case"ReverseGeocodeRequest":this.oRequest=e;break;default:throw new Error("Ce n'est pas un objet de type 'LUS Request' !?");}},n.prototype.addFilter=function(e){e instanceof l["default"]&&(this.oFilter=e)},n.prototype.toString=function(){if(!this.oRequest){if(!this.options)throw new Error("Les options ne sont pas renseign\xE9es, impossible de construire la requ\xEAte !");if("GeocodeRequest"===this.CLASSTYPE){var e={location:this.options.location,returnFreeForm:this.options.returnFreeForm,filterOptions:this.options.filterOptions||{}};this.oRequest=new s["default"](e),this.oFilter&&this.oRequest.addFilter(this.oFilter)}else if("ReverseGeocodeRequest"===this.CLASSTYPE){var t={position:this.options.position,returnFreeForm:this.options.returnFreeForm,filterOptions:this.options.filterOptions||{}};this.oRequest=new i["default"](t)}else this.logger.error("impossible de determiner le type de geocodage : Direct ou Inverse !?")}if(!this.oRequest)throw new Error("Type de Geocodage indefini !");return this.strRequest=this.oRequest.toString(),this.strRequest},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur GeocodeRequest ()]"),!(this instanceof n))throw new TypeError("GeocodeRequest constructor cannot be called as a function.");for(var t in this.options=e||{},e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);this.CLASSNAME="GeocodeRequest"}o.r(t);var a=o(37),r=o(88),s=o(89);n.prototype={strRequest:null,oAddress:null,oFilter:null,template:"<GeocodeRequest returnFreeForm=\"__RETURNFREEFORM__\">__ADDRESS__</GeocodeRequest>",addAddress:function(e){e instanceof r["default"]&&(this.oAddress=e)},addFilter:function(e){e instanceof s["default"]&&(this.oFilter=e)},constructor:n,toString:function(){var e="";if(e=this.template,!this.oAddress){var t={};if(t.location=this.options.location,t.type=this.options.filterOptions.type||["StreetAddress"],t.filter=this.options.filterOptions,delete t.filter.type,this.oFilter)for(var o in t.filter={},t.type){var n=t.type[o],a=this.oFilter.getFilter(n);if(!a){this.logger.warn("Le filtre '"+n+"' n'existe pas !?");continue}for(var s=this.options.filterOptions,i=a.attributesList,l=0,d;l<i.length;l++)if(d=i[l],s[d]){var p=a.serviceAttributes[l];a.placeAttributes[p]=s[d],this.logger.trace("Selection du filtre '"+d+"' sur le type '"+n+"'.")}var c=a.placeAttributes;for(var u in c)c.hasOwnProperty(u)&&(t.filter[u]=c[u])}if(this.oAddress=new r["default"](t),!this.oAddress)throw new Error("La construction de l'adresse n'est pas correctement definie !?")}return e=e.replace(/__ADDRESS__/g,this.oAddress.toString()),e=e.replace(/__RETURNFREEFORM__/g,this.options.returnFreeForm?"true":"false"),this.strRequest=e,this.strRequest}},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger("Address"),this.logger.trace("[Constructeur Address ()]"),!(this instanceof n))throw new TypeError("Address constructor cannot be called as a function.");if(this.options=e||{location:{},type:["StreetAddress"],filter:{}},!e.location)throw new Error("l'option 'location' n'est pas renseign\xE9e !");for(var t in e)e.hasOwnProperty(t)&&(this.options[t]=e[t])}o.r(t);var a=o(37);n.prototype={constructor:n,requestString:null,template:{address:"<Address countryCode=\"__COUNTRYCODE__\">__LOCATION____PLACE____POSTALCODE____ENVELOPE__</Address>",location:{freeFormAddress:"<freeFormAddress>__FREEFORMADDRESSVALUE__</freeFormAddress>",streetAddress:{container:"<StreetAddress>__STREET____BUILDING__</StreetAddress>",building:"<Building number=\"__BUILDINGVALUE__\"/>",street:"<Street>__STREETVALUE__</Street>"}},place:"<Place type=\"__PLACETYPE__\">__PLACEVALUE__</Place>",postalCode:"<PostalCode>__POSTALCODEVALUE__</PostalCode>",envelope:"<gml:Envelope><gml:lowerCorner>__LEFT__ __BOTTOM__</gml:lowerCorner><gml:upperCorner>__RIGHT__ __TOP__</gml:upperCorner></gml:Envelope>"}},n.prototype.toString=function(){var e=null;if(e=this.template.address,e=e.replace(/__COUNTRYCODE__/g,this.options.type),"string"==typeof this.options.location){var t=this.template.location.freeFormAddress;t=t.replace(/__FREEFORMADDRESSVALUE__/g,this.options.location),e=e.replace(/__LOCATION__/g,t)}else{var o="",n="";this.options.location.number&&(o=this.template.location.streetAddress.building,o=o.replace(/__BUILDINGVALUE__/g,this.options.location.number)),this.options.location.street&&(n=this.template.location.streetAddress.street,n=n.replace(/__STREETVALUE__/g,this.options.location.street));var a=this.template.location.streetAddress.container;a=a.replace(/__STREET__/g,n),a=a.replace(/__BUILDING__/g,o),e=e.replace(/__LOCATION__/g,a)}var r="";this.options.location.postalCode&&(r=this.template.postalCode,r=r.replace(/__POSTALCODEVALUE__/g,this.options.location.postalCode));var s="";if(this.options.filter){var i=this.options.filter.bbox;i&&(s=this.template.envelope,s=s.replace(/__LEFT__/g,i.left),s=s.replace(/__BOTTOM__/g,i.bottom),s=s.replace(/__RIGHT__/g,i.right),s=s.replace(/__TOP__/g,i.top))}var l=[],d="";if(this.options.filter){var p=this.options.filter;for(var c in p)"bbox"!=c&&(d=this.template.place,d=d.replace(/__PLACETYPE__/g,c),d=d.replace(/__PLACEVALUE__/g,p[c]),l.push(d))}var u="";return this.options.location.city&&(u=this.template.place,u=u.replace(/__PLACETYPE__/g,"Municipality"),u=u.replace(/__PLACEVALUE__/g,this.options.location.city),l.push(u)),e=e.replace(/__POSTALCODE__/g,r),e=e.replace(/__PLACE__/g,l.join("\n")),e=e.replace(/__ENVELOPE__/g,s),this.requestString=e,this.requestString},t["default"]=n},function(e,t,o){"use strict";function n(){if(this.logger=a["default"].getLogger("GeocodeFilterExtension"),this.logger.trace("[Constructeur GeocodeFilterExtension ()]"),!(this instanceof n))throw new TypeError("GeocodeFilterExtension constructor cannot be called as a function.");this.filters=[]}o.r(t);var a=o(37);n.prototype={constructor:n,addFilterExtensions:function(e){e&&this.filters.push(e)},getNames:function(){var e=[];for(var t in this.filters)e.push(this.filters[t].CLASSNAME);return this.logger.trace(e),e},getFilter:function(e){var t=null;for(var o in this.filters)this.filters[o].CLASSNAME===e&&(t=this.filters[o]);return this.logger.trace(t),t},getFilters:function(){return this.logger.trace(this.filters),this.filters},getAttributs:function(e){var t=[];for(var o in this.filters)this.filters[o].CLASSNAME===e&&(t=this.filters[o].attributesList);return this.logger.trace(t),t},setPlaceAttributs:function(e,t){var o=this.getFilter(e),n=this.getAttributs(e);for(var a in n){var r=n[a];t[r]&&(o.placeAttributes[r]=t[r])}},getPlaceAttributs:function(e){var t={};for(var o in this.filters)this.filters[o].CLASSNAME===e&&(t=this.filters[o].placeAttributes);return this.logger.trace(t),t}},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur ReverseGeocodeRequest ()]"),!(this instanceof n))throw new TypeError("ReverseGeocodeRequest constructor cannot be called as a function.");for(var t in this.options=e||{},e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);this.CLASSNAME="ReverseGeocodeRequest"}o.r(t);var a=o(37),r=o(91),s=o(92);n.prototype={strRequest:null,oPosition:null,oPreference:null,constructor:n,template:"<ReverseGeocodeRequest returnFreeForm=\"__RETURNFREEFORM__\">__POSITION____PREFERENCE__</ReverseGeocodeRequest>",addPosition:function(e){e instanceof r["default"]&&(this.oPosition=e)},addPreferences:function(e){e instanceof s["default"]&&(this.oPreference=e)},toString:function(){var e="";if(e=this.template,!this.oPreference&&(this.oPreference=new s["default"](this.options.filterOptions.type||["StreetAddress"]),!this.oPreference))throw new Error("Les preferences ne sont pas definies !?");if(e=e.replace(/__PREFERENCE__/g,this.oPreference.toString()),!this.oPosition){var t={position:this.options.position,filter:{}};if(this.options.filterOptions&&(t.filter=this.options.filterOptions,delete t.filter.type),this.oPosition=new r["default"](t),!this.oPosition)throw new Error("La position et ses filtres ne sont pas definis !?")}return e=e.replace(/__POSITION__/g,this.oPosition.toString()),e=e.replace(/__RETURNFREEFORM__/g,this.options.returnFreeForm?"true":"false"),this.strRequest=e,this.strRequest}},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger("Position"),this.logger.trace("[Constructeur Position ()]"),!(this instanceof n))throw new TypeError("Position constructor cannot be called as a function.");if(this.options=e||{},!e.position)throw new Error("l'option 'position' n'est pas renseign\xE9e !");for(var t in e)e.hasOwnProperty(t)&&(this.options[t]=e[t])}o.r(t);var a=o(37);n.prototype={constructor:n,requestString:null,template:{position:"<Position>__GMLPOINT____GMLFILTER__</Position>",gml:{point:"<gml:Point xmlns:gml=\"http://www.opengis.net/gml\"><gml:pos>__X__ __Y__</gml:pos></gml:Point>",pos:null,filter:{bbox:"<gml:Envelope xmlns:gml=\"http://www.opengis.net/gml\"><gml:lowerCorner>__LEFT__ __BOTTOM__</gml:lowerCorner><gml:upperCorner>__RIGHT__ __TOP__</gml:upperCorner></gml:Envelope>",circle:"<gml:CircleByCenterPoint xmlns:gml=\"http://www.opengis.net/gml\"><gml:pos>__X__ __Y__</gml:pos><gml:radius>__RADIUS__</gml:radius></gml:CircleByCenterPoint>",polygon:"<gml:Polygon xmlns:gml=\"http://www.opengis.net/gml\"><gml:exterior><gml:LinearRing><gml:posList>__XY__</gml:posList></gml:LinearRing></gml:exterior></gml:Polygon>",multipolygon:null}}}},n.prototype.toString=function(){var e=this.template.position,t=this.template.gml.point;t=t.replace(/__X__/g,this.options.position.x),t=t.replace(/__Y__/g,this.options.position.y);var o="";if(this.options.filter){var n=this.options.filter;for(var a in n)switch(a){case"circle":o=this.template.gml.filter[a],o=o.replace(/__X__/g,n[a].x),o=o.replace(/__Y__/g,n[a].y),o=o.replace(/__RADIUS__/g,n[a].radius);break;case"bbox":o=this.template.gml.filter[a],o=o.replace(/__LEFT__/g,n[a].left),o=o.replace(/__BOTTOM__/g,n[a].bottom),o=o.replace(/__RIGHT__/g,n[a].right),o=o.replace(/__TOP__/g,n[a].top);break;case"polygon":o=this.template.gml.filter[a];for(var r="",s=n[a],l=0,d;l<s.length;l++){if(d=s[l],Array.isArray(d)){this.logger.error("Holes are not implemented !");break}(d.x&&d.y||0===d.x||0===d.y)&&(r+=d.x+" "+d.y),s.length!==l+1&&(r+=" ")}o=o.replace(/__XY__/g,r);break;case"multipolygon":this.logger.warn("Filter '"+a+"' is not yet implemented !");break;default:this.logger.error("This filter '"+a+"' is not useful !");}}return e=e.replace(/__GMLPOINT__/g,t),e=e.replace(/__GMLFILTER__/g,o),this.requestString=e,this.requestString},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger("Preference"),this.logger.trace("[Constructeur Preference ()]"),!(this instanceof n))throw new TypeError("Preference constructor cannot be called as a function.");this.type=e}o.r(t);var a=o(37);n.prototype={constructor:n,requestString:null,template:"<ReverseGeocodePreference>__TYPE__</ReverseGeocodePreference>"},n.prototype.toString=function(){for(var e=[],t="",o=0;o<this.type.length;o++)t=this.template,t=t.replace(/__TYPE__/g,this.type[o]),e.push(t);return this.strRequest=e.join("\n"),this.strRequest},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("StreetAddress constructor cannot be called as a function.");a["default"].apply(this,arguments),this.CLASSNAME="StreetAddress",this.attributesList=["bbox","ID","IDTR","quality","territory","commune","department","insee","municipality"],this.serviceAttributes=["bbox","ID","IDTR","Qualite","Territoire","Commune","Departement","INSEE","Municipality"]}o.r(t);var a=o(94);n.prototype=Object.create(a["default"].prototype),n.prototype.constructor=n,t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("GeocodeLocation constructor cannot be called as a function.");this.placeAttributes={},this.attributesList=[],this.serviceAttributes=[]}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("PositionOfInterest constructor cannot be called as a function.");a["default"].apply(this,arguments),this.CLASSNAME="PositionOfInterest",this.attributesList=["bbox","importance","nature","territory","commune","department","insee","municipality"],this.serviceAttributes=["bbox","Importance","Nature","Territoire","Commune","Departement","INSEE","Municipality"]}o.r(t);var a=o(94);n.prototype=Object.create(a["default"].prototype),n.prototype.constructor=n,t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("CadastralParcel constructor cannot be called as a function.");a["default"].apply(this,arguments),this.CLASSNAME="CadastralParcel",this.attributesList=["absorbedCity","sheet","number","section","commune","department","insee","municipality","origin"],this.serviceAttributes=["CommuneAbsorbee","Feuille","Numero","Section","Commune","Departement","INSEE","Municipality","Type"]}o.r(t);var a=o(94);n.prototype=Object.create(a["default"].prototype),n.prototype.constructor=n,t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("Administratif constructor cannot be called as a function.");a["default"].apply(this,arguments),this.CLASSNAME="Administratif",this.attributesList=["bbox","prefecture","inseeRegion","inseeDepartment","municipality"],this.serviceAttributes=["bbox","Prefecture","InseeRegion","InseeDepartement","Municipality"]}o.r(t);var a=o(94);n.prototype=Object.create(a["default"].prototype),n.prototype.constructor=n,t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(39),a=o(38),r=o(59),s=o(99);t["default"]={build:function(t){var o=null;if(!t.response)return void t.onError.call(t.scope,new n["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EMPTY"),type:n["default"].TYPE_SRVERR,status:-1}));if(t.rawResponse)o=t.response;else{try{var i=new r["default"]({reader:s["default"]});if("string"==typeof t.response?i.setXMLString(t.response):i.setXMLDoc(t.response),o=i.parse(),!o)throw new Error("L'analyse de la r\xE9ponse du service !?")}catch(o){var l=o.message;return l+="string"==typeof t.response?"('"+t.response+"')":"('"+t.response.documentElement.innerHTML+"')",void t.onError.call(t.scope,new n["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_ANALYSE",l),type:n["default"].TYPE_UNKERR,status:-1}))}if(o.exceptionReport)return void t.onError.call(t.scope,new n["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",o.exceptionReport),type:n["default"].TYPE_SRVERR,status:200}))}t.onSuccess.call(t.scope,o)}}},function(e,t,o){"use strict";function n(e){if(0<e.attributes.length){for(var t={},o=e.attributes,n=0,a;n<o.length;n++)a=o[n],t[a.nodeName]=a.nodeValue;return t}}function a(e,t){if(e.hasChildNodes())for(var o=e.childNodes,n=0,r,s,l;n<o.length;n++)if(r=o[n],1===r.nodeType)if(s=r.localName||r.baseName||r.nodeName,l=r.prefix||c.DEFAULTPREFIX,c.READERS[l][s]){var d=c.READERS[l][s];d(r,t)}else a(r,t)}function r(e){var t="",o;return e.hasChildNodes()&&(o=e.firstChild,3===o.nodeType&&(t=o.nodeValue)),t}function s(e){if(0<e.attributes.length){var t=n(e);for(var o in t)if(t.hasOwnProperty(o)){if("version"===o&&t.version!==c.VERSION)return void console.log("[DirectGeocodeResponseReader] geocode version is not the expected one : there may be errors in parsing");if("xmlns"===o){if(t[o]!==c.NAMESPACES[c.DEFAULTPREFIX])return void console.log("[DirectGeocodeResponseReader] geocode response default namespace is not the expected one");continue}var a=o.split(":")[0],r=o.split(":")[1];if("xmlns"===a&&r&&c.NAMESPACES[r]&&c.NAMESPACES[r]!==t[o])return void console.log("[DirectGeocodeResponseReader] geocode response "+o+" namespace is not the expected one");if("schemaLocation"===r&&c.SCHEMALOCATION!==t[o])return void console.log("[DirectGeocodeResponseReader] geocode response schema location is not the expected one")}}}o.r(t);var i=o(38),l=o(39),d=o(100),p=o(101),c={};c.VERSION="1.2",c.NAMESPACES={xmlns:"http://www.opengis.net/xls",gml:"http://www.opengis.net/gml",xls:"http://www.opengis.net/xls",xlsext:"http://www.opengis.net/xlsext",xsi:"http://www.w3.org/2001/XMLSchema-instance"},c.SCHEMALOCATION="http://wxs.ign.fr/schemas/olsAll.xsd",c.DEFAULTPREFIX="xls",c.READERS={xls:{XLS:function(e){var t=new d["default"];return s(e),a(e,t),t},GeocodedAddress:function(e,t){var o=new p["default"];a(e,o),t&&Array.isArray(t.locations)&&t.locations.push(o)},GeocodeMatchCode:function(e,t){var o=e.getAttribute("accuracy");o&&t&&(t.accuracy=parseFloat(o));var n=e.getAttribute("matchType");n&&t&&(t.matchType=n)},Address:function(e,t){var o=e.getAttribute("countryCode");t&&o&&(t.type=o),a(e,t)},freeFormAddress:function(e,t){t&&t.hasOwnProperty("placeAttributes")&&(t.placeAttributes.freeform=r(e))},Building:function(e,t){var o=e.getAttribute("number");t&&t.hasOwnProperty("placeAttributes")&&(o?t.placeAttributes.number=o:e.getAttribute("buildingName")?t.placeAttributes.number=e.getAttribute("buildingName"):e.getAttribute("subdivision")&&(t.placeAttributes.number=e.getAttribute("subdivision")))},Street:function(e,t){t&&t.hasOwnProperty("placeAttributes")&&("StreetAddress"===t.type?t.placeAttributes.street=r(e):"CadastralParcel"===t.type&&(t.placeAttributes.cadastralParcel=r(e)))},Place:function(e,t){var o=e.getAttribute("type"),n=r(e);if(t&&t.hasOwnProperty("placeAttributes"))if("Municipality"===o)t.placeAttributes.municipality=n;else if("Bbox"===o){var a=n.split(";");4===a.length&&(t.placeAttributes.bbox={left:parseFloat(a[0]),right:parseFloat(a[2]),top:parseFloat(a[1]),bottom:parseFloat(a[3])})}else"Commune"===o?t.placeAttributes.commune=n:"Departement"===o?t.placeAttributes.department=n:"INSEE"===o?t.placeAttributes.insee=n:"Qualite"===o?t.placeAttributes.quality=n:"Territoire"===o?t.placeAttributes.territory=n:"ID"===o?t.placeAttributes.ID=n:"ID_TR"===o?t.placeAttributes.IDTR=n:"Importance"===o?t.placeAttributes.importance=parseInt(n,10):"Nature"===o?t.placeAttributes.nature=n:"Numero"===o?t.placeAttributes.number=n:"Feuille"===o?t.placeAttributes.sheet=n:"Section"===o?t.placeAttributes.section=n:"CommuneAbsorbee"===o?t.placeAttributes.absorbedCity=n:"Arrondissement"===o?n&&(t.placeAttributes.arrondissement=n):"Type"===o?t.placeAttributes.origin=n:"Prefecture"===o?t.placeAttributes.prefecture=n:"InseeRegion"===o?t.placeAttributes.inseeRegion=n:"InseeDepartment"===o&&(t.placeAttributes.inseeDepartment=n)},PostalCode:function(e,t){t&&t.hasOwnProperty("placeAttributes")&&(t.placeAttributes.postalCode=r(e))},Error:function(e){var t=e.getAttribute("message"),o=e.getAttribute("errorCode"),n=i["default"].getMessage("SERVICE_RESPONSE_EXCEPTION","("+o+") : "+t);throw new l["default"]({message:n,type:l["default"].TYPE_SRVERR})}},gml:{pos:function(e,t){var o=r(e);t&&o&&(t.position={x:parseFloat(o.split(" ")[0]),y:parseFloat(o.split(" ")[1])})}},ExceptionReport:function(e){var t={};if(e.hasChildNodes())for(var o=e.childNodes,n=0,a;n<o.length;n++)a=o[n],"Exception"===a.nodeName&&(t.exceptionReport=c.READERS.Exception(a));return t},Exception:function(e){var t={},o=e.getAttribute("exceptionCode");o&&(t.exceptionCode=o);var n=e.firstChild;return n&&3===n.nodeType&&(t.exception=n.nodeValue),t}},c.read=function(e){if("XLS"===e.nodeName){var t=e.prefix;t||(t=c.DEFAULTPREFIX);var o=c.READERS[t][e.nodeName](e);return o}if("ExceptionReport"===e.nodeName){var n=c.READERS[e.nodeName](e);return n}var a=i["default"].getMessage("SERVICE_RESPONSE_ANALYSE",e.nodeName);throw new l["default"]({message:a,type:l["default"].TYPE_UNKERR,status:200})},t["default"]=c},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("GeocodeResponse constructor cannot be called as a function.");this.locations=[]}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("DirectGeocodedLocation constructor cannot be called as a function.");a["default"].apply(this,arguments),this.CLASSNAME="DirectGeocodedLocation",this.accuracy=null}o.r(t);var a=o(102);n.prototype=Object.create(a["default"].prototype),n.prototype.constructor=n,t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("GeocodedLocation constructor cannot be called as a function.");this.position={x:null,y:null},this.matchType=null,this.placeAttributes={},this.type=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError(r["default"].getMessage("CLASS_CONSTRUCTOR","ReverseGeocode"));if(this.CLASSNAME="ReverseGeocode",l["default"].apply(this,arguments),this.logger=a["default"].getLogger("Gp.Services.ReverseGeocode"),this.logger.trace("[Constructeur ReverseGeocode (options)]"),!e.position)throw new Error(r["default"].getMessage("PARAM_MISSING","position"));if(null===e.position.x)throw new Error(r["default"].getMessage("PARAM_MISSING","position.x"));if(null===e.position.y)throw new Error(r["default"].getMessage("PARAM_MISSING","position.y"));this.options.position=e.position,e.filterOptions&&"object"==typeof e.filterOptions||(this.options.filterOptions=e.filterOptions={type:["StreetAddress"]}),0===Object.keys(e.filterOptions).length&&(this.options.filterOptions={type:["StreetAddress"]});for(var t=Object.keys(e.filterOptions),o=0,s;o<t.length;o++)s=t[o],e.filterOptions[s]&&0!==Object.keys(e.filterOptions[s]).length||delete this.options.filterOptions[s];if(this.options.filterOptions.type=e.filterOptions.type||["StreetAddress"],!Array.isArray(this.options.filterOptions.type))throw new Error(r["default"].getMessage("PARAM_TYPE","filterOptions.type"));if(this.options.maximumResponses=e.maximumResponses||25,this.options.returnFreeForm=e.returnFreeForm||!1,this.options.srs=e.srs||"CRS:84",-1===n.geoEPSG.indexOf(this.options.srs)){if(this.options.position={x:this.options.position.y,y:this.options.position.x},this.options.filterOptions&&this.options.filterOptions.circle){var d=this.options.filterOptions.circle;this.options.filterOptions.circle={x:d.y,y:d.x,radius:d.radius}}if(this.options.filterOptions&&this.options.filterOptions.polygon){var p=this.options.filterOptions.polygon;for(o=0;o<p.length;o++){var c=p[o];this.options.filterOptions.polygon[o]={x:c.y,y:c.x}}}}this.options.outputFormat=this.options.rawResponse?"":"xml"}o.r(t);var a=o(37),r=o(38),s=o(39),l=o(40),d=o(104),p=o(105);n.prototype=Object.create(l["default"].prototype,{}),n.prototype.constructor=n,n.prototype.buildRequest=function(e,t){var o={httpMethod:this.options.httpMethod,position:this.options.position,returnFreeForm:this.options.returnFreeForm,filterOptions:this.options.filterOptions,srs:"EPSG:4326",maximumResponses:this.options.maximumResponses};this.request=d["default"].build(o),this.request?t.call(this,this.request):e.call(this,new s["default"](r["default"].getMessage("SERVICE_REQUEST_BUILD")))},n.prototype.analyzeResponse=function(e,t){if(this.response){var o={response:this.response,rawResponse:this.options.rawResponse,onError:e,onSuccess:t,scope:this};p["default"].build(o)}else e.call(this,new s["default"](r["default"].getMessage("SERVICE_RESPONSE_EMPTY")))},n.geoEPSG=["EPSG:4326"],t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(82),r=o(86);t["default"]={build:function(e){var t=n["default"].getLogger("ReverseGeocodeRequestFactory");t.trace(["ReverseGeocodeRequestFactory::build()"]);var o=e||{},s=null,i=new r["default"]({position:o.position,returnFreeForm:o.returnFreeForm,filterOptions:o.filterOptions}),l=new a["default"]({srsName:o.srs,maximumResponses:o.maximumResponses});if(l.namespace=!0,l.setService(i),s=l.build(),"GET"===o.httpMethod){var d="qxml="+encodeURIComponent(s).replace(/-/g,"%2D").replace(/_/g,"%5F").replace(/\./g,"%2E").replace(/!/g,"%21").replace(/~/g,"%7E").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29");s=d}return t.trace(s),s}}},function(e,t,o){"use strict";o.r(t);var n=o(38),a=o(39),r=o(59),s=o(106);t["default"]={build:function(t){var o=null;if(!t.response)return void t.onError.call(t.scope,new a["default"]({message:n["default"].getMessage("SERVICE_RESPONSE_EMPTY"),type:a["default"].TYPE_SRVERR,status:-1}));if(t.rawResponse)o=t.response;else{try{var l=new r["default"]({reader:s["default"]});if("string"==typeof t.response?l.setXMLString(t.response):l.setXMLDoc(t.response),o=l.parse(),!o)throw new Error("L'analyse de la r\xE9ponse du service !?")}catch(o){return o.status=200,void t.onError.call(t.scope,o)}if(o.exceptionReport)return void t.onError.call(t.scope,new a["default"]({message:n["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",o.exceptionReport),type:a["default"].TYPE_SRVERR,status:200}));if(t.scope&&t.scope.options&&t.scope.options.srs&&"EPSG:4326"!==t.scope.options.srs){var e,d;if(o||o.locations||o.locations.length)for(var p=0;p<o.locations.length;p++)e=o.locations[p],e&&(d=e.position,d&&(e.position={x:d.y,y:d.x}))}}t.onSuccess.call(t.scope,o)}}},function(e,t,o){"use strict";function n(e){if(0<e.attributes.length){for(var t={},o=e.attributes,n=0,a;n<o.length;n++)a=o[n],t[a.nodeName]=a.nodeValue;return t}}function a(e,t){if(e.hasChildNodes())for(var o=e.childNodes,n=0,r,s,l;n<o.length;n++)if(r=o[n],1===r.nodeType)if(s=r.localName||r.baseName||r.nodeName,l=r.prefix||c.DEFAULTPREFIX,c.READERS[l][s]){var d=c.READERS[l][s];d(r,t)}else a(r,t)}function r(e){var t="",o;return e.hasChildNodes()&&(o=e.firstChild,3===o.nodeType&&(t=o.nodeValue)),t}function s(e){if(0<e.attributes.length){var t=n(e);for(var o in t)if(t.hasOwnProperty(o)){if("version"===o&&t.version!==c.VERSION)return void console.log("[ReverseGeocodeResponseReader] geocode version is not the expected one : there may be errors in parsing");if("xmlns"===o){if(t[o]!==c.NAMESPACES[c.DEFAULTPREFIX])return void console.log("[ReverseGeocodeResponseReader] geocode response default namespace is not the expected one");continue}var a=o.split(":")[0],r=o.split(":")[1];if("xmlns"===a&&r&&c.NAMESPACES[r]&&c.NAMESPACES[r]!==t[o])return void console.log("[ReverseGeocodeResponseReader] geocode response "+o+" namespace is not the expected one");if("schemaLocation"===r&&c.SCHEMALOCATION!==t[o])return void console.log("[ReverseGeocodeResponseReader] geocode response schema location is not the expected one")}}}o.r(t);var i=o(38),l=o(39),d=o(100),p=o(107),c={};c.VERSION="1.2",c.NAMESPACES={xmlns:"http://www.opengis.net/xls",gml:"http://www.opengis.net/gml",xls:"http://www.opengis.net/xls",xlsext:"http://www.opengis.net/xlsext",xsi:"http://www.w3.org/2001/XMLSchema-instance"},c.SCHEMALOCATION="http://wxs.ign.fr/schemas/olsAll.xsd",c.DEFAULTPREFIX="xls",c.READERS={xls:{XLS:function(e){var t=new d["default"];return s(e),a(e,t),t},ReverseGeocodedLocation:function(e,t){var o=new p["default"];a(e,o),t&&Array.isArray(t.locations)&&t.locations.push(o)},Address:function(e,t){var o=e.getAttribute("countryCode");t&&o&&(t.type=o),a(e,t)},Building:function(e,t){var o=e.getAttribute("number");t&&t.hasOwnProperty("placeAttributes")&&(o?t.placeAttributes.number=o:e.getAttribute("buildingName")?t.placeAttributes.number=e.getAttribute("buildingName"):e.getAttribute("subdivision")&&(t.placeAttributes.number=e.getAttribute("subdivision")))},Street:function(e,t){"StreetAddress"===t.type?t.placeAttributes.street=r(e):"CadastralParcel"===t.type&&(t.placeAttributes.cadastralParcel=r(e))},Place:function(e,t){var o=e.getAttribute("type"),n=r(e);if(t&&t.hasOwnProperty("placeAttributes"))if("Municipality"===o)t.placeAttributes.municipality=n;else if("Bbox"===o){var a=n.split(";");4===a.length&&(t.placeAttributes.bbox={left:parseFloat(a[0]),right:parseFloat(a[2]),top:parseFloat(a[1]),bottom:parseFloat(a[3])})}else"Commune"===o?t.placeAttributes.commune=n:"Departement"===o?t.placeAttributes.department=n:"INSEE"===o?t.placeAttributes.insee=n:"Qualite"===o?t.placeAttributes.quality=n:"Territoire"===o?t.placeAttributes.territory=n:"ID"===o?t.placeAttributes.ID=n:"ID_TR"===o?t.placeAttributes.IDTR=n:"Importance"===o?t.placeAttributes.importance=parseInt(n,10):"Nature"===o?t.placeAttributes.nature=n:"Numero"===o?t.placeAttributes.number=n:"Feuille"===o?t.placeAttributes.sheet=n:"Section"===o?t.placeAttributes.section=n:"CommuneAbsorbee"===o?t.placeAttributes.absorbedCity=n:"Arrondissement"===o?n&&(t.placeAttributes.arrondissement=n):"Type"===o?t.placeAttributes.origin=n:"Prefecture"===o?t.placeAttributes.prefecture=n:"InseeRegion"===o?t.placeAttributes.inseeRegion=n:"InseeDepartment"===o&&(t.placeAttributes.inseeDepartment=n)},PostalCode:function(e,t){t&&t.hasOwnProperty("placeAttributes")&&(t.placeAttributes.postalCode=r(e))},SearchCentreDistance:function(e,t){t&&(t.searchCenterDistance=parseFloat(e.getAttribute("value")))},Error:function(e){var t=e.getAttribute("message"),o=e.getAttribute("errorCode"),n=i["default"].getMessage("SERVICE_RESPONSE_EXCEPTION","("+o+") : "+t);throw new l["default"]({message:n,type:l["default"].TYPE_SRVERR})}},gml:{pos:function(e,t){var o=r(e);t&&o&&(t.position={x:parseFloat(o.split(" ")[0]),y:parseFloat(o.split(" ")[1])})}},xlsext:{ExtendedGeocodeMatchCode:function(e,t){t&&(t.matchType=r(e))}},ExceptionReport:function(e){var t={};if(e.hasChildNodes())for(var o=e.childNodes,n=0,a;n<o.length;n++)a=o[n],"Exception"===a.nodeName&&(t.exceptionReport=c.READERS.Exception(a));return t},Exception:function(e){var t={},o=e.getAttribute("exceptionCode");o&&(t.exceptionCode=o);var n=e.firstChild;return n&&3===n.nodeType&&(t.exception=n.nodeValue),t}},c.read=function(e){if("XLS"===e.nodeName){var t=e.prefix;t||(t=c.DEFAULTPREFIX);var o=c.READERS[t][e.nodeName](e);return o}if("ExceptionReport"===e.nodeName){var n=c.READERS[e.nodeName](e);return n}throw new Error("Erreur lors de la lecture de la r\xE9ponse : elle n'est pas au format attendu.")},t["default"]=c},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("ReverseGeocodedLocation constructor cannot be called as a function.");a["default"].apply(this,arguments),this.CLASSNAME="ReverseGeocodedLocation",this.searchCenterDistance=null}o.r(t);var a=o(102);n.prototype=Object.create(a["default"].prototype),n.prototype.constructor=n,t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError(i["default"].getMessage("CLASS_CONSTRUCTOR","AutoComplete"));if(this.CLASSNAME="AutoComplete",a["default"].apply(this,arguments),this.logger=s["default"].getLogger("Gp.Services.AutoComplete"),this.logger.trace("[Constructeur AutoComplete (options)]"),!e.text)throw new Error(i["default"].getMessage("PARAM_MISSING","text"));this.options.text=e.text,e.filterOptions&&"object"==typeof e.filterOptions||(this.options.filterOptions=e.filterOptions={territory:[],type:["StreetAddress"]}),0===Object.keys(e.filterOptions).length&&(this.options.filterOptions={territory:[],type:["StreetAddress"]}),this.options.filterOptions.type=e.filterOptions.type||["StreetAddress"],this.options.filterOptions.territory=e.filterOptions.territory||[],this.options.maximumResponses=e.maximumResponses||10,"XHR"===this.options.protocol&&"POST"===this.options.httpMethod&&(this.logger.warn("Le service ne g\xE9re pas le mode d'interrogation en POST, on bascule sur du GET !"),this.options.httpMethod="GET"),this.options.outputFormat=this.options.rawResponse?"":"json"}o.r(t);var a=o(40),r=o(109),s=o(37),i=o(38),l=o(41),d=o(39);n.prototype=Object.create(a["default"].prototype,{}),n.prototype.constructor=n,n.prototype.buildRequest=function(e,t){var o="";this.options.filterOptions.territory&&(o=this.options.filterOptions.territory.join(";"));var n="";this.options.filterOptions.type&&(n=this.options.filterOptions.type.join(",")),this.request=l["default"].normalyzeParameters({text:encodeURIComponent(this.options.text),type:n,terr:o,maximumResponses:this.options.maximumResponses}),this.request?t.call(this,this.request):e.call(this,new d["default"](i["default"].getMessage("SERVICE_REQUEST_BUILD")))},n.prototype.analyzeResponse=function(e,t){if(this.response){var o={response:this.response,rawResponse:this.options.rawResponse,onSuccess:t,onError:e,scope:this};r["default"].build(o)}else e.call(this,new d["default"](i["default"].getMessage("SERVICE_RESPONSE_EMPTY")))},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(38),r=o(39),s=o(110),l=o(111);t["default"]={build:function(e){var t=n["default"].getLogger("AutoCompleteResponseFactory");t.trace(["AutoCompleteResponseFactory::build()"]);var o=null;if(!e.response)return void e.onError.call(e.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_EMPTY")));if(e.rawResponse)t.trace("analyze response : raw"),o=e.response;else{var d;if(d="string"==typeof e.response?JSON.parse(e.response):e.response,d){if(d.error)return void e.onError.call(e.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",d.error.description),status:d.error.code,type:r["default"].TYPE_SRVERR}));if(o=new s["default"],d.results&&Array.isArray(d.results))for(var p=0,c,u;p<d.results.length;p++)u=d.results[p],c=new l["default"],c&&(u&&"StreetAddress"===u.country?(c.street=u.street,c.type="StreetAddress"):u&&"PositionOfInterest"===u.country&&(c.poi=u.street,c.kind=u.kind,c.type="PositionOfInterest"),c.position&&(c.position.x=u.x,c.position.y=u.y),c.commune=u.city,c.fullText=u.fulltext,c.postalCode=u.zipcode,c.classification=u.classification),o.suggestedLocations.push(c);else return void e.onError.call(e.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_FORMAT_3")));if(!o.suggestedLocations.length)return void e.onError.call(e.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_FORMAT_3")))}if(!o)return void e.onError.call(e.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_ANALYSE_2"),type:r["default"].TYPE_UNKERR,status:-1}));if(o.exceptionReport)return void e.onError.call(e.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",o.exceptionReport),type:r["default"].TYPE_SRVERR,status:200}))}e.onSuccess.call(e.scope,o)}}},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("AutoCompleteResponse constructor cannot be called as a function.");this.suggestedLocations=[]}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("SuggestedLocation constructor cannot be called as a function.");this.type=null,this.position={x:null,y:null},this.commune=null,this.fullText=null,this.postalCode=null,this.classification=null,this.street=null,this.poi=null,this.kind=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError(r["default"].getMessage("CLASS_CONSTRUCTOR","Route"));if(this.CLASSNAME="Route",i["default"].apply(this,arguments),this.logger=a["default"].getLogger("Gp.Services.Route"),this.logger.trace("[Constructeur Route (options)]"),!e.startPoint)throw new Error(r["default"].getMessage("PARAM_MISSING","startPoint"));if(null===e.startPoint.x)throw new Error(r["default"].getMessage("PARAM_MISSING","startPoint.x"));if(null===e.startPoint.y)throw new Error(r["default"].getMessage("PARAM_MISSING","startPoint.y"));if(!e.endPoint)throw new Error(r["default"].getMessage("PARAM_MISSING","endPoint"));if(null===e.endPoint.x)throw new Error(r["default"].getMessage("PARAM_MISSING","endPoint.x"));if(null===e.endPoint.y)throw new Error(r["default"].getMessage("PARAM_MISSING","endPoint.y"));if(this.options.api="string"==typeof e.api?e.api.toUpperCase():"REST",this.options.outputFormat="string"==typeof e.outputFormat?e.outputFormat.toLowerCase():"json",this.options.startPoint=e.startPoint,this.options.endPoint=e.endPoint,this.options.viaPoints=e.viaPoints||null,this.options.exclusions=e.exclusions||null,this.options.routePreference=e.routePreference||"fastest",this.options.graph=e.graph||"Voiture",this.options.geometryInInstructions=e.geometryInInstructions||!1,this.options.provideBbox=e.provideBbox||!0,this.options.distanceUnit=e.distanceUnit||"km",this.options.expectedStartTime=null,this.options.srs=e.srs||"EPSG:4326",this.options.api="REST",this.logger.warn("Surcharge option 'api' : REST (readers OLS non impl\xE9ment\xE9s)"),"XHR"===this.options.protocol&&(this.options.httpMethod="GET",this.logger.trace("Surcharge option 'HttpMethod' : "+this.options.httpMethod)),!this.options.serverUrl){var t=l["default"].Route.url(this.options.apiKey),o=null;switch(this.options.api){case"OLS":o=t.ols;break;case"REST":var s="route-"+this.options.outputFormat;o=t[s];break;default:throw new Error(r["default"].getMessage("PARAM_UNKNOWN","api"));}if(!o)throw new Error("Url by default not found !");this.options.serverUrl=o,this.logger.trace("Serveur URL par defaut : "+this.options.serverUrl)}var d=this.options.serverUrl.lastIndexOf(".");if(-1!==d){var p=this.options.serverUrl.substring(d+1);if(p&&5>p.length)switch(this.logger.trace("Serveur Extension URL : "+p),p.toLowerCase()){case"json":case"xml":this.options.outputFormat=p.toLowerCase();break;default:throw new Error("type of service : unknown or unsupported (json or xml) !");}}}o.r(t);var a=o(37),r=o(38),s=o(39),i=o(40),l=o(49),d=o(113),p=o(121);n.prototype=Object.create(i["default"].prototype,{}),n.prototype.constructor=n,n.prototype.buildRequest=function(e,t){var o={api:this.options.api,startPoint:this.options.startPoint,endPoint:this.options.endPoint,viaPoints:this.options.viaPoints,provideBbox:this.options.provideBbox,exclusions:this.options.exclusions,distanceUnit:this.options.distanceUnit,graph:this.options.graph,geometryInInstructions:this.options.geometryInInstructions,routePreference:this.options.routePreference,srs:this.options.srs};this.request=d["default"].build(o),this.request?t.call(this,this.request):e.call(this,new s["default"](r["default"].getMessage("SERVICE_REQUEST_BUILD")))},n.prototype.analyzeResponse=function(e,t){if(this.response){var o={distanceUnit:this.options.distanceUnit,response:this.response,outputFormat:this.options.outputFormat,api:this.options.api,rawResponse:this.options.rawResponse,onError:e,onSuccess:t,scope:this};p["default"].build(o)}else e.call(this,new s["default"](r["default"].getMessage("SERVICE_RESPONSE_EMPTY")))},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(39),r=o(114),s=o(119);t["default"]={build:function(e){var t=n["default"].getLogger("RouteRequestFactory");t.trace(["RouteRequestFactory::build()"]);var o=null,i=e||{},l=!(null===e.onError||"function"!=typeof e.onError),d=null;switch(e.api){case"REST":var p=new s["default"](i);if(!p.processRequestString()){if(d="Error process request (rest) !",l)return void e.onError.call(e.scope,new a["default"](d));throw new Error(d)}o=p.requestString;break;case"OLS":if(o=r["default"].build(i),!o){if(d="Error process request (ols) !",l)return void e.onError.call(e.scope,new a["default"](d));throw new Error(d)}break;default:if(d="Type of API is not supported by service (REST or OLS) !",l)return void e.onError.call(e.scope,new a["default"](d));throw new Error(d);}return o}}},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(82),r=o(115);t["default"]={build:function(e){var t=n["default"].getLogger("RouteRequestOLS");t.trace(["RouteRequestOLS::build()"]);var o=null,s={startPoint:e.startPoint,endPoint:e.endPoint,viaPoint:e.viaPoints,provideBoundingBox:e.provideBbox,avoidFeature:e.exclusions,expectedStartTime:e.expectedStartTime,distanceUnit:e.distanceUnit,graph:e.graph,provideGeometry:e.geometryInInstructions,routePreference:e.routePreference},i=new r["default"](s),l=new a["default"]({srsName:e.srs,maximumResponses:e.maximumResponses});if(l.namespace=!0,l.setService(i),o=l.build(),"GET"===e.httpMethod){var d="qxml="+encodeURIComponent(o).replace(/-/g,"%2D").replace(/_/g,"%5F").replace(/\./g,"%2E").replace(/!/g,"%21").replace(/~/g,"%7E").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29");o=d}return o}}},function(e,t,o){"use strict";function n(){if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur RouteService ()]"),!(this instanceof n))throw new TypeError("RouteService constructor cannot be called as a function.");this.CLASSNAME="RouteService",this.CLASSTYPE="RouteRequest",r["default"].apply(this,arguments)}o.r(t);var a=o(37),r=o(85),s=o(116),i=o(118),l=o.n(i);n.prototype=Object.create(r["default"].prototype,{}),n.prototype.constructor=n,n.prototype.addRequest=function(e){if("DetermineRouteRequest"===e.CLASSNAME)this.oRequest=e;else throw new Error("Ce n'est pas un objet de type 'Route Request' !?")},n.prototype.addFilter=function(e){e instanceof l.a&&(this.oFilter=e)},n.prototype.toString=function(){if(!this.oRequest){if(!this.options)throw new Error("Les options ne sont pas renseign\xE9es, impossible de construire la requ\xEAte !");if("RouteRequest"===this.CLASSTYPE){var e={distanceUnit:this.options.distanceUnit||null,provideGeometry:this.options.provideGeometry||null,provideBoundingBox:this.options.provideBoundingBox||null,route:{routePreference:this.options.routePreference||null,startPoint:this.options.startPoint,viaPoint:this.options.viaPoint||null,endPoint:this.options.endPoint,avoidFeature:this.options.avoidFeature||null,graph:this.options.graph||null,expectedStartTime:this.options.expectedStartTime||null}};this.oRequest=new s["default"](e),this.oFilter&&this.oRequest.addFilter(this.oFilter)}}if(!this.oRequest)throw new Error("Type de requ\xEAte indefini !");return this.strRequest=this.oRequest.toString(),this.strRequest},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur DetermineRouteRequest ()]"),!(this instanceof n))throw new TypeError("DetermineRouteRequest constructor cannot be called as a function.");for(var t in this.options=e||{},e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);this.CLASSNAME="DetermineRouteRequest"}o.r(t);var a=o(37),r=o(117);n.prototype={strRequest:null,oRoutePlan:null,template:{determineRouteRequest:"<DetermineRouteRequest distanceUnit=\"__DISTANCEUNIT__\">__ROUTEPLAN____ROUTEINSTRUCTIONREQUEST____ROUTEGEOMETRYREQUEST____ROUTEMAPREQUEST__</DetermineRouteRequest>",routeInstructionRequest:"<RouteInstructionsRequest provideGeometry=\"__PROVIDEGEOMETRY__\" provideBoundingBox=\"__PROVIDEBBOX__\" />",routeGeometryRequest:"<RouteGeometryRequest />",routeMapRequest:""},addRoute:function(e){e instanceof r["default"]&&(this.oRoutePlan=e)},constructor:n,toString:function(){var e="";if(e=this.template.determineRouteRequest,e=e.replace(/__DISTANCEUNIT__/g,this.options.distanceUnit||"KM"),!this.oRoutePlan){var t=this.options.route;if(this.oRoutePlan=new r["default"](t),!this.oRoutePlan)throw new Error("La construction du calcul d'initineraire n'est pas correctement definie !?")}e=e.replace(/__ROUTEPLAN__/g,this.oRoutePlan.toString());var o=this.template.routeInstructionRequest;o=o.replace(/__PROVIDEGEOMETRY__/g,this.options.provideGeometry||!1),o=o.replace(/__PROVIDEBBOX__/g,this.options.provideBoundingBox||!1),e=e.replace(/__ROUTEINSTRUCTIONREQUEST__/g,o);var n=this.template.routeGeometryRequest;e=e.replace(/__ROUTEGEOMETRYREQUEST__/g,n);var a=this.template.routeMapRequest;return e=e.replace(/__ROUTEMAPREQUEST__/g,a),this.strRequest=e,this.strRequest}},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger("RoutePlan"),this.logger.trace("[Constructeur RoutePlan ()]"),!(this instanceof n))throw new TypeError("RoutePlan constructor cannot be called as a function.");if(this.options=e||{},!e.startPoint)throw new Error("l'option 'startPoint' n'est pas renseign\xE9e !");if(!e.endPoint)throw new Error("l'option 'endPoint' n'est pas renseign\xE9e !");for(var t in e)e.hasOwnProperty(t)&&(this.options[t]=e[t])}o.r(t);var a=o(37);n.prototype={constructor:n,requestString:null,template:{routePlan:"<RoutePlan>__ROUTEPREFERENCE____GRAPH____WAYPOINTLIST____AVOIDLIST__</RoutePlan>",routePreference:"<RoutePreference>__VALUEROUTEPREFERENCE__</RoutePreference>",graph:"<xlsext:graphName xmlns:xlsext=\"http://www.opengis.net/xlsext\" name=\"__VALUEGRAPH__\"/>",wayPointList:{container:"<WayPointList>__STARTPOINT____VIAPOINT____ENDPOINT__</WayPointList>",point:"<Position><gml:Point xmlns:gml=\"http://www.opengis.net/gml\"><gml:pos>__X__ __Y__</gml:pos></gml:Point></Position>",startPoint:"<StartPoint>__POINT__</StartPoint>",endPoint:"<EndPoint>__POINT__</EndPoint>",viaPoint:"<ViaPoint>__POINT__</ViaPoint>"},avoidList:{container:"<AvoidList>__AVOIDFEATURE__</AvoidList>",avoidFeature:"<AvoidFeature>__VALUEAVOIDFEATURE__</AvoidFeature>"}},toString:function(){var e="";if(e=this.template.routePlan,this.options.routePreference){var t=this.template.routePreference;t=t.replace(/__VALUEROUTEPREFERENCE__/,this.options.routePreference),e=e.replace(/__ROUTEPREFERENCE__/g,t)}if(e=e.replace(/__ROUTEPREFERENCE__/g,""),this.options.avoidFeature){for(var o=this.template.avoidList.container,n=[],a=0,r;a<this.options.avoidFeature.length;a++)r=this.template.avoidList.avoidFeature,r=r.replace(/__VALUEAVOIDFEATURE__/,this.options.avoidFeature[a]),n.push(r);o=o.replace(/__AVOIDFEATURE__/,n.join("\n")),e=e.replace(/__AVOIDLIST__/g,o)}if(e=e.replace(/__AVOIDLIST__/g,""),this.options.graph){var s=this.template.graph;s=s.replace(/__VALUEGRAPH__/,this.options.graph),e=e.replace(/__GRAPH__/g,s)}e=e.replace(/__GRAPH__/g,"");var l=this.template.wayPointList.container,d="";if(d=this.template.wayPointList.point,d=d.replace(/__X__/,this.options.startPoint.x),d=d.replace(/__Y__/,this.options.startPoint.y),l=l.replace(/__STARTPOINT__/,this.template.wayPointList.startPoint.replace(/__POINT__/,d)),d=this.template.wayPointList.point,d=d.replace(/__X__/,this.options.endPoint.x),d=d.replace(/__Y__/,this.options.endPoint.y),l=l.replace(/__ENDPOINT__/,this.template.wayPointList.endPoint.replace(/__POINT__/,d)),this.options.viaPoint){for(var c=[],u=0,m;u<this.options.viaPoint.length;u++)m=this.options.viaPoint[u],d=this.template.wayPointList.point,d=d.replace(/__X__/,m.x),d=d.replace(/__Y__/,m.y),c.push(d);l=l.replace(/__VIAPOINT__/,this.template.wayPointList.viaPoint.replace(/__POINT__/,c.join("\n")))}else l=l.replace(/__VIAPOINT__/,"");return e=e.replace(/__WAYPOINTLIST__/g,l),this.requestString=e,this.requestString}},t["default"]=n},function(){},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger("RouteRequestREST"),this.logger.trace("[Constructeur RouteRequestREST ()]"),!(this instanceof n))throw new TypeError("RouteRequestREST constructor cannot be called as a function.");if(!e)throw new Error(r["default"].getMessage("PARAM_EMPTY","options"));this.settings=e}o.r(t);var a=o(37),r=o(38),s=o(120);n.prototype={requestString:null,constructor:n,processRequestString:function(){this.logger.warn(" PROTOTYPE !");for(var e=new s["default"](this.settings),t=e.getParams(),n="",a=0,r;a<t.length;a++)r=t[a],n&&(n+="&"),n+=r.k+"="+r.v;return this.logger.trace(n),this.requestString=n,this.requestString}},t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError("RouteParamREST constructor cannot be called as a function.");if(this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur RouteParamREST ()]"),this.options=e||{},this.origin=this.options.startPoint.x+","+this.options.startPoint.y,this.destination=this.options.endPoint.x+","+this.options.endPoint.y,this.waypoints=this.options.viaPoints||null,this.startDateTime=this.options.expectedStartTime||null,this.graphName=this.options.graph,this.srs=this.options.srs,this.exclusions=this.options.exclusions,this.method="TIME",this.options.routePreference){var t=this.options.routePreference;"fastest"===t?this.method="TIME":"shortest"===t?this.method="DISTANCE":(this.logger.warn("Par defaut, on prend l'itin\xE9raire le plus rapide !"),this.method="TIME")}this.format=this.options.geometryInInstructions?"STANDARDEXT":"STANDARD",this.tolerance=10,this.profileId=null,this.profileName=null}o.r(t);var a=o(37);n.CLASSNAME="RouteParamREST",n.prototype={constructor:n,getWaypoints:function(){if(this.waypoints){for(var e=[],t=0,o;t<this.waypoints.length;t++)o=this.waypoints[t],e.push(o.x+","+o.y);return e.join(";")}},getExclusions:function(){return this.exclusions.join(";")}},n.prototype.getParams=function(){var e=[];return e.push({k:"origin",v:this.origin}),e.push({k:"destination",v:this.destination}),e.push({k:"method",v:this.method}),this.waypoints&&e.push({k:"waypoints",v:this.getWaypoints()}),this.startDateTime&&e.push({k:"startDateTime",v:this.startDateTime}),this.graphName&&e.push({k:"graphName",v:this.graphName}),this.exclusions&&e.push({k:"exclusions",v:this.getExclusions()}),this.srs&&e.push({k:"srs",v:this.srs}),this.format&&e.push({k:"format",v:this.format}),e},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(38),r=o(39),s=o(59),i=o(122),l=o(123),d=o(126),p=o(124),c=o(125);t["default"]={build:function(t){var o=n["default"].getLogger("RouteResponseFactory");o.trace("RouteResponseFactory::build()");var u=null;if(!t.response)return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_EMPTY")));if(t.rawResponse)o.trace("analyze response : raw"),u=t.response;else{switch(t.outputFormat){case"xml":o.trace("analyze response : xml");var m="REST"===t.api?l["default"]:d["default"];try{var g=new s["default"]({reader:m});if("string"==typeof t.response?g.setXMLString(t.response):g.setXMLDoc(t.response),u=g.parse(),!u)throw new r["default"](a["default"].getMessage("SERVICE_RESPONSE_FORMAT","xml"))}catch(o){return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_ANALYSE",t.response)))}break;case"json":o.trace("analyze response : json");var e;if(e="string"==typeof t.response?JSON.parse(t.response):t.response,e.message)return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",e.message)));if(e){var f=[],y=[],_=[];if(u=new p["default"],u.hasOwnProperty("totalTime")&&(u.totalTime=parseFloat(e.durationSeconds)),u.hasOwnProperty("totalDistance")&&(u.totalDistance="m"===t.distanceUnit?e.distanceMeters:e.distance),u.hasOwnProperty("bbox")){var E=e.bounds.split(/[,;]/);u.bbox.left=parseFloat(E[0]),u.bbox.bottom=parseFloat(E[1]),u.bbox.right=parseFloat(E[2]),u.bbox.top=parseFloat(E[3])}var h=function(e){u.routeGeometry=e},b=function(o){console.log(o),t.onError.call(t.scope,new r["default"](a["default"].getMessage("PARAM_FORMAT",["geometryWkt"])))};if(u.hasOwnProperty("routeGeometry")){var S=e.geometryWkt||e.simplifiedWkt;if(S&&(i["default"].toJson(S,h,b),!u.routeGeometry))return}if(u.hasOwnProperty("routeInstructions")){var P=e.legs,R;if(Array.isArray(P)&&P.length)for(R=0;R<P.length;R++)f.push(P[R]);if(Array.isArray(f)&&f.length)for(R=0;R<f.length;R++)y.push(f[R].steps);if(Array.isArray(y)&&y.length)for(R=0;R<y.length;R++)_=_.concat(y[R]);_.forEach(function(e){u.routeInstructions.push(new c["default"]),u.routeInstructions[u.routeInstructions.length-1].duration=e.durationSeconds,u.routeInstructions[u.routeInstructions.length-1].distance="m"===t.distanceUnit?e.distanceMeters:e.distance,u.routeInstructions[u.routeInstructions.length-1].code=e.navInstruction;for(var o=[],n=0,a;n<e.points.length;n++)a=e.points[n].split(","),a&&o.push(a);switch(u.routeInstructions[u.routeInstructions.length-1].geometry=o&&0!==o.length?{coordinates:o,type:"LineString"}:null,"Valeur non renseign\xE9e"===e.name&&(e.name=""),e.navInstruction){case"F":u.routeInstructions[u.routeInstructions.length-1].instruction=e.name?"Tout droit "+e.name:"Continuer tout droit ";break;case"B":u.routeInstructions[u.routeInstructions.length-1].instruction="Demi-tour "+e.name;break;case"L":u.routeInstructions[u.routeInstructions.length-1].instruction="Tourner \xE0 gauche "+e.name;break;case"R":u.routeInstructions[u.routeInstructions.length-1].instruction="Tourner \xE0 droite "+e.name;break;case"BL":u.routeInstructions[u.routeInstructions.length-1].instruction="Tourner tr\xE8s \xE0 gauche "+e.name;break;case"BR":u.routeInstructions[u.routeInstructions.length-1].instruction="Tourner tr\xE8s \xE0 droite "+e.name;break;case"FL":u.routeInstructions[u.routeInstructions.length-1].instruction="Tourner l\xE9g\xE8rement \xE0 gauche "+e.name;break;case"FR":u.routeInstructions[u.routeInstructions.length-1].instruction="Tourner l\xE9g\xE8rement \xE0 droite "+e.name;break;case"round_about_entry":u.routeInstructions[u.routeInstructions.length-1].instruction="Entr\xE9e rond-point "+e.name;break;case"round_about_exit":u.routeInstructions[u.routeInstructions.length-1].instruction="Sortie rond-point "+e.name;break;case null:u.routeInstructions[u.routeInstructions.length-1].instruction="Prendre tout droit "+e.name;break;default:u.routeInstructions[u.routeInstructions.length-1].instruction="?"+e.navInstruction+"? "+e.name;}})}}if(!u)return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_ANALYSE","json")));break;default:return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_FORMAT","json","xml")));}if(u&&u.exceptionReport)return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION_2")))}t.onSuccess.call(t.scope,u)}}},function(e,t,o){"use strict";o.r(t);var n=o(37);t["default"]={toJson:function(e,t,o){var a=n["default"].getLogger(),r=null;try{if(!e)throw new Error("La chaine WKT n'est pas renseign\xE9e !");t||(t=function(e){console.log(e)}),o||(o=function(t){console.log(t)});var s,i;if(s=/(-?\d+\.?[0-9]*)\s(-?\d+\.?[0-9]+)/g,i="[$1,$2]",e=e.replace(s,i),s=/^(\w+)/,s.exec(e),"POLYGON"===RegExp.$1?(i="{\"type\" : \"Polygon\",",e=e.replace(RegExp.$1,i),s=/(\({2}?)/,i="\"coordinates\" : [[",e=e.replace(s,i),s=/(\){2}?)/,i="]]}",e=e.replace(s,i),s=/(\()/g,i="[",e=e.replace(s,i),s=/(\))/g,i="]",e=e.replace(s,i)):"LINESTRING"===RegExp.$1&&(i="{\"type\" : \"LineString\",",e=e.replace(RegExp.$1,i),s=/(\(\(?)/,i="\"coordinates\" : [",e=e.replace(s,i),s=/(\)\)?)/,i="]}",e=e.replace(s,i)),a.trace(e),r=JSON.parse(e),!r)throw new Error("Le JSON est vide !");if(!r.type)throw new Error("Le type de geometrie n'est pas connu !");if(!r.coordinates)throw new Error("La liste des points est vide !");t.call(this,r)}catch(t){if("SyntaxError"===t.name)return void o.call(this,"Erreur de parsing JSON !");o.call(this,t)}}}},function(e,t,o){"use strict";function n(e){var t="",o;return e.hasChildNodes()&&(o=e.firstChild,o&&3===o.nodeType&&(t=o.nodeValue)),t}function a(e,t){if(e.hasChildNodes())for(var o=e.childNodes,n=0,r,s;n<o.length;n++)if(r=o[n],1===r.nodeType)if(s=r.localName||r.baseName||r.nodeName,p.READERS[s]){var l=p.READERS[s];l(r,t)}else a(r,t)}o.r(t);var r=o(38),s=o(122),i=o(39),l=o(124),d=o(125),p={};p.READERS={routeResult:function(e){var t=new l["default"];if(a(e,t),"error"===t.status){var o=r["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",t.message);throw new i["default"]({message:o,type:i["default"].TYPE_SRVERR})}return t},status:function(e,t){var o=n(e);("ERROR"===o||"error"===o)&&t&&(t.status="error")},message:function(e,t){t&&(t.message=n(e))},distance:function(e,t){t&&(t.totalDistance=n(e))},durationSeconds:function(e,t){t&&(t.totalTime=parseFloat(n(e)))},bounds:function(e,t){if(t&&t.bbox){var o=n(e).split(/[,;]/);t.bbox.left=parseFloat(o[0]),t.bbox.bottom=parseFloat(o[1]),t.bbox.right=parseFloat(o[2]),t.bbox.top=parseFloat(o[3])}},geometryWkt:function(e,t){if(t){var o=e.innerHTML,n=function(e){t.routeGeometry=e},a=function(){var e=r["default"].getMessage("PARAM_FORMAT",["geometryWkt"]);throw new Error(e)};s["default"].toJson(o,n,a)}},step:function(e,t){var o=new d["default"],a;if(e.hasChildNodes)for(var r=e.childNodes,s=0,l,p;s<r.length;s++)l=r[s],1===l.nodeType&&(p=l.localName||l.baseName||l.nodeName,"durationSeconds"===p?o.duration=n(l):"distance"===p?o.distance=n(l):"navInstruction"===p?o.code=n(l):"name"===p&&(a=n(l)));if(o.code)switch(o.code){case"F":o.instruction="Valeur non renseign\xE9e"===a?"Continuer tout droit ":"Tout droit "+a;break;case"B":o.instruction="Demi-tour "+a;break;case"L":o.instruction="Tourner \xE0 gauche "+a;break;case"R":o.instruction="Tourner \xE0 droite "+a;break;case"BL":o.instruction="Tourner tr\xE8s \xE0 gauche "+a;break;case"BR":o.instruction="Tourner tr\xE8s \xE0 droite "+a;break;case"FL":o.instruction="Tourner l\xE9g\xE8rement \xE0 gauche "+a;break;case"FR":o.instruction="Tourner l\xE9g\xE8rement \xE0 droite "+a;break;case"round_about_entry":o.instruction="Entr\xE9e rond-point "+a;break;case"round_about_exit":o.instruction="Sortie rond-point "+a;break;case null:o.instruction="Prendre "+a;break;default:o.instruction="?"+o.code+"? "+a;}Array.isArray(t.routeInstructions)&&t.routeInstructions.push(o)}},p.read=function(e){var t;if("routeResult"===e.nodeName)return t=p.READERS.routeResult(e),t;throw new Error("Erreur lors de la lecture de la r\xE9ponse : elle n'est pas au format attendu.")},t["default"]=p},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("RouteResponse constructor cannot be called as a function.");this.totalTime=null,this.totalDistance=null,this.bbox={left:null,right:null,top:null,bottom:null},this.routeGeometry=null,this.routeInstructions=[]}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("RouteInstruction constructor cannot be called as a function.");this.duration=null,this.distance=null,this.code=null,this.instruction=null,this.geometry=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(37),a={};a.READERS={},a.read=function(){var e=n["default"].getLogger("RouteResponseOLSReader");e.error("not yet implemented !")},t["default"]=a},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError(r["default"].getMessage("CLASS_CONSTRUCTOR","ProcessIsoCurve"));if(this.CLASSNAME="ProcessIsoCurve",i["default"].apply(this,arguments),this.logger=a["default"].getLogger("Gp.Services.ProcessIsoCurve"),this.logger.trace("[Constructeur ProcessIsoCurve (options)]"),!e.position)throw new Error(r["default"].getMessage("PARAM_MISSING","position"));if(null===e.position.x)throw new Error(r["default"].getMessage("PARAM_MISSING","position.x"));if(null===e.position.y)throw new Error(r["default"].getMessage("PARAM_MISSING","position.y"));if(!e.time&&!e.distance)throw new Error("Parameter (s) 'distance' missing. Parameter time to calculate an isochrone, parameter distance for an isodistance");if(!e.time&&e.distance&&(this.options.method="distance",this.options.time&&delete this.options.time),e.time&&!e.distance&&(this.options.method="time",this.options.distance&&delete this.options.distance),this.options.method=this.options.method||"time",this.options.exclusions=e.exclusions||null,this.options.graph=e.graph||"Voiture",this.options.reverse=e.reverse||!1,this.options.smoothing=e.smoothing||!1,this.options.holes=e.holes||!1,this.options.srs=e.srs||"EPSG:4326",this.options.outputFormat="string"==typeof e.outputFormat?e.outputFormat.toLowerCase():"json",!this.options.serverUrl){var t=l["default"].ProcessIsoCurve.url(this.options.apiKey),o=t["iso-"+this.options.outputFormat];if(!o)throw new Error("Url by default not found !");this.options.serverUrl=o,this.logger.trace("Serveur URL par defaut : "+this.options.serverUrl)}var s=this.options.serverUrl.lastIndexOf(".");if(-1!==s){var d=this.options.serverUrl.substring(s+1);if(d&&5>d.length)switch(this.logger.trace("Serveur Extension URL : "+d),d.toLowerCase()){case"json":case"xml":this.options.outputFormat=d.toLowerCase();break;default:throw new Error("type of service : unknown or unsupported (json or xml) !");}}}o.r(t);var a=o(37),r=o(38),s=o(39),i=o(40),l=o(49),d=o(128),p=o(130);n.prototype=Object.create(i["default"].prototype,{}),n.prototype.constructor=n,n.prototype.buildRequest=function(t,o){try{var n=new d["default"](this.options);if(!n.processRequestString())throw new Error(r["default"].getMessage("SERVICE_REQUEST_BUILD"));this.request=n.requestString}catch(o){return void t.call(this,new s["default"](o.message))}o.call(this,this.request)},n.prototype.analyzeResponse=function(e,t){if(this.response){var o={response:this.response,outputFormat:this.options.outputFormat,rawResponse:this.options.rawResponse,onSuccess:t,onError:e,scope:this};p["default"].build(o)}else e.call(this,new s["default"](r["default"].getMessage("SERVICE_RESPONSE_EMPTY")))},t["default"]=n},function(e,t,o){"use strict";function n(e){if(this.logger=a["default"].getLogger("ProcessIsoCurveRequest"),this.logger.trace("[Constructeur ProcessIsoCurveRequest ()]"),!(this instanceof n))throw new TypeError("ProcessIsoCurveRequest constructor cannot be called as a function.");if(!e)throw new Error(r["default"].getMessage("PARAM_EMPTY","options"));this.settings=e,this.mode=this.settings.httpMethod||"GET"}o.r(t);var a=o(37),r=o(38),s=o(129);n.prototype={requestString:null,constructor:n,template:{container:"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<isochroneRequest>\n__ID__\t<location>\n\t\t<x>__X__</x>\n\t\t<y>__Y__</y>\n\t</location>\n\t<srs>__SRS__</srs>\n\t<graphName>__GRAPHNAME__</graphName>\n__PROFIL____EXCLUSIONS__\t<method>__METHOD__</method>\n__TIME____DISTANCE__\t<reverse>__REVERSE__</reverse>\n\t<smoothing>__SMOOTHING__</smoothing>\n\t<holes>__HOLES__</holes>\n</isochroneRequest>",id:"\t<id>__IDVALUE__</id>\n",profil:"\t<profileId>__PROFILID__</profileId>\n\t<profileName>__PROFILNAME__</profileName>\n",exclusions:{container:"\t<exclusions>\n__EXCLUSIONFEATURE__\n\t</exclusions>\n",feature:"\t\t<exclusion>__EXCLUSIONVALUE__</exclusion>"},time:"\t<time>__TIMEVALUE__</time>\n",distance:"\t<distance>__DISTANCEVALUE__</distance>\n"},processRequestString:function(){var e="",t=0;switch(this.mode){case"GET":this.logger.trace("Process GET Request");var n=new s["default"](this.settings),a=n.getParams();for(t=0;t<a.length;t++){var r=a[t];e&&(e+="&"),e+=r.k+"="+r.v}break;case"POST":if(this.logger.trace("Process POST Request"),e=this.template.container,e=e.replace(/__ID__/g,""),e=e.replace(/__PROFIL__/g,""),e=e.replace(/__X__/g,this.settings.position.x),e=e.replace(/__Y__/g,this.settings.position.y),e=e.replace(/__GRAPHNAME__/g,this.settings.graph),e=e.replace(/__SRS__/g,this.settings.srs),e=e.replace(/__SMOOTHING__/g,this.settings.smoothing),e=e.replace(/__HOLES__/g,this.settings.holes),e=e.replace(/__REVERSE__/g,this.settings.reverse),this.settings.exclusions){var o=this.template.exclusions.container,l=[];for(t=0;t<this.settings.exclusions.length;t++){var d=this.template.exclusions.feature;d=d.replace(/__EXCLUSIONVALUE__/,this.settings.exclusions[t]),l.push(d)}o=o.replace(/__EXCLUSIONFEATURE__/,l.join("\n")),e=e.replace(/__EXCLUSIONS__/g,o)}if(e=e.replace(/__EXCLUSIONS__/g,""),this.settings.distance){var p=this.template.distance;p=p.replace(/__DISTANCEVALUE__/g,this.settings.distance),e=e.replace(/__DISTANCE__/g,p),e=e.replace(/__METHOD__/g,"distance")}if(e=e.replace(/__DISTANCE__/g,""),this.settings.time){var c=this.template.time;c=c.replace(/__TIMEVALUE__/g,this.settings.time),e=e.replace(/__TIME__/g,c),e=e.replace(/__METHOD__/g,"time")}e=e.replace(/__TIME__/g,"");break;default:this.logger.error("No other HTTP method supported by the service !");}return this.logger.trace(e),this.requestString=e,this.requestString}},t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError("ProcessIsoCurveParam constructor cannot be called as a function.");this.logger=a["default"].getLogger(),this.logger.trace("[Constructeur ProcessIsoCurveParam ()]"),this.options=e||{},this.id=this.options.id,this.location=this.options.position,this.srs=this.options.srs,this.graphName=this.options.graph,this.profileId=this.options.profileId||null,this.profileName=this.options.profileName||null,this.exclusions=this.options.exclusions,this.reverse=this.options.reverse,this.smoothing=this.options.smoothing,this.holes=this.options.holes;var t=this.options.method;"time"===t?(this.method="time",this.time=this.options.time):"distance"===t?(this.method="distance",this.distance=this.options.distance):(this.logger.warn("Par defaut, on calcule un isochrone !"),this.method="time")}o.r(t);var a=o(37);n.CLASSNAME="ProcessIsoCurveParam",n.prototype={constructor:n,getLocation:function(){return this.location.x+","+this.location.y},getExclusions:function(){return this.exclusions.join(";")}},n.prototype.getParams=function(){var e=[];return e.push({k:"location",v:this.getLocation()}),e.push({k:"smoothing",v:this.smoothing}),e.push({k:"holes",v:this.holes}),e.push({k:"reverse",v:this.reverse}),e.push({k:"method",v:this.method}),this.time&&e.push({k:"time",v:this.time}),this.distance&&e.push({k:"distance",v:this.distance}),e.push({k:"graphName",v:this.graphName}),this.exclusions&&e.push({k:"exclusions",v:this.getExclusions()}),this.srs&&e.push({k:"srs",v:this.srs}),e},t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(37),a=o(38),r=o(39),s=o(59),i=o(122),l=o(131),d=o(132);t["default"]={build:function(t){var o=n["default"].getLogger("ProcessIsoCurveResponseFactory");o.trace(["ProcessIsoCurveResponseFactory::build()"]);var c=null;if(!t.response)return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_EMPTY")));if(t.rawResponse)o.trace("analyze response : raw"),c=t.response;else{switch(t.outputFormat){case"xml":o.trace("analyze response : xml");try{var u=new s["default"]({reader:l["default"]});if("string"==typeof t.response?u.setXMLString(t.response):u.setXMLDoc(t.response),c=u.parse(),!c)throw new Error(a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION_2"))}catch(o){var p=o.message;return p+="\n (raw response service : '"+t.response+"')",void t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",p),status:200,type:r["default"].TYPE_SRVERR}))}break;case"json":o.trace("analyze response : json");var m;if(m="string"==typeof t.response?JSON.parse(t.response):t.response,"OK"===m.status||"ok"===m.status){if(c=new d["default"],c){c.time=m.time,c.distance=m.distance,c.message=m.message,c.id=m.id,c.srs=m.srs;var g=function(e){c.geometry=e},f=function(){t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("PARAM_FORMAT","wktGeometry")}))};if(c.hasOwnProperty("geometry")&&(i["default"].toJson(m.wktGeometry,g,f),!c.geometry))return;var y=m.location.split(",");c.location&&(c.location.x=y[0],c.location.y=y[1])}else return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_ANALYSE",t.response)));}else if("ERROR"===m.status||"error"===m.status){var _=m.message;return _+="\n (raw response service : '"+m+"')",void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",_)))}break;default:return void t.onError.call(t.scope,new r["default"](a["default"].getMessage("SERVICE_RESPONSE_FORMAT","json","xml")));}if(c&&c.exceptionReport)return void t.onError.call(t.scope,new r["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",c.exceptionReport),type:r["default"].TYPE_SRVERR,status:200}))}t.onSuccess.call(t.scope,c)}}},function(e,t,o){"use strict";function n(e){var t="",o;return e.hasChildNodes()&&(o=e.firstChild,o&&3===o.nodeType&&(t=o.nodeValue)),t}o.r(t);var a=o(38),r=o(122),s=o(39),l=o(132),d={};d.READERS={isochronResult:function(e){var t=new l["default"];if(e.hasChildNodes())for(var o=e.childNodes,n=0,r;n<o.length;n++)r=o[n],d.READERS[r.nodeName]&&d.READERS[r.nodeName](r,t);if("error"===t.status){var p=a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",t.message);throw new s["default"]({message:p,type:s["default"].TYPE_SRVERR})}return t},message:function(e,t){t&&(t.message=n(e))},status:function(e,t){var o=n(e);("ERROR"===o||"error"===o)&&t&&(t.status="error")},id:function(e,t){t&&(t.id=n(e))},location:function(e,t){var o=n(e);t&&t.location&&(t.location.x=parseFloat(o.split(",")[0]),t.location.y=parseFloat(o.split(",")[1]))},srs:function(e,t){t&&(t.srs=n(e))},distance:function(e,t){t&&(t.distance=parseFloat(n(e)))},time:function(e,t){t&&(t.time=parseFloat(n(e)))},wktGeometry:function(e,t){if(t){var o=e.innerHTML,n=function(e){t.geometry=e},s=function(){var e=a["default"].getMessage("PARAM_FORMAT",["wktGeometry"]);throw new Error(e)};t.hasOwnProperty("geometry")&&r["default"].toJson(o,n,s)}},serviceResult:function(e){var t={};if(e.hasChildNodes())for(var o=e.childNodes,n=0,a;n<o.length;n++)a=o[n],d.READERS[a.nodeName]&&d.READERS[a.nodeName](a,t);return t},ExceptionReport:function(e){var t={};if(e.hasChildNodes())for(var o=e.childNodes,n=0,a;n<o.length;n++)a=o[n],"Exception"===a.nodeName&&(t.exceptionReport=d.READERS.Exception(a));return t},Exception:function(e){var t={},o=e.getAttribute("exceptionCode");o&&(t.exceptionCode=o);var n=e.firstChild;return n&&3===n.nodeType&&(t.exception=n.nodeValue),t}},d.read=function(e){var t;if("isochronResult"===e.nodeName||"isochroneResult"===e.nodeName||"IsochroneResult"===e.nodeName)return t=d.READERS.isochronResult(e),t;if("ExceptionReport"===e.nodeName)return t=d.READERS[e.nodeName](e),t;if(d.READERS[e.nodeName]){if(t=d.READERS[e.nodeName](e),"error"===t.status){var o=a["default"].getMessage("SERVICE_RESPONSE_EXCEPTION",t.message);throw new s["default"]({message:o,type:s["default"].TYPE_SRVERR})}return t}throw new s["default"]({message:a["default"].getMessage("SERVICE_RESPONSE_ANALYSE",e.nodeName),type:s["default"].TYPE_UNKERR})},t["default"]=d},function(e,t,o){"use strict";function n(){if(!(this instanceof n))throw new TypeError("ProcessIsoCurveResponse constructor cannot be called as a function.");this.message=null,this.id=null,this.location={},this.location.x=null,this.location.y=null,this.srs=null,this.geometry=null,this.time=null,this.distance=null}o.r(t),n.prototype={constructor:n},t["default"]=n},function(e,t,o){"use strict";function n(e,t,o){(!e.style.position||o&o.position)&&(e.style.position=o&&o.position?o.position:"relative");var a=document.createElement("div");a.style.width="100%",a.style.height="100%",e.appendChild(a),this._viewerDiv=e,this._widgets=[],this._initEventMap(),this._isInitialized=!1,this._globeView=new r.GlobeView(a,t,o);var s=this;this.listen(n.EVENTS.GLOBE_INITIALIZED,function(){s._isInitialized=!0}),this._globeView.addFrameRequester(r.MAIN_LOOP_EVENTS.BEFORE_RENDER,function(){clearTimeout(this._preRenderTimer),s._preRenderTimer=setTimeout(function(){for(var e=[],t=[],o=0;o<s.getGlobeView().tileLayer.info.displayed.layers.length;++o)s.getGlobeView().tileLayer.info.displayed.layers[o].isColorLayer&&e.push(s.getGlobeView().tileLayer.info.displayed.layers[o].id),s.getGlobeView().tileLayer.info.displayed.layers[o].isElevationLayer&&t.push(s.getGlobeView().tileLayer.info.displayed.layers[o].id);var a=s.getGlobeView().tileLayer.info.displayed.extent;s._globeView.dispatchEvent({type:n.EVENTS.PRE_RENDER,colorLayersId:e,elevationLayersId:t,extent:a})},100)}.bind(this)),this._globeView.controls&&this.freezeControl()}o.r(t);var a=o(32),r=o(134),s=o.n(r),i=a["default"].getLogger("GlobeViewExtended");n.prototype._initEventMap=function(){n.EVENTS||(n.EVENTS={RANGE_CHANGED:r.CONTROL_EVENTS.RANGE_CHANGED,CENTER_CHANGED:r.CONTROL_EVENTS.CAMERA_TARGET_CHANGED,ORIENTATION_CHANGED:r.CONTROL_EVENTS.ORIENTATION_CHANGED,LAYER_ADDED:r.GLOBE_VIEW_EVENTS.LAYER_ADDED,LAYER_REMOVED:r.GLOBE_VIEW_EVENTS.LAYER_REMOVED,LAYERS_ORDER_CHANGED:r.GLOBE_VIEW_EVENTS.COLOR_LAYERS_ORDER_CHANGED,GLOBE_INITIALIZED:r.GLOBE_VIEW_EVENTS.GLOBE_INITIALIZED,LAYERS_INITIALIZED:r.VIEW_EVENTS.LAYERS_INITIALIZED,VIEW_INITIALIZED:"viewinitialized",PRE_RENDER:"prerender",MOUSE_MOVE:"mousemove",AFTER_RENDER:r.MAIN_LOOP_EVENTS.AFTER_RENDER,OPACITY_PROPERTY_CHANGED:"opacity-property-changed",VISIBLE_PROPERTY_CHANGED:"visible-property-changed",SEQUENCE_PROPERTY_CHANGED:"sequence-property-changed"})},n.prototype.constructor=n,n.prototype.getGlobeView=function(){return this._globeView},n.prototype.isInitialized=function(){return this._isInitialized},n.prototype.onCameraMoveStop=function(e){function t(){o._globeView.removeFrameRequester(r.MAIN_LOOP_EVENTS.AFTER_CAMERA_UPDATE,t),e()}var o=this;this._globeView.addFrameRequester(r.MAIN_LOOP_EVENTS.AFTER_CAMERA_UPDATE,t)},n.prototype.freezeControl=function(){this._globeView.controls.enabled=!1,this.onCameraMoveStop(function(){this._globeView.controls.enabled=!0}.bind(this))},n.prototype.listen=function(e,t){if("function"!=typeof t)return i.warn("no callback provided for event : "+e),null;var o=this._getEventTarget(e);return o?(e===n.EVENTS.AFTER_RENDER?o.addFrameRequester(e,t):o.addEventListener(e,t),{target:o,callback:t,type:e}):null},n.prototype.addLayerListener=function(e,t,o){return"function"==typeof o?(e.addEventListener(t,o),{target:e,callback:o,type:t}):(i.warn("no callback provided for event : "+t),null)},n.prototype._getEventTarget=function(e){return e===n.EVENTS.RANGE_CHANGED||e===n.EVENTS.CENTER_CHANGED||e===n.EVENTS.ORIENTATION_CHANGED?this.getGlobeView().controls:e===n.EVENTS.LAYER_ADDED||e===n.EVENTS.LAYER_REMOVED||e===n.EVENTS.LAYERS_ORDER_CHANGED||e===n.EVENTS.LAYERS_INITIALIZED||e===n.EVENTS.GLOBE_INITIALIZED||e===n.EVENTS.PRE_RENDER||e===n.EVENTS.AFTER_RENDER||e===n.EVENTS.VIEW_INITIALIZED?this.getGlobeView():e===n.EVENTS.MOUSE_MOVE?this._viewerDiv:(i.warn("unhandled event : "+e),null)},n.prototype.forgetByKey=function(e){e.type===n.EVENTS.AFTER_RENDER?e.target.removeFrameRequester(e.type,e.callback):e.target.removeEventListener(e.type,e.callback)},n.prototype.removeLayerListener=function(e,t,o){this.forgetByKey({target:e,callback:o,type:t})},n.prototype.forget=function(e,t){var o=this._getEventTarget(e);o&&this.forgetByKey({target:o,callback:t,type:e})},n.prototype.addLayer=function(e){try{var t=this.getGlobeView().addLayer(e)}catch(e){return Promise.reject(e)}return t},n.prototype.removeLayer=function(e){this.getGlobeView().removeLayer(e)},n.prototype.setLayerOpacity=function(e,t){var o=this.getColorLayerById(e);o.opacity=t,this.getGlobeView().notifyChange(o)},n.prototype.setLayerVisibility=function(e,t){var o=this.getColorLayerById(e);o.visible=t,this.getGlobeView().notifyChange(o)},n.prototype.moveLayerToIndex=function(e,t){r.ColorLayersOrdering.moveLayerToIndex(this.getGlobeView(),e,t)},n.prototype.removeEventListener=function(e,t){switch(e){case"mousemove":this._viewerDiv.removeEventListener(e,t);break;case"centerchanged":this.getGlobeView().controls.removeEventListener(e,t);break;default:this.getGlobeView().removeEventListener(e,t);}},n.prototype.preRenderEventFetchViewExtent=function(e){"undefined"==typeof e&&(e=!0),this._fetchExtent=e},n.prototype.preRenderEventFetchColorLayersDisplayed=function(e){"undefined"==typeof e&&(e=!0),this._fetchVisibleColorLayers=e},n.prototype.preRenderEventFetchElevationLayersDisplayed=function(e){"undefined"==typeof e&&(e=!0),this._fetchVisibleElevationLayers=e},n.prototype.preRenderEventFetchLayersDisplayed=function(e){"undefined"==typeof e&&(e=!0),this._fetchVisibleColorLayers=e,this._fetchVisibleElevationLayers=e},n.prototype.getLayerById=function(e){var t=this.getGlobeView().getLayers(function(t){if(t.id===e)return t})[0];return t?t:void i.trace("[GlobeViewExtended]  : no Layer found for the id '"+e+"'")},n.prototype.getColorLayerById=function(e){var t=this.getGlobeView().getLayers(function(t){if(t.id===e&&t.isColorLayer)return t})[0];return t?t:void i.trace("[GlobeViewExtended]  : no colorLayer found for the id '"+e+"'")},n.prototype.getColorLayers=function(){return this.getGlobeView().getLayers(function(e){if(e.isColorLayer)return e})},n.prototype.getVectorLayers=function(){return this.getGlobeView().getLayers(function(e){if(e.source&&e.source.isFileSource)return e})},n.prototype.getElevationLayers=function(){return this.getGlobeView().getLayers(function(e){if(e.isElevationLayer)return e})},n.prototype.getExtent=function(){return this.getGlobeView().tileLayer.info.displayed.extent},n.prototype.addWidget=function(e){e.getTarget()||e.setTarget(this._viewerDiv,e.getPosition()?e.getPosition():"absolute"),e.setGlobe(this),this._widgets.push(e)},n.prototype.getWidgets=function(){return this._widgets},n.prototype.removeWidget=function(e){e.setGlobe();for(var t=0;t<this._widgets.length;t++)this._widgets[t]===e&&this._widgets.splice(t,1)},n.prototype.getTargetElement=function(){return this._viewerDiv},n.prototype.getScale=function(){return this.getGlobeView().getScale()},n.prototype.setTilt=function(e){return this.getGlobeView().controls.setTilt(e,!1)},n.prototype.getTilt=function(){return this.getGlobeView().controls.getTilt()},n.prototype.setAzimuth=function(e){return this.getGlobeView().controls.setHeading(e,!1)},n.prototype.getAzimuth=function(){return this.getGlobeView().controls.getHeading()},n.prototype.getCoordinateFromPixel=function(e,t){return this.getGlobeView().controls.pickGeoPosition({x:e,y:t})},n.prototype.getCoordinateFromMouseEvent=function(e){var t=this.getGlobeView().eventToViewCoords(e);return this.getGlobeView().controls.pickGeoPosition(t)},n.prototype.getFeaturesAtMousePosition=function(e){var t=this.getVectorLayers();if(t){var o=[],n=this.getCoordinateFromMouseEvent(e);if(n)for(var a=this.getGlobeView().controls.pixelsToDegrees(5),s=0;s<t.length;s++){var l=t[s],d;if(l.visible){var p=r.FeaturesUtils.filterFeaturesUnderCoordinate(n,l.source.parsedData,a);for(d=0;d<p.length;d++)o.push(p[d])}}return o}},n.prototype.setCameraTargetGeoPosition=function(e){var t=this._transformCoords(e);return this.getGlobeView().controls.lookAtCoordinate(t,!1)},n.prototype.getCenter=function(){var e=this.getGlobeView().controls.getLookAtCoordinate();return this._fromItownsCoords(e)},n.prototype.getZoom=function(){return this.getGlobeView().controls.getZoom()},n.prototype.setZoom=function(e){return this.getGlobeView().controls.setZoom(e,!1)},n.prototype.pixelsToMeters=function(e){return this.getGlobeView().getPixelsToMeters(e)},n.prototype.metersToPixels=function(e){return this.getGlobeView().getMetersToPixels(e)},n.prototype.getRange=function(){return this.getGlobeView().controls.getRange()},n.prototype.getCameraTargetPosition=function(){return this.getGlobeView().controls.getCameraTargetPosition()},n.prototype.getLayerEventInfos=function(e){var t=e.type.replace("-property-changed","");return{propertyName:t,previousValue:e.previous[t],newValue:e["new"][t]}},n.prototype.setBackground=function(){this.getGlobeView().mainLoop.gfxEngine.renderer.setClearColor(0,0)},n.prototype.setCameraPosition=function(e,t){this.getGlobeView().camera.camera3D.position.copy(e).setLength(t)},n.prototype.lookAt=function(e){this.getGlobeView().camera.camera3D.lookAt(e)},n.prototype.parseMapboxStyle=function(e){return r.Fetcher.json(e)},n.prototype.notifyChange=function(){this.getGlobeView().notifyChange(this.getGlobeView().camera.camera3D)},n.prototype.resize=function(e,t){this.getGlobeView().mainLoop.gfxEngine.onWindowResize(e,t),this.notifyChange()},n.prototype._transformCoords=function(e){if(void 0!==e){var t={};if(void 0!==e.zoom&&(t.zoom=e.zoom),void 0!==e.tilt&&(t.tilt=e.tilt),void 0!==e.heading&&(t.heading=e.heading),void 0!==e.longitude&&void 0!==e.latitude){var o=e.altitude||0;t.coord=new r.Coordinates("EPSG:4326",e.longitude,e.latitude,o)}return t}},n.prototype._fromItownsCoords=function(e){return{lon:e.x,lat:e.y,alt:e.z}},t["default"]=n},function(e){e.exports=o},function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}o.r(t);t["default"]={detectSupport:function(){var e=!0,t=window.navigator.userAgent.toLowerCase();return(-1!==t.indexOf("iphone")||-1!==t.indexOf("ipod")||-1!==t.indexOf("ipad")||-1!==t.indexOf("android")||-1!==t.indexOf("mobile")||-1!==t.indexOf("blackberry")||-1!==t.indexOf("tablet")||-1!==t.indexOf("phone")||-1!==t.indexOf("touch"))&&(e=!1),(-1!==t.indexOf("msie")||-1!==t.indexOf("trident"))&&(e=!0),e},assign:function(e,t){for(var o in e=e||{},t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e},mergeParams:function(e,t,o){if(e&&t)for(var a in"undefined"==typeof o&&(o=!0),t)t.hasOwnProperty(a)&&("object"===n(t[a])?e.hasOwnProperty(a)?this.mergeParams(e[a],t[a],o):e[a]=t[a]:e.hasOwnProperty(a)?o&&(e[a]=t[a]):e[a]=t[a])}}},function(e,t,o){"use strict";o.r(t);var n=o(32),a=o(137);t["default"]={check:function(e){var t=n["default"].getLogger("checkrightmanagement");if(!e)return void t.error("WARNING : no parameter specified !");var o=e.key,r=e.resources||[],s=e.services||[];if(!r||0===r.length)return void t.error("WARNING : no parameter 'resources' specified !");if(!s||0===s.length)return void t.error("WARNING : no parameter 'services' specified !");var d={};if(!o){if(!a["default"].isConfigLoaded())return void t.warn("WARNING : The 'apiKey' parameter is missing, and the contract key configuration has not been loaded, so impossible to check yours rights !");o=Object.keys(a["default"].configuration.generalOptions.apiKeys)[0],t.log(o)}if(o){if(!a["default"].isConfigLoaded()){t.warn("WARNING : the contract key configuration has not been loaded, so be carefull !");for(var p={},c=0,u;c<s.length;c++){u=s[c],p[u]=[];for(var m=0,g;m<r.length;m++)g=r[m],p[u].push(g)}return p.key=o,t.log("right management not checked",p),p}for(var f=0,y;f<r.length;f++){y=r[f];for(var _=0;_<s.length;_++){var E=s[_],h=a["default"].getServiceParams(y,E,o);if(!h||0===Object.keys(h).length){t.warn("WARNING : The contract key configuration has no rights to load this geoportal resource ("+y+") for this service ("+E+") ");continue}d[E]||(d[E]=[]),d[E].push(y)}}return 0===Object.keys(d).length?void t.warn("WARNING : The contract key configuration has been loaded, and the 'apiKey' parameter has been set, but, there is a problem on the mapping between the contract and the key !"):(d.key=o,t.log("right management checked",d),d)}}}},function(e,t,o){"use strict";o.r(t),function(e){var n=o(32),a=n["default"].getLogger("config");t["default"]={configuration:null,isConfigLoaded:function(){var t="undefined"==typeof window?"undefined"==typeof self?"undefined"==typeof e?{}:e:self:window;return!!(t.Gp&&t.Gp.Config&&0!==Object.keys(t.Gp.Config).length)&&(this.configuration=t.Gp.Config,!0)},getLayerId:function(e,t){var o=null;if(this.configuration){var n=this.configuration.layers;for(var r in n)if(n.hasOwnProperty(r)){var s=r.split("$");if(e===s[0]&&s[1]){var i=s[1].split(":"),l=s[1].split(";");if(l[1]===t){o=r;break}if(i[2]===t){o=r;break}}}}return o||a.error("ERROR layer id (layer name: "+e+" / service: "+t+") was not found !?"),o},getLayerParams:function(e,t,o){var n={};if(this.configuration){var r=this.getLayerId(e,t);if(r){var s=this.configuration.layers[r],i=s.apiKeys[0];if(o&&o!==i)return void a.error("ERROR different keys ("+o+" !== "+i+") !?");o=o||i,n.key=o,n.url=s.getServerUrl(o),n.version=s.getServiceParams().version,n.styles=s.getDefaultStyle(),n.format=s.getDefaultFormat(),n.projection=s.getDefaultProjection(),n.minScale=s.getMinScaleDenominator(),n.maxScale=s.getMaxScaleDenominator(),n.extent=s.getBBOX(),n.legends=s.getLegends(),n.metadata=s.getMetadata(),n.originators=s.getOriginators(),n.title=s.getTitle(),n.description=s.getDescription(),n.quicklookUrl=s.getQuicklookUrl(),s.wmtsOptions&&(n.tileMatrixSetLimits=s.wmtsOptions.tileMatrixSetLimits);var l=s.getTMSID();if(l){n.TMSLink=l;var d=this.configuration.getTMSConf(l);n.matrixOrigin=d.getTopLeftCorner(),n.nativeResolutions=d.nativeResolutions,n.matrixIds=d.matrixIds,n.tileMatrices=d.tileMatrices}}}return n},getServiceParams:function(e,t,o){var n={};if(this.configuration){var a=this.getLayerId(e,t);if(a){var r=this.configuration.layers[a],s=r.apiKeys[0];if(o&&o!==s)return;o=o||s,n.key=o,n.url=r.getServerUrl(o),n.version=r.getServiceParams().version,n.extent=r.getBBOX(),n.title=r.getTitle(),n.description=r.getDescription()}}return n},getResolutions:function(){var e=[];return this.configuration&&(e=this.configuration.generalOptions.wgs84Resolutions),e},getTileMatrix:function(e){var t={};return this.configuration&&e&&(t=this.configuration.tileMatrixSets[e.toUpperCase()]),t},getGlobalConstraints:function(e){var t={};if(e){var o=this.configuration.layers[e];t.projection=o.getDefaultProjection(),t.minScale=o.getMinScaleDenominator(),t.maxScale=o.getMaxScaleDenominator(),t.extent=o.getBBOX()}return t}}}.call(this,o(30))},function(e,t,o){"use strict";o.r(t);var n={generate:function(){var e=Math.floor(Date.now());return function(){return e++}}(),name:function e(t){var e=null,o=t.lastIndexOf("-");return e=-1===o?t:t.substring(0,o),e},index:function e(t){var e=null,o=this.name(t),n=o.lastIndexOf("_");return-1!==n&&(e=o.substring(n+1)),e},uuid:function e(t){var e=null,o=t.lastIndexOf("-");return-1!==o&&(e=parseInt(t.substring(o+1),10)),e}};t["default"]=n},function(e,t,o){"use strict";function a(e){"@babel/helpers - typeof";return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}o.r(t);t["default"]={_addUID:function(e){var t=this._uid?e+"-"+this._uid:e;return t},_createMainContainerElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPmousePosition"),e.className="GPwidget",e},_createShowMousePositionElement:function(){var e=document.createElement("input");return e.id=this._addUID("GPshowMousePosition"),e.type="checkbox",e},_createShowMousePositionPictoElement:function(t){var o=this,n=document.createElement("label");n.id=this._addUID("GPshowMousePositionPicto"),n.className="GPshowAdvancedToolPicto",n.htmlFor=this._addUID("GPshowMousePosition"),n.title="Afficher les coordonn\xE9es du curseur",n.addEventListener("click",function(n){var e="";document.getElementById(o._addUID("GPshowMousePosition")).checked||t||(e="GPmapCenterVisible"),document.getElementById("GPmapCenter").className=e,o.onShowMousePositionClick(n)});var a=document.createElement("span");return a.id=this._addUID("GPshowMousePositionOpen"),a.className="GPshowAdvancedToolOpen",n.appendChild(a),n},_createMousePositionPanelElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPmousePositionPanel"),e.className="GPpanel",e},_createMapCenter:function(){var e=document.createElement("div");return e.id="GPmapCenter",e.className="",e},_createMousePositionPanelHeaderElement:function(){var e=document.createElement("div");e.className="GPpanelHeader";var t=document.createElement("div");t.className="GPpanelTitle",t.innerHTML="Coordonn\xE9es",e.appendChild(t);var o=document.createElement("div");o.id="GPmousePositionPanelClose",o.className="GPpanelClose",o.title="Fermer le panneau";var n=this;return o.addEventListener?o.addEventListener("click",function(){document.getElementById(n._addUID("GPshowMousePositionPicto")).click()},!1):o.attachEvent&&o.attachEvent("onclick",function(){document.getElementById(n._addUID("GPshowMousePositionPicto")).click()}),e.appendChild(o),e},_createMousePositionPanelBasicElement:function(e,t,o,n){e="undefined"==typeof e||e,t="undefined"==typeof t||t,o="undefined"!=typeof o&&o;var a=document.createElement("div");return a.id=this._addUID("GPmousePositionBasicPanel"),a.appendChild(this._createMousePositionPanelBasicCoordinateElement(t,o,n)),a.appendChild(this._createMousePositionPanelEditToolsElement(o)),a.appendChild(this._createMousePositionPanelBasicAltitudeElement(e)),a},_createCoordinateElement:function(t,o){var n=this;if(-1===["Lon","Lat"].indexOf(t))return[];var a=[],r=document.createElement("input");r.id=this._addUID("GPmousePosition"+t),r.title=!0===o?"Cliquer pour saisir des coordonn\xE9es":"",r.readOnly=!0,o&&(r.addEventListener("click",function(){n.onMousePositionEditModeClick(!0)}),r.addEventListener("change",function(o){this.classList.remove("error");var e=n.validateExtentCoordinate(t,this.value,o);e?this.classList.remove("error"):this.classList.add("error")})),a.push(r);var s=document.createElement("span");return s.className="GPmousePositionUnits",a.push(s),a},_createDMSCoordinateElement:function(e,t){if(-1===["Lon","Lat"].indexOf(e))return[];var o=this,n=[],a=document.createElement("input");a.id=this._addUID("GPmousePosition"+e+"Degrees"),a.className="GPSexagesimal",a.setAttribute("name","degrees"),a.title=!0===t?"Cliquer pour saisir des coordonn\xE9es":"",a.readOnly=!0,a.dataset.min=0,a.dataset.max="Lon"===e?180:90,t&&(a.addEventListener("click",function(){o.onMousePositionEditModeClick(!0)}),a.addEventListener("change",function(){this.classList.remove("error");var t=o._checkDMSDegrees(e,this);t?this.classList.remove("error"):this.classList.add("error")})),n.push(a);var r=document.createElement("span");r.className="GPmousePositionSexagesimalLabel",r.innerHTML="\xB0",n.push(r);var s=document.createElement("input");s.id=this._addUID("GPmousePosition"+e+"Minutes"),s.className="GPSexagesimal",s.setAttribute("name","minutes"),s.title=!0===t?"Cliquer pour saisir des coordonn\xE9es":"",s.readOnly=!0,s.dataset.min=0,s.dataset.max=59,t&&(s.addEventListener("click",function(){o.onMousePositionEditModeClick(!0)}),s.addEventListener("change",function(){this.classList.remove("error");var e=o._checkDMSElement(this);e?this.classList.remove("error"):this.classList.add("error")})),n.push(s);var i=document.createElement("span");i.className="GPmousePositionSexagesimalLabel",i.innerHTML="'",n.push(i);var l=document.createElement("input");l.id=this._addUID("GPmousePosition"+e+"Seconds"),l.className="GPSexagesimalsec",l.setAttribute("name","seconds"),l.title=!0===t?"Cliquer pour saisir des coordonn\xE9es":"",l.readOnly=!0,l.dataset.min=0,l.dataset.max=59,t&&(l.addEventListener("click",function(){o.onMousePositionEditModeClick(!0)}),l.addEventListener("change",function(){this.classList.remove("error");var e=o._checkDMSElement(this,!0);e?this.classList.remove("error"):this.classList.add("error")})),n.push(l);var d=document.createElement("span");d.className="GPmousePositionSexagesimalLabel",d.innerHTML="''",n.push(d);var p=document.createElement("select");p.id=this._addUID("GPmousePosition"+e+"Direction"),p.className="GPmousePositionDirection",p.setAttribute("name","direction"),p.disabled=!0;var c=document.createElement("option");c.value="Lon"===e?"E":"N",c.innerHTML="Lon"===e?"E":"N",p.appendChild(c);var u=document.createElement("option");return u.value="Lon"===e?"O":"S",u.innerHTML="Lon"===e?"O":"S",p.appendChild(u),n.push(p),n},_createMousePositionPanelBasicCoordinateElement:function(e,t,o){var n=document.createElement("div");n.id=this._addUID("GPmousePositionCoordinate"),n.style.display=e?"block":"none";var a=document.createElement("div"),r=document.createElement("span");r.className="GPmousePositionLabel",r.id=this._addUID("GPmousePositionLatLabel"),r.innerHTML="Latitude : ",a.appendChild(r);var s=document.createElement("span");s.id=this._addUID("GPmousePositionLatCoordinate");var l="DMS"===o?this._createDMSCoordinateElement("Lat",t):this._createCoordinateElement("Lat",t);for(var d=0;d<l.length;d++)s.appendChild(l[d]);a.appendChild(s),n.appendChild(a);var p=document.createElement("div"),c=document.createElement("span");c.className="GPmousePositionLabel",c.id=this._addUID("GPmousePositionLonLabel"),c.innerHTML="Longitude : ",p.appendChild(c);var u=document.createElement("span");u.id=this._addUID("GPmousePositionLonCoordinate");var m="DMS"===o?this._createDMSCoordinateElement("Lon",t):this._createCoordinateElement("Lon",t);for(var g=0;g<m.length;g++)u.appendChild(m[g]);return p.appendChild(u),n.appendChild(p),n},_createMousePositionPanelBasicAltitudeElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPmousePositionAltitude"),t.style.display=e?"block":"none";var o=document.createElement("span");o.className="GPmousePositionLabel",o.innerHTML="Altitude : ",t.appendChild(o);var n=document.createElement("span");n.className="GPmousePositionCoords",n.id=this._addUID("GPmousePositionAlt"),n.innerHTML="...",t.appendChild(n);var a=document.createElement("span");return a.className="GPmousePositionAltitudeUnits",a.innerHTML="m",t.appendChild(a),t},_createMousePositionPanelEditToolsElement:function(e){var t=this,o=document.createElement("div");o.className="GPmousePositionPanelEditTools",o.id=this._addUID("GPmousePositionPanelEditTools"),e||(o.style.display="none");var n=document.createElement("span");n.className="GPmousePositionEditTool",n.id=this._addUID("GPmousePositionLocate"),n.title=!0===e?"Cliquer pour saisir des coordonn\xE9es":"",e&&n.addEventListener("click",function(){t.onMousePositionEditModeLocateClick()}),o.appendChild(n);var a=document.createElement("span");return a.className="GPmousePositionEditTool",a.id=this._addUID("GPmousePositionCloseEdit"),a.title="Quitter la saisie des coordonn\xE9es",a.style.display="none",e&&a.addEventListener("click",function(){t.onMousePositionEditModeClick(!1)}),o.appendChild(a),o},_createShowMousePositionSettingsElement:function(e){var t=[],o=this,n=document.createElement("input");n.type="checkbox",n.id=this._addUID("GPshowMousePositionSettings");var a=document.createElement("label");return a.id=this._addUID("GPshowMousePositionSettingsPicto"),a.htmlFor=this._addUID("GPshowMousePositionSettings"),a.title="R\xE9glages",a.className="GPshowMoreOptionsImage GPshowMoreOptions GPshowMousePositionSettingsPicto",a.style.display=e?"block":"none",a.addEventListener?a.addEventListener("click",function(t){"function"==typeof o.onShowMousePositionSettingsClick&&o.onShowMousePositionSettingsClick(t)},!1):a.attachEvent&&a.attachEvent("onclick",function(t){"function"==typeof o.onShowMousePositionSettingsClick&&o.onShowMousePositionSettingsClick(t)}),t.push(n),t.push(a),t},_createMousePositionSettingsElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPmousePositionSettings"),t.style.display=void 0===e||e?"block":"none";var o=document.createElement("span");return o.className="GPmousePositionSettingsLabel",o.innerHTML="Syst\xE8me de r\xE9f\xE9rence",t.appendChild(o),t},_createMousePositionSettingsSystemsElement:function(e){var t=this,o=document.createElement("select");o.id=this._addUID("GPmousePositionProjectionSystem"),o.className="GPinputSelect GPmousePositionSettingsSelect",o.addEventListener("change",function(o){t.onMousePositionProjectionSystemChange(o)}),o.addEventListener("mouseover",function(o){"OPTION"!==o.target.nodeName&&t.onMousePositionProjectionSystemMouseOver(o)});for(var n=0;n<e.length;n++){var a=e[n],r=document.createElement("option");r.value=a.code,r.text=a.label||n,o.appendChild(r)}return o},_createMousePositionSettingsUnitsElement:function(e){var t=this,o=document.createElement("select");o.id=this._addUID("GPmousePositionProjectionUnits"),o.className="GPinputSelect GPmousePositionSettingsSelect",o.addEventListener("change",function(o){t.onMousePositionProjectionUnitsChange(o)});for(var n=0;n<e.length;n++){var a=e[n],r=document.createElement("option");r.value=a.code?a.code:n,r.text=a.label||n,o.appendChild(r)}return o},_resetLabelElements:function(e){var t=document.getElementById(this._addUID("GPmousePositionLatLabel"));t.innerHTML="Geographical"===e?"Latitude :":"X :";var o=document.getElementById(this._addUID("GPmousePositionLonLabel"));o.innerHTML="Geographical"===e?"Longitude :":"Y :"},_resetUnitElements:function(t){var o="";("M"===t||"KM"===t)&&(o=t.toLowerCase());for(var n=document.getElementsByClassName("GPmousePositionUnits"),a=0;a<n.length;a++)n[a].innerHTML=o},_resetCoordinateElements:function(e,t,o){for(var n=document.getElementById(this._addUID("GPmousePositionLatCoordinate"));n.firstChild;)n.removeChild(n.firstChild);var a="DMS"===o?this._createDMSCoordinateElement("Lat",e):this._createCoordinateElement("Lat",e);for(var r=0;r<a.length;r++)n.appendChild(a[r]);for(var s=document.getElementById(this._addUID("GPmousePositionLonCoordinate"));s.firstChild;)s.removeChild(s.firstChild);var l="DMS"===o?this._createDMSCoordinateElement("Lon",e):this._createCoordinateElement("Lon",e);for(var d=0;d<l.length;d++)s.appendChild(l[d])},_setEditMode:function(e){var t=document.getElementById(this._addUID("GPmousePositionLocate"));t.title=e?"Aller \xE0 la position ...":"Cliquer pour saisir des coordonn\xE9es";var o=document.getElementById(this._addUID("GPmousePositionCloseEdit"));o.style.display=e?"inline-block":"none";for(var n="div[id^="+this._addUID("GPmousePositionCoordinate")+"]",a=document.querySelectorAll(n+" input"),r=0;r<a.length;r++)a[r].readOnly=!e,e&&(a[r].value="",a[r].classList.remove("error"));for(var s=document.querySelectorAll(n+" select"),l=0;l<s.length;l++)s[l].disabled=!e},_checkDMSElement:function(e,t){var o=void 0!==t,n=e.value;if(o&&(n=n.replace(",",".")),isNaN(n))return!1;var a=parseFloat(n);if(!o&&(0|a)!==a)return!1;var r=+e.dataset.min,s=+e.dataset.max;return a>=r&&a<=s},_checkDMSDegrees:function(e,t){if(isNaN(t.value))return!1;var o=parseFloat(t.value);if((0|o)!==o)return!1;var n=+t.dataset.min,a=+t.dataset.max;if(o<n||o>a)return!1;var r=document.getElementById(this._addUID("GPmousePosition"+e+"Minutes")),s=document.getElementById(this._addUID("GPmousePosition"+e+"Seconds"));return o>=a?(r.dataset.max=0,s.dataset.max=0):(r.dataset.max=59,s.dataset.max=59.9999),!0},GPdisplayCoords:function(e){if(e&&null!=e){var t=document.getElementById(this._addUID("GPmousePositionLonLabel")),o=document.getElementById(this._addUID("GPmousePositionLatLabel"));if(e.x||e.y?(o.innerHTML="X : ",t.innerHTML="Y : "):e.e||e.n?(o.innerHTML="E : ",t.innerHTML="N : "):(o.innerHTML="Latitude : ",t.innerHTML="Longitude : "),"object"===a(e.lat)&&"object"===a(e.lng)){var r={lng:"Lon",lat:"Lat"},s=["Degrees","Minutes","Seconds"];for(var i in r)for(var l=0;l<s.length;++l){var d="GPmousePosition"+r[i]+s[l],p=document.getElementById(this._addUID(d)),c=s[l].charAt(0).toLowerCase();p.value=e[i][c]}document.getElementById(this._addUID("GPmousePositionLonDirection")).value=e.lng.direction,document.getElementById(this._addUID("GPmousePositionLatDirection")).value=e.lat.direction}else{var m=document.getElementById(this._addUID("GPmousePositionLat")),g=document.getElementById(this._addUID("GPmousePositionLon"));m.value=e.x||e.lat||e.e||"0",g.value=e.y||e.lng||e.lon||e.n||"0";for(var f=void 0===e.unit?"":e.unit,y=document.getElementsByClassName("GPmousePositionUnits"),_=0;_<y.length;++_)y[_].innerHTML=f}}},GPdisplayElevation:function(e,t,o,n){var a=this,r;t||(t=500),clearTimeout(r),document.getElementById(this._addUID("GPmousePositionAlt")).innerHTML="...",null==o&&(o=-99999),null==n&&(n=99980);var s=o+n,i=o-n;e&&null!=e&&document.getElementById(this._addUID("GPmousePositionAltitude"))&&(r=setTimeout(function(){a.onRequestAltitude(e,function(e){i<e&&e<s?a.GPresetElevation():document.getElementById(a._addUID("GPmousePositionAlt")).innerHTML=e})},t))},GPresetElevation:function(){document.getElementById(this._addUID("GPmousePositionAltitude"))&&(document.getElementById(this._addUID("GPmousePositionAlt")).innerHTML="---")}}},function(e,t,o){"use strict";function n(e){this._name=e.name===void 0?null:e.name,this._element=e.element===void 0?null:e.element,this._position=e.position===void 0?null:e.position,this._target=null,this._globe=null,e.target&&this.setTarget(e.target,this._position)}o.r(t);var a=o(32),r=a["default"].getLogger("Widget");n.prototype.constructor=n,n.prototype.getElement=function(){return this._element},n.prototype.setTarget=function(e,t){return this._target="string"==typeof e?document.getElementById(e):e,this._element?void(this._element.style.position=t||"relative",this._target.appendChild(this._element)):void r.error("Widget:setTarget - widget element not created")},n.prototype.getTarget=function(){return this._target},n.prototype.getPosition=function(){return this._position},n.prototype.getGlobe=function(){return this._globe},n.prototype.setGlobe=function(e){this._globe=e},t["default"]=n},function(e,t,o){"use strict";o.r(t);t["default"]={NORTH:"N",SOUTH:"S",EAST:"E",WEST:"W",digitSecond:2,digitDecimal:5,digitRadian:8,roundToDecimal:function(e,t){var o=Math.pow(10,t);return Math.round(e*o)/o},decimalToRadian:function(e){return this.roundToDecimal(e*.017453292519943295,this.digitRadian)},decimalToGrade:function(e){return this.roundToDecimal(e*1.1111111111111112,this.digitRadian)},decimalToDMS:function(e,t){0>e&&(e*=-1);var o=Math.floor(e),n=60*(e-o),a=Math.floor(n),r=this.roundToDecimal(60*(n-a),this.digitSecond),s=o+"\xB0 "+a+"' "+r+"\" ";return t&&(s+=t),s},decimalLatToDMS:function(e){var t=0>e?this.SOUTH:this.NORTH;return this.decimalToDMS(e,t)},decimalLongToDMS:function(e){var t=0>e?this.WEST:this.EAST;return this.decimalToDMS(e,t)},DMSToDecimal:function(e,t,o,n){var a=e+t/60+o/3600;a=n===this.SOUTH||n===this.WEST?-1*a:a;var r=this.roundToDecimal(a,this.digitDecimal);return r}}},function(e,t,o){"use strict";o.r(t);t["default"]={"EPSG:4326":"+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +units=degrees","EPSG:3857":"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs","EPSG:2154":"+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs","EPSG:27572":"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs","EPSG:32620":"+proj=utm +zone=20 +ellps=WGS84 +datum=WGS84 +units=m +no_defs","EPSG:4467":"+proj=utm +zone=21 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs","EPSG:2972":"+proj=utm +zone=22 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs","EPSG:32630":"+proj=utm +zone=30 +datum=WGS84 +units=m +no_defs","EPSG:32631":"+proj=utm +zone=31 +datum=WGS84 +units=m +no_defs","EPSG:32632":"+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs","EPSG:4471":"+proj=utm +zone=38 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs","EPSG:2975":"+proj=utm +zone=40 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs","EPSG:3296":"+proj=utm +zone=5 +south +ellps=GRS80 +towgs84=0.072,-0.507,-0.245,-0.0183,0.0003,-0.007,-0.0093 +units=m +no_defs","EPSG:3297":"+proj=utm +zone=6 +south +ellps=GRS80 +towgs84=0.072,-0.507,-0.245,-0.0183,0.0003,-0.007,-0.0093 +units=m +no_defs","EPSG:32707":"+proj=utm +zone=7 +south +datum=WGS84 +units=m +no_defs","EPSG:32708":"+proj=utm +zone=8 +south +datum=WGS84 +units=m +no_defs","EPSG:26912":"+proj=utm +zone=12 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs","EPSG:32742":"+proj=utm +zone=42 +south +datum=WGS84 +units=m +no_defs","EPSG:32739":"+proj=utm +zone=39 +south +datum=WGS84 +units=m +no_defs","EPSG:32743":"+proj=utm +zone=43 +south +datum=WGS84 +units=m +no_defs","EPSG:2986":"","EPSG:32737":"+proj=utm +zone=37 +south +datum=WGS84 +units=m +no_defs","EPSG:32738":"+proj=utm +zone=38 +south +datum=WGS84 +units=m +no_defs","EPSG:2988":"+proj=utm +zone=1 +south +ellps=intl +towgs84=253,-132,-127,0,0,0,0 +units=m +no_defs","EPSG:3163":"+proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"}},function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e){e=e||{};var t=e.options||{},o=e.layers||[];if(!(this instanceof a))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(o&&!Array.isArray(o))throw new Error("ERROR WRONG_TYPE : layers should be an array");if(t&&"object"!==n(t))throw new Error("ERROR WRONG_TYPE : options should be an object");this._initialize(t,o);var r=this._initContainer(t);this._addedLayerConf={},p["default"].call(this,{name:"LayerSwitcher",element:r,target:t.target,position:t.position})}o.r(t);var r=o(133),s=o(32),i=o(135),l=o(138),d=o(144),p=o(140),c=s["default"].getLogger("LayerSwitcher");a.prototype=Object.create(p["default"].prototype,{}),i["default"].assign(a.prototype,d["default"]),a.prototype.constructor=a,a.prototype.setGlobe=function(e){var t;if(e){for(var o=this,n=0,a;n<this._initLayers.length;n++)if(a=null,this._initLayers[n].id&&(a=e.getLayerById(this._initLayers[n].id)),a&&this._initLayers[n].displayed){var s=this._initLayers[n].config||{},l={title:s.title||a.title||this._initLayers[n].id,description:s.description||null,legends:s.legends||[],metadata:s.metadata||[],quicklookUrl:s.quicklookUrl||null};"undefined"!=typeof s.ipr&&(l.ipr=s.ipr),"undefined"!=typeof s.opacity&&(l.opacity=s.opacity),"undefined"!=typeof s.visibility&&(l.visibility=s.visibility),this._layers[a.id]=l}this._addGlobeLayers(e),this._callbacks.onOpacityLayerCallBack=function(t){o._updateLayerOpacity(t.target.id,t["new"].opacity)},this._callbacks.onVisibilityLayerCallBack=function(t){o._updateLayerVisibility(t.target.id,t["new"].visible)},this._callbacks.onChangedViewCallBack=function(t){o._inRangeUpdate(t.colorLayersId)},e.listen(r["default"].EVENTS.PRE_RENDER,this._callbacks.onChangedViewCallBack),e.preRenderEventFetchColorLayersDisplayed(),this._callbacks.onAddedLayerCallBack=function(t){var e=t.layerId;if(o){if(!o._layerDisplayedInLayerSwitcher(e))return;var n=o.getGlobe().getLayerById(e);if("elevation"===n.type)return;var a=o._getLayerConf(e)||o._addedLayerConf[e];a?o.addLayer(n,a):o.addLayer(n)}},e.listen(r["default"].EVENTS.LAYER_ADDED,this._callbacks.onAddedLayerCallBack),this._callbacks.onRemovedLayerCallBack=function(t){var e=t.layerId;o&&o.removeLayer(e)},e.listen(r["default"].EVENTS.LAYER_REMOVED,this._callbacks.onRemovedLayerCallBack),this._callbacks.onIndexLayerCallBack=function(t){var e=function(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;++o)if(e[o]!==t[o])return!1;return!0};e(t["new"].sequence,t.previous.sequence)||o._updateLayerListContainer()},e.listen(r["default"].EVENTS.LAYERS_ORDER_CHANGED,this._callbacks.onIndexLayerCallBack),t=e.getColorLayers();for(var d=0;d<t.length;++d)e.addLayerListener(t[d],r["default"].EVENTS.OPACITY_PROPERTY_CHANGED,this._callbacks.onOpacityLayerCallBack),e.addLayerListener(t[d],r["default"].EVENTS.VISIBLE_PROPERTY_CHANGED,this._callbacks.onVisibilityLayerCallBack),o._updateLayerVisibility(t[d].id,t[d].visible),o._updateLayerOpacity(t[d].id,t[d].opacity)}else{this._globe.forget(r["default"].EVENTS.PRE_RENDER,this._callbacks.onChangedViewCallBack),this._globe.forget(r["default"].EVENTS.LAYER_ADDED,this._callbacks.onAddedLayerCallBack),this._globe.forget(r["default"].EVENTS.LAYER_REMOVED,this._callbacks.onRemovedLayerCallBack),this._globe.forget(r["default"].EVENTS.LAYERS_ORDER_CHANGED,this._callbacks.onIndexLayerCallBack),t=this._globe.getColorLayers();for(var c=0;c<t.length;++c)this._globe.removeLayerListener(t[c],r["default"].EVENTS.OPACITY_PROPERTY_CHANGED,this._callbacks.onOpacityLayerCallBack),this._globe.removeLayerListener(t[c],r["default"].EVENTS.VISIBLE_PROPERTY_CHANGED,this._callbacks.onVisibilityLayerCallBack);for(;this._element.hasChildNodes();)this._element.removeChild(this._element.lastChild);this._element.parentNode.removeChild(this._element)}p["default"].prototype.setGlobe.call(this,e)},a.prototype.addLayer=function(e,t){t=t||{};var o=this.getGlobe();if(!e)return void c.error("LayerSwitcher:addLayer - missing layer parameter");var n=e.id;if("undefined"===n)return void c.error("LayerSwitcher:addLayer - configuration cannot be set for "+e+" layer (layer id not found)");o.addLayerListener(e,r["default"].EVENTS.OPACITY_PROPERTY_CHANGED,this._callbacks.onOpacityLayerCallBack),o.addLayerListener(e,r["default"].EVENTS.VISIBLE_PROPERTY_CHANGED,this._callbacks.onVisibilityLayerCallBack);var a=o.getLayerById(n);if(!a)return void c.error("LayerSwitcher:addLayer - configuration cannot be set for ",e," layer (layer is not in globe layers )");if(!this._layers[n]){var s=this._getLayerInfo(e)||{},i={title:t.title||s._title||n,description:t.description||s._description||null,legends:t.legends||s._legends||[],metadata:t.metadata||s._metadata||[],quicklookUrl:t.quicklookUrl||s._quicklookUrl||null};"undefined"!=typeof t.ipr&&(i.ipr=t.ipr,e.attribution=i.ipr),"undefined"!=typeof t.opacity&&(i.opacity=t.opacity,e.opacity=i.opacity),"undefined"!=typeof t.visibility&&(i.visibility=t.visibility,e.visible=i.visibility),this._layers[n]=i,this._layers[n].div=this._createLayerDiv(n),this._updateLayerListContainer()}else if(this._layers[n]&&t){for(var l in t)t.hasOwnProperty(l)&&(this._layers[n][l]=t[l]);if("undefined"!=typeof t.ipr&&(e.attribution=t.ipr),"undefined"!=typeof t.opacity&&(e.opacity=t.opacity),"undefined"!=typeof t.visibility&&(e.visible=t.visibility),t.title){var d=document.getElementById(this._addUID("GPname_ID_"+n));d&&(d.innerHTML=t.title)}var p=document.getElementById(this._addUID("GPinfo_ID_"+n));if(!document.getElementById(this._addUID("GPinfo_ID_"+n))&&t.description&&(t.legends||t.metadata||t.quicklookUrl)){var u=document.getElementById(this._addUID("GPadvancedTools_ID_"+n));u&&u.appendChild(this._createAdvancedToolInformationElement({id:n}))}p&&"GPlayerInfoOpened"===p.className&&(document.getElementById(this._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed",p.className="GPlayerInfo")}},a.prototype.removeLayer=function(e){var t=document.getElementById(this._addUID("GPlayersList")),o=document.getElementById(this._addUID("GPinfo_ID_"+e));o&&"GPlayerInfoOpened"===o.className&&(document.getElementById(this._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed",o.className="GPlayerInfo");var n=document.getElementById(this._addUID("GPlayerSwitcher_ID_"+e));n&&t.removeChild(n),delete this._layers[e]},a.prototype.setCollapsed=function(e){if(void 0===e)return void c.error("LayerSwitcher:setCollapsed - missing collapsed parameter");var t=this.getCollapsed();if((!e||!t)&&(e||t)){if(!t){for(var o=document.getElementsByClassName("GPlayerInfoOpened"),n=0;n<o.length;n++)o[n].className="GPlayerInfo";document.getElementById(this._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed"}document.getElementById(this._addUID("GPshowLayersList")).checked=!e}},a.prototype.getCollapsed=function(){return!document.getElementById(this._addUID("GPshowLayersList")).checked},a.prototype._initialize=function(e,t){this._uid=l["default"].generate(),this._layers={},this._layerListContainer=null,this._callbacks={},this._options=e,this._initLayers=t},a.prototype._getLayerConf=function(e){for(var t=0;t<this._initLayers.length;++t)if(this._initLayers[t].id===e)return this._initLayers[t].config;return null},a.prototype._layerDisplayedInLayerSwitcher=function(e){for(var t=0;t<this._initLayers.length;++t)if(this._initLayers[t].id===e)return"undefined"==typeof this._initLayers[t].displayed||this._initLayers[t].displayed;return!0},a.prototype._initContainer=function(e){var t=this._createMainContainerElement(),o=this._createMainLayersShowElement();t.appendChild(o),e.collapsed||(o.checked="checked");var n=this._layerListContainer=this._createMainLayersElement();t.appendChild(n),this._createDraggableElement(n,this);var a=this._createMainPictoElement();t.appendChild(a);var r=this._createMainInfoElement();return t.appendChild(r),t},a.prototype._addGlobeLayers=function(e){for(var t=this.getElement().childNodes,o=0,n;o<t.length;o++)if(t[o].id===this._addUID("GPlayersList")){n=t[o];break}var a=e.getColorLayers(),r=a.sort(function(e,t){return t.sequence-e.sequence});r.forEach(function(e){var t;if(t=e.id,!!this._layerDisplayedInLayerSwitcher(t)){var o=this._getLayerConf(t)||this._addedLayerConf[t]||{},a=this._getLayerInfo(e)||{};if(!this._layers[t]){var r={title:o.title||a._title||t,description:o.description||a._description||null,legends:o.legends||a._legends||[],metadata:o.metadata||a._metadata||[],quicklookUrl:o.quicklookUrl||a._quicklookUrl||null};this._layers[t]=r}else{var s=this._layers[t];"undefined"!=typeof s.ipr&&(e.options.attribution=s.ipr),"undefined"!=typeof s.opacity&&(e.opacity=s.opacity),"undefined"!=typeof s.visibility&&(e.visible=s.visibility)}var i=this._createLayerDiv(t);this._layers[t].div=i,n.appendChild(i)}},this)},a.prototype._createLayerDiv=function(e){var t=this._layers[e],o=t.legends&&0!==t.legends.length,n=t.metadata&&0!==t.metadata.length,a=t.quicklookUrl;(o||n||a)&&(t.displayInformationElement=!0),t.id=e;var r=this._createContainerLayerElement(t);return t.inRange||r.classList.add("outOfRange"),r},a.prototype._onChangeLayerOpacity=function(t){var e=this.getGlobe(),o=this._resolveLayerId(t.target.id),n=t.target.value,a=document.getElementById(this._addUID("GPopacityValue_ID_"+o));a.innerHTML=n+"%",e.setLayerOpacity(o,n/100)},a.prototype._updateLayerOpacity=function(e,t){1<t&&(t=1),0>t&&(t=0);var o=document.getElementById(this._addUID("GPopacityValueDiv_ID_"+e));o&&(o.value=Math.round(100*t));var n=document.getElementById(this._addUID("GPopacityValue_ID_"+e));n&&(n.innerHTML=Math.round(100*t)+"%")},a.prototype._onVisibilityLayerClick=function(t){var e=this.getGlobe(),o=this._resolveLayerId(t.target.id);e.setLayerVisibility(o,t.target.checked)},a.prototype._updateLayerVisibility=function(e,t){var o=document.getElementById(this._addUID("GPvisibility_ID_"+e));o&&(o.checked=t)},a.prototype._onOpenLayerInfoClick=function(t){var e=this._resolveLayerId(t.target.id),o=this._layers[e],n=document.getElementById(t.target.id),a,r;if("GPlayerInfoOpened"===n.className)return void 0!==n.classList&&(n.classList.remove("GPlayerInfoOpened"),n.classList.add("GPlayerInfo")),a=document.getElementById(this._addUID("GPlayerInfoPanel")),void 0!==a.classList&&(a.classList.remove("GPpanel"),a.classList.remove("GPlayerInfoPanelOpened"),a.classList.add("GPlayerInfoPanelClosed")),r=document.getElementById(this._addUID("GPlayerInfoContent")),void a.removeChild(r);for(var s=document.getElementsByClassName("GPlayerInfoOpened"),l=0;l<s.length;l++)s[l].className="GPlayerInfo";n.classList!==void 0&&(n.classList.remove("GPlayerInfo"),n.classList.add("GPlayerInfoOpened")),a=document.getElementById(this._addUID("GPlayerInfoPanel")),a.classList!==void 0&&(a.classList.add("GPpanel"),a.classList.remove("GPlayerInfoPanelClosed"),a.classList.add("GPlayerInfoPanelOpened")),r=document.getElementById(this._addUID("GPlayerInfoContent")),r&&a.removeChild(r);var d={title:o.title,description:o.description,quicklookUrl:o.quicklookUrl,metadata:o.metadata,legends:o.legends},p=this._createContainerLayerInfoElement(d);a.appendChild(p)},a.prototype._onDropLayerClick=function(t){var e=this.getGlobe(),o=this._resolveLayerId(t.target.id);e.removeLayer(o),this._updateLayerListContainer()},a.prototype._onDragAndDropLayerClick=function(t){var e=this.getGlobe();if(0!=t.newIndex-t.oldIndex){var o=null;if(!t.newIndex||0===t.newIndex)o=e.getColorLayers().length-1;else{var n=this._resolveLayerId(t.from.childNodes[t.newIndex+(0>t.newIndex-t.oldIndex?1:-1)].id);o=e.getLayerById(n).sequence}var a=this._resolveLayerId(t.item.id);e.moveLayerToIndex(a,o)}},a.prototype._inRangeUpdate=function(e){for(var t in this._layers){var o=this._layers[t];if(o){var n=0<=e.indexOf(o.id),a;n&&!o.inRange?(o.inRange=!0,a=document.getElementById(this._addUID("GPlayerSwitcher_ID_"+o.id)),a.classList.remove("outOfRange")):!n&&o.inRange&&(o.inRange=!1,a=document.getElementById(this._addUID("GPlayerSwitcher_ID_"+o.id)),a.classList.add("outOfRange"))}}},a.prototype._updateLayerListContainer=function(){if(this._layerListContainer){for(var e=this.getGlobe();this._layerListContainer.firstChild;)this._layerListContainer.removeChild(this._layerListContainer.firstChild);for(var t=e.getColorLayers(),o=t.sort(function(e,t){return t.sequence-e.sequence}),n=0;n<o.length;n++)if(this._layers[o[n].id]){var a=this._layers[o[n].id].div;this._layerListContainer.appendChild(a)}}else c.error("[Itowns.control.LayerSwitcher] _updateLayerListContainer : layer list container not found to update layers order ?!")},a.prototype._getLayerInfo=function(e){var t={};return e&&(t._title=e.title||null,t._description=e.description||null,t._quicklookUrl=e.quicklookUrl||null,t._metadata=e.metadata||null,t._legends=e.legends||null),t},a.prototype._resolveLayerId=function(e){var t=l["default"].name(e);return t.substring(t.indexOf("_ID_")+4)},t["default"]=a},function(e,t,o){"use strict";o.r(t);var n=o(145),a=o.n(n);t["default"]={_createDraggableElement:function(e,t){a.a.create(e,{handle:".GPlayerName",draggable:".draggable-layer",ghostClass:"GPghostLayer",animation:200,onEnd:function(o){t._onDragAndDropLayerClick(o)}})},_addUID:function(e){var t=this._uid?e+"-"+this._uid:e;return t},_createMainContainerElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPlayerSwitcher"),e.className="GPwidget",e},_createMainLayersShowElement:function(){var e=document.createElement("input");return e.id=this._addUID("GPshowLayersList"),e.type="checkbox",e},_createMainLayersElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPlayersList"),e.className="GPpanel",e},_createMainPictoElement:function(){var e=this,t=document.createElement("label");t.id=this._addUID("GPshowLayersListPicto"),t.className="GPshowAdvancedToolPicto",t.htmlFor=this._addUID("GPshowLayersList"),t.title="Aus-/Einklappen des Layer-Widgets";var o=document.createElement("span");o.id=this._addUID("GPshowLayersListOpen"),o.className="GPshowAdvancedToolOpen",o.addEventListener("click",function(){if(document.getElementById(e._addUID("GPshowLayersList")).checked){for(var t=document.getElementsByClassName("GPlayerInfoOpened"),o=0;o<t.length;o++)t[o].className="GPlayerInfo";document.getElementById(e._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed"}}),t.appendChild(o);var n=document.createElement("span");return n.addEventListener("click",function(){if(document.getElementById(e._addUID("GPshowLayersList")).checked){for(var t=document.getElementsByClassName("GPlayerInfoOpened"),o=0;o<t.length;o++)t[o].className="GPlayerInfo";document.getElementById(e._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed"}}),n.id=e._addUID("GPshowLayersListClose"),t.appendChild(n),t},_createMainInfoElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPlayerInfoPanel"),e.className="GPpanel GPlayerInfoPanelClosed",e},_createContainerLayerElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPlayerSwitcher_ID_"+e.id),t.className="GPlayerSwitcher_layer draggable-layer",t.appendChild(this._createBasicToolElement(e));for(var o=this._createAdvancedToolShowElement(e),n=0;n<o.length;n++)t.appendChild(o[n]);return t.appendChild(this._createAdvancedToolElement(e)),t},_createBasicToolElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPbasicTools_ID_"+e.id),t.className="GPlayerBasicTools",t.appendChild(this._createBasicToolNameElement(e));for(var o=this._createBasicToolVisibilityElement(e),n=0;n<o.length;n++)t.appendChild(o[n]);return t},_createBasicToolNameElement:function(e){var t=document.createElement("span");return t.id=this._addUID("GPname_ID_"+e.id),t.className="GPlayerName",t.title=e.description||e.title,t.innerHTML=e.title,t},_createBasicToolVisibilityElement:function(e){var t=[],o="undefined"==typeof e.visibility||e.visibility,n=this._addUID("GPvisibility_ID_"+e.id),a=document.createElement("input");a.id=n,a.type="checkbox",a.checked=o;var r=document.createElement("label");r.htmlFor=n,r.id=this._addUID("GPvisibilityPicto_ID_"+e.id),r.className="GPlayerVisibility",r.title="Anzeigen/Ausblenden des Layers";var s=this;return a.addEventListener?a.addEventListener("click",function(t){s._onVisibilityLayerClick(t)}):a.attachEvent&&a.attachEvent("onclick",function(t){s._onVisibilityLayerClick(t)}),t.push(a),t.push(r),t},_createAdvancedToolShowElement:function(e){var t=[],o=document.createElement("label");o.id=this._addUID("GPshowAdvancedToolsPicto_ID_"+e.id),o.htmlFor=this._addUID("GPshowAdvancedTools_ID_"+e.id),o.title="erweiterte Anzeige",o.className="GPshowMoreOptions GPshowLayerAdvancedTools";var n=document.createElement("input");return n.type="checkbox",n.id=this._addUID("GPshowAdvancedTools_ID_"+e.id),t.push(n),t.push(o),t},_createAdvancedToolElement:function(e){var t=document.createElement("div");if(t.id=this._addUID("GPadvancedTools_ID_"+e.id),t.className="GPlayerAdvancedTools",t.appendChild(this._createAdvancedToolDeleteElement(e)),e.title&&e.description&&t.appendChild(this._createAdvancedToolInformationElement(e)),"feature"!==e.type)for(var o=this._createAdvancedToolOpacityElement(e),n=0;n<o.length;n++)t.appendChild(o[n]);return t},_createAdvancedToolDeleteElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPremove_ID_"+e.id),t.className="GPlayerRemove",t.title="L\xF6schen",t.layerId=e.id;var o=this;return t.addEventListener?t.addEventListener("click",function(t){o._onDropLayerClick(t)}):t.attachEvent&&t.attachEvent("onclick",function(t){o._onDropLayerClick(t)}),t},_createAdvancedToolInformationElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPinfo_ID_"+e.id),t.className="GPlayerInfo",t.title="Informationen/Legende",t.layerId=e.id;var o=this;return t.addEventListener?t.addEventListener("click",function(t){o._onOpenLayerInfoClick(t)}):t.attachEvent&&t.attachEvent("onclick",function(t){o._onOpenLayerInfoClick(t)}),t},_createAdvancedToolOpacityElement:function(e){var t=[],o=document.createElement("div");o.id=this._addUID("GPopacity_ID_"+e.id),o.className="GPlayerOpacity",o.title="Opazit\xE4t";var n="undefined"==typeof e.opacity?1:e.opacity;n=Math.round(100*n);var a=document.createElement("input");a.id=this._addUID("GPopacityValueDiv_ID_"+e.id),a.type="range",a.value=n;var r=this;a.addEventListener?a.addEventListener("change",function(t){r._onChangeLayerOpacity(t)}):a.attachEvent&&a.attachEvent("onchange",function(t){r._onChangeLayerOpacity(t)}),a.addEventListener?a.addEventListener("input",function(t){r._onChangeLayerOpacity(t)}):a.attachEvent&&a.attachEvent("oninput",function(t){r._onChangeLayerOpacity(t)}),o.appendChild(a);var s=document.createElement("div");s.id=this._addUID("GPopacityValueDiv_ID_"+e.id),s.className="GPlayerOpacityValue";var i=document.createElement("span");return i.id=this._addUID("GPopacityValue_ID_"+e.id),i.innerHTML=n+"%",s.appendChild(i),t.push(o),t.push(s),t},_createContainerLayerInfoElement:function(e){var t=document.createElement("div");t.id=this._addUID("GPlayerInfoContent");var o=document.createElement("div");if(o.id=this._addUID("GPlayerInfoTitle"),o.innerHTML=e.title,t.appendChild(o),e.quicklookUrl){var n=document.createElement("div");n.id=this._addUID("GPlayerInfoQuicklook"),n.title="Afficher un aper\xE7u de la couche";var a=document.createElement("a");a.href=e.quicklookUrl,a.appendChild(n),t.appendChild(a)}var r=document.createElement("div");r.id=this._addUID("GPlayerInfoClose"),r.title="Schlie\xDFen";var l=this,d=function(){document.getElementById(l._addUID("GPlayerInfoPanel")).className="GPlayerInfoPanelClosed";for(var e=document.getElementsByClassName("GPlayerInfoOpened"),t=0;t<e.length;t++)e[t].className="GPlayerInfo"};r.addEventListener?r.addEventListener("click",d):r.attachEvent&&r.attachEvent("onclick",d),t.appendChild(r);var p=document.createElement("div");if(p.id=this._addUID("GPlayerInfoDescription"),p.innerHTML=e.description,t.appendChild(p),e.metadata){var c=document.createElement("div");c.id=this._addUID("GPlayerInfoMetadata");var u=document.createElement("div");u.className="GPlayerInfoSubtitle",u.innerHTML="M\xE9tadonn\xE9es",c.appendChild(u);for(var m=0;m<e.metadata.length;m++){var g=e.metadata[m].url,f=document.createElement("div");f.className="GPlayerInfoLink";var y=document.createElement("a");y.href=g,y.innerHTML=g,f.appendChild(y),c.appendChild(f)}0!==e.metadata.length&&t.appendChild(c)}if(e.legends){var _=document.createElement("div");_.id=this._addUID("GPlayerInfoLegend");var E=document.createElement("div");E.className="GPlayerInfoSubtitle",E.innerHTML="L\xE9gende",_.appendChild(E);for(var h={},b=e.maxScaleDenominator||56e7,S=0,P;S<e.legends.length;S++){if(P=e.legends[S].minScaleDenominator,P){var R=P.toString();P=Math.round(parseInt(R.substring(0,3),10)/10)*Math.pow(10,R.length-2)}else P=270;h[P]=e.legends[S]}for(var s in h)if(h.hasOwnProperty(s)){var x=h[s].url;if("string"==typeof x&&-1===x.toLowerCase().indexOf("nolegend.jpg")){var v=document.createElement("div");v.className="GPlayerInfoLink",b=h[s].maxScaleDenominator||b;var C=document.createElement("a");C.href=x,C.innerHTML="Du 1/"+s+" au 1/"+b,v.appendChild(C),_.appendChild(v)}else delete h[s]}0!==Object.keys(h).length&&t.appendChild(_)}return t}}},function(e,t,o){var n,a;(function(r){"use strict";n=r,a="function"==typeof n?n.call(t,o,t,e):n,!(a!==void 0&&(e.exports=a))})(function(){"use strict";function e(t,o){if(!(t&&t.nodeType&&1===t.nodeType))throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(t);this.el=t,this.options=o=C({},o),t[F]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return pe(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:X(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==e.supportPointer&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5};for(var r in n)r in o||(o[r]=n[r]);for(var s in he(o),this)"_"===s.charAt(0)&&"function"==typeof this[s]&&(this[s]=this[s].bind(this));this.nativeDraggable=!o.forceFallback&&oe,this.nativeDraggable&&(this.options.touchStartThreshold=1),o.supportPointer?a(t,"pointerdown",this._onTapStart):(a(t,"mousedown",this._onTapStart),a(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(a(t,"dragover",this),a(t,"dragenter",this)),U.push(this.el),o.store&&o.store.get&&this.sort(o.store.get(this)||[])}function t(e,t,n,a){if(e){n=n||z;do{if(null!=t&&(">"===t[0]&&e.parentNode===n&&R(e,t.substring(1))||R(e,t))||a&&e===n)return e;if(e===n)break}while(e=o(e))}return null}function o(e){return e.host&&e!==z&&e.host.nodeType?e.host:e.parentNode}function n(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function a(e,t,o){e.addEventListener(t,o,y)}function r(e,t,o){e.removeEventListener(t,o,y)}function s(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(B," ").replace(" "+t+" "," ");e.className=(n+(o?" "+t:"")).replace(B," ")}}function l(e,t,o){var n=e&&e.style;if(n){if(void 0===o)return z.defaultView&&z.defaultView.getComputedStyle?o=z.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),void 0===t?o:o[t];t in n||-1!==t.indexOf("webkit")||(t="-webkit-"+t),n[t]=o+("string"==typeof o?"":"px")}}function d(e){var t="";do{var o=l(e,"transform");o&&"none"!==o&&(t=o+" "+t)}while(e=e.parentNode);return window.DOMMatrix?new DOMMatrix(t):window.WebKitCSSMatrix?new WebKitCSSMatrix(t):window.CSSMatrix?new CSSMatrix(t):void 0}function p(e,t,o){if(e){var a=e.getElementsByTagName(t),r=0,s=a.length;if(o)for(;r<s;r++)o(a[r],r);return a}return[]}function c(e,t,o,n,a,r,s,i,l){e=e||t[F];var d=e.options,p="on"+o.charAt(0).toUpperCase()+o.substr(1),c;!window.CustomEvent||K||Q?(c=z.createEvent("Event"),c.initEvent(o,!0,!0)):c=new CustomEvent(o,{bubbles:!0,cancelable:!0}),c.to=a||t,c.from=r||t,c.item=n||t,c.clone=Le,c.oldIndex=s,c.newIndex=i,c.originalEvent=l,c.pullMode=Ue?Ue.lastPutMode:void 0,t&&t.dispatchEvent(c),d[p]&&d[p].call(e,c)}function u(e,t,o,n,a,r,s,i){var l=e[F],d=l.options.onMove,p,c;return!window.CustomEvent||K||Q?(p=z.createEvent("Event"),p.initEvent("move",!0,!0)):p=new CustomEvent("move",{bubbles:!0,cancelable:!0}),p.to=t,p.from=e,p.dragged=o,p.draggedRect=n,p.related=a||t,p.relatedRect=r||T(t),p.willInsertAfter=i,p.originalEvent=s,e.dispatchEvent(p),d&&(c=d.call(l,p,s)),c}function m(e){e.draggable=!1}function g(){ae=!1}function f(e,o,n){for(var a=0,r=0,s=e.children;r<s.length;){if("none"!==s[r].style.display&&s[r]!==Ae&&s[r]!==ve&&t(s[r],n.draggable,e,!1)){if(a===o)return s[r];a++}r++}return null}function _(e){for(var t=e.lastElementChild;t&&(t===Ae||"none"===t.style.display);)t=t.previousElementSibling;return t||null}function E(e,t,o){var n=T(_(o)),a="vertical"===t?e.clientY:e.clientX,r="vertical"===t?e.clientX:e.clientY,s="vertical"===t?n.bottom:n.right,i="vertical"===t?n.left:n.top,l="vertical"===t?n.right:n.bottom;return"vertical"===t?r>l+10||r<=l&&a>s&&r>=i:a>s&&r>i||a<=s&&r>l+10}function h(e,t,o,n,a,r,s){var i=T(t),l="vertical"===o?e.clientY:e.clientX,d="vertical"===o?i.height:i.width,p="vertical"===o?i.top:i.left,c="vertical"===o?i.bottom:i.right,u=T(ve),m=!1;if(!r)if(s&&We<d*n){if(!q&&(1===Xe?l>p+d*a/2:l<c-d*a/2)&&(q=!0),!q){var g="vertical"===o?u.top:u.left,f="vertical"===o?u.bottom:u.right;if(1===Xe?l<p+We:l>c-We)return-1*Xe}else m=!0;}else if(l>p+d*(1-n)/2&&l<c-d*(1-n)/2)return b(t);return m=m||r,m&&(l<p+d*a/2||l>c-d*a/2)?l>p+d/2?1:-1:0}function b(e){var t=P(ve),o=P(e);return t<o?1:-1}function S(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,n=0;o--;)n+=t.charCodeAt(o);return n.toString(36)}function P(e){var t=0;if(!e||!e.parentNode)return-1;for(;e&&(e=e.previousElementSibling);)"TEMPLATE"!==e.nodeName.toUpperCase()&&e!==Le&&t++;return t}function R(e,t){if(e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}function x(e,t){return function(){if(!$e){var o=arguments,n=this;$e=Y(function(){1===o.length?e.call(n,o[0]):e.apply(n,o),$e=void 0},t)}}}function v(){clearTimeout($e),$e=void 0}function C(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function A(e){return i&&i.dom?i.dom(e).cloneNode(!0):W?W(e).clone(!0)[0]:e.cloneNode(!0)}function L(e){de.length=0;for(var t=e.getElementsByTagName("input"),o=t.length,n;o--;)n=t[o],n.checked&&de.push(n)}function I(e){return Y(e,0)}function w(e){return clearTimeout(e)}function T(e,t,o,n){if(e.getBoundingClientRect||e===H){var a,r,s,i,p,c,u;if(e!==H&&e!==fe()?(a=e.getBoundingClientRect(),r=a.top,s=a.left,i=a.bottom,p=a.right,c=a.height,u=a.width):(r=0,s=0,i=window.innerHeight,p=window.innerWidth,c=window.innerHeight,u=window.innerWidth),n&&e!==H&&(o=o||e.parentNode,!K))do if(o&&o.getBoundingClientRect&&"none"!==l(o,"transform")){var m=o.getBoundingClientRect();r-=m.top+X(l(o,"border-top-width")),s-=m.left+X(l(o,"border-left-width")),i=r+a.height,p=s+a.width;break}while(o=o.parentNode);if(t&&e!==H){var g=d(o||e),f=g&&g.a,y=g&&g.d;g&&(r/=y,s/=f,u/=f,c/=y,i=r+c,p=s+u)}return{top:r,left:s,bottom:i,right:p,width:u,height:c}}}function N(e,t){for(var o=ge(e,!0),n=T(e)[t];o;){var a=T(o)[t],r;if(r="top"===t||"left"===t?n>=a:n<=a,!r)return o;if(o===fe())break;o=ge(o,!1)}return!1}function O(e){var t=0,o=0,n=fe();if(e)do{var a=d(e),r=a.a,s=a.d;t+=e.scrollLeft*r,o+=e.scrollTop*s}while(e!==n&&(e=e.parentNode));return[t,o]}if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var M=[],D=!1,G=!1,k=!1,U=[],q=!1,j=!1,V=[],B=/\s+/g,F="Sortable"+new Date().getTime(),H=window,z=H.document,X=H.parseInt,Y=H.setTimeout,W=H.jQuery||H.Zepto,i=H.Polymer,y={capture:!1,passive:!1},K=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),Q=!!navigator.userAgent.match(/Edge/i),J=!!navigator.userAgent.match(/firefox/i),Z=!(!navigator.userAgent.match(/safari/i)||navigator.userAgent.match(/chrome/i)||navigator.userAgent.match(/android/i)),$=!!navigator.userAgent.match(/iP(ad|od|hone)/i),ee=$,te=Q||K?"cssFloat":"float",oe=("draggable"in z.createElement("div")),ne=function(){if(K)return!1;var e=z.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}(),ae=!1,re=!1,se=Math.abs,ie=Math.min,le=Math.max,de=[],pe=function(e,t){var o=l(e),n=X(o.width)-X(o.paddingLeft)-X(o.paddingRight)-X(o.borderLeftWidth)-X(o.borderRightWidth),a=f(e,0,t),r=f(e,1,t),s=a&&l(a),i=r&&l(r),d=s&&X(s.marginLeft)+X(s.marginRight)+T(a).width,p=i&&X(i.marginLeft)+X(i.marginRight)+T(r).width;if("flex"===o.display)return"column"===o.flexDirection||"column-reverse"===o.flexDirection?"vertical":"horizontal";if("grid"===o.display)return 1>=o.gridTemplateColumns.split(" ").length?"vertical":"horizontal";if(a&&"none"!==s.float){var c="left"===s.float?"left":"right";return r&&("both"===i.clear||i.clear===c)?"vertical":"horizontal"}return a&&("block"===s.display||"flex"===s.display||"table"===s.display||"grid"===s.display||d>=n&&"none"===o[te]||r&&"none"===o[te]&&d+p>n)?"vertical":"horizontal"},ce=function(e,t){for(var o=0;o<U.length;o++)if(!_(U[o])){var n=T(U[o]),a=U[o][F].options.emptyInsertThreshold,r=e>=n.left-a&&e<=n.right+a,s=t>=n.top-a&&t<=n.bottom+a;if(r&&s)return U[o]}},ue=function(e,t,o,n){var a=T(o),r="vertical"===n?a.left:a.top,s="vertical"===n?a.right:a.bottom,i="vertical"===n?e:t;return r<i&&i<s},me=function(e,t,o){var n=e===ve&&Je||T(e),a=t===ve&&Je||T(t),r="vertical"===o?n.left:n.top,s="vertical"===o?n.right:n.bottom,i="vertical"===o?n.width:n.height,l="vertical"===o?a.left:a.top,d="vertical"===o?a.right:a.bottom,p="vertical"===o?a.width:a.height;return r===l||s===d||r+i/2===l+p/2},ge=function(e,t){if(!e||!e.getBoundingClientRect)return fe();var o=e,n=!1;do if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var a=l(o);if(o.clientWidth<o.scrollWidth&&("auto"==a.overflowX||"scroll"==a.overflowX)||o.clientHeight<o.scrollHeight&&("auto"==a.overflowY||"scroll"==a.overflowY)){if(!o||!o.getBoundingClientRect||o===z.body)return fe();if(n||t)return o;n=!0}}while(o=o.parentNode);return fe()},fe=function(){return K?z.documentElement:z.scrollingElement},ye=function(e,t,o){e.scrollLeft+=t,e.scrollTop+=o},_e=x(function(t,o,n,a){if(o.scroll){var r=n?n[F]:window,s=o.scrollSensitivity,d=o.scrollSpeed,p=t.clientX,c=t.clientY,u=fe(),m=!1;Oe!==n&&(Ee(),Ne=o.scroll,Me=o.scrollFn,!0===Ne&&(Ne=ge(n,!0),Oe=Ne));var g=0,f=Ne;do{var y=f,_=T(y),E=_.top,h=_.bottom,b=_.left,S=_.right,P=_.width,R=_.height,x,v,C,A,L,I,w,N,O;if(x=y.scrollWidth,v=y.scrollHeight,C=l(y),N=y.scrollLeft,O=y.scrollTop,y===u?(I=P<x&&("auto"===C.overflowX||"scroll"===C.overflowX||"visible"===C.overflowX),w=R<v&&("auto"===C.overflowY||"scroll"===C.overflowY||"visible"===C.overflowY)):(I=P<x&&("auto"===C.overflowX||"scroll"===C.overflowX),w=R<v&&("auto"===C.overflowY||"scroll"===C.overflowY)),A=I&&(se(S-p)<=s&&N+P<x)-(se(b-p)<=s&&!!N),L=w&&(se(h-c)<=s&&O+R<v)-(se(E-c)<=s&&!!O),!M[g])for(var G=0;G<=g;G++)M[G]||(M[G]={});(M[g].vx!=A||M[g].vy!=L||M[g].el!==y)&&(M[g].el=y,M[g].vx=A,M[g].vy=L,clearInterval(M[g].pid),y&&(0!=A||0!=L)&&(m=!0,M[g].pid=setInterval(function(){a&&0===this.layer&&(e.active._emulateDragOver(!0),e.active._onTouchMove(Fe,!0));var o=M[this.layer].vy?M[this.layer].vy*d:0,n=M[this.layer].vx?M[this.layer].vx*d:0;"function"==typeof Me&&"continue"!==Me.call(r,n,o,t,Fe,M[this.layer].el)||ye(M[this.layer].el,n,o)}.bind({layer:g}),24))),g++}while(o.bubbleScroll&&f!==u&&(f=ge(f,!1)));D=m}},30),Ee=function(){M.forEach(function(e){clearInterval(e.pid)}),M=[]},he=function(e){function t(e,o){return function(n,a,r,s){var i=n.options.group.name&&a.options.group.name&&n.options.group.name===a.options.group.name;if(null==e&&(o||i))return!0;if(null==e||!1===e)return!1;if(o&&"clone"===e)return e;if("function"==typeof e)return t(e(n,a,r,s),o)(n,a,r,s);var l=(o?n:a).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&-1<e.indexOf(l)}}var o={},n=e.group;n&&"object"==typeof n||(n={name:n}),o.name=n.name,o.checkPull=t(n.pull,!0),o.checkPut=t(n.put),o.revertClone=n.revertClone,e.group=o},be=function(e){ve&&ve.parentNode&&(!ve.parentNode[F]||ve.parentNode[F]._computeIsAligned(e))},Se=function(e,t){for(var o=t;!o[F];)o=o.parentNode;return e===o},Pe=function(e,t,o){for(var n=e.parentNode;n&&!n[F];)n=n.parentNode;n&&n[F][o](C(t,{artificialBubble:!0}))},Re=function(){!ne&&Ae&&l(Ae,"display","none")},xe=function(){!ne&&Ae&&l(Ae,"display","")},ve,Ce,Ae,Le,Ie,we,Te,Ne,Oe,Me,De,Ge,ke,Ue,qe,je,Ve,Be,Fe,He,ze,Xe,Ye,We,Ke,Qe,Je;z.addEventListener("click",function(e){if(k)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),k=!1,!1},!0);var Ze=function(e){if(e=e.touches?e.touches[0]:e,ve){var t=ce(e.clientX,e.clientY);t&&t[F]._onDragOver({clientX:e.clientX,clientY:e.clientY,target:t,rootEl:t})}};a(z,"dragover",Ze),a(z,"mousemove",Ze),a(z,"touchmove",Ze),e.prototype={constructor:e,_computeIsAligned:function(e){var o;if((Ae&&!ne?(Re(),o=z.elementFromPoint(e.clientX,e.clientY),xe()):o=e.target,o=t(o,this.options.draggable,this.el,!1),!re)&&ve&&ve.parentNode===this.el){for(var n=this.el.children,a=0;a<n.length;a++)t(n[a],this.options.draggable,this.el,!1)&&n[a]!==o&&(n[a].sortableMouseAligned=ue(e.clientX,e.clientY,n[a],this._getDirection(e,null),this.options));t(o,this.options.draggable,this.el,!0)||(ze=null),re=!0,Y(function(){re=!1},30)}},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,ve):this.options.direction},_onTapStart:function(e){if(e.cancelable){var o=this,n=this.el,a=this.options,r=a.preventOnFilter,s=e.type,i=e.touches&&e.touches[0],l=(i||e).target,d=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,p=a.filter,u;if((L(n),!K||e.artificialBubble||Se(n,l))&&!ve&&!(/mousedown|pointerdown/.test(s)&&0!==e.button||a.disabled)&&!d.isContentEditable){if(l=t(l,a.draggable,n,!1),!l)return void(K&&Pe(n,e,"_onTapStart"));if(Te!==l){if(u=P(l,a.draggable),"function"==typeof p){if(p.call(this,e,l,this))return c(o,d,"filter",l,n,n,u),void(r&&e.cancelable&&e.preventDefault());}else if(p&&(p=p.split(",").some(function(e){if(e=t(d,e.trim(),n,!1),e)return c(o,e,"filter",l,n,n,u),!0}),p))return void(r&&e.cancelable&&e.preventDefault());a.handle&&!t(d,a.handle,n,!1)||this._prepareDragStart(e,i,l,u)}}}},_handleAutoScroll:function(e,t){if(ve&&this.options.scroll){var o=e.clientX,n=e.clientY,a=z.elementFromPoint(o,n),r=this;if(t||Q||K||Z){_e(e,r.options,a,t);var s=ge(a,!0);D&&(!qe||o!==je||n!==Ve)&&(qe&&clearInterval(qe),qe=setInterval(function(){if(ve){var a=ge(z.elementFromPoint(o,n),!0);a!==s&&(s=a,Ee(),_e(e,r.options,s,t))}},10),je=o,Ve=n)}else{if(!r.options.bubbleScroll||ge(a,!0)===fe())return void Ee();_e(e,r.options,ge(a,!1),!1)}}},_prepareDragStart:function(e,t,o,n){var r=this,i=r.el,l=r.options,d=i.ownerDocument,u;o&&!ve&&o.parentNode===i&&(Ie=i,ve=o,Ce=ve.parentNode,we=ve.nextSibling,Te=o,ke=l.group,De=n,Be={target:ve,clientX:(t||e).clientX,clientY:(t||e).clientY},this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,ve.style["will-change"]="all",ve.style.transition="",ve.style.transform="",u=function(){r._disableDelayedDragEvents(),!J&&r.nativeDraggable&&(ve.draggable=!0),r._triggerDragStart(e,t),c(r,Ie,"choose",ve,Ie,Ie,De),s(ve,l.chosenClass,!0)},l.ignore.split(",").forEach(function(e){p(ve,e.trim(),m)}),l.supportPointer?a(d,"pointerup",r._onDrop):(a(d,"mouseup",r._onDrop),a(d,"touchend",r._onDrop),a(d,"touchcancel",r._onDrop)),J&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ve.draggable=!0),!l.delay||this.nativeDraggable&&(Q||K)?u():(a(d,"mouseup",r._disableDelayedDrag),a(d,"touchend",r._disableDelayedDrag),a(d,"touchcancel",r._disableDelayedDrag),a(d,"mousemove",r._delayedDragTouchMoveHandler),a(d,"touchmove",r._delayedDragTouchMoveHandler),l.supportPointer&&a(d,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=Y(u,l.delay)))},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;le(se(e.clientX-this._lastX),se(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ve&&m(ve),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;r(e,"mouseup",this._disableDelayedDrag),r(e,"touchend",this._disableDelayedDrag),r(e,"touchcancel",this._disableDelayedDrag),r(e,"mousemove",this._delayedDragTouchMoveHandler),r(e,"touchmove",this._delayedDragTouchMoveHandler),r(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||("touch"==e.pointerType?e:null),!this.nativeDraggable||t?this.options.supportPointer?a(z,"pointermove",this._onTouchMove):t?a(z,"touchmove",this._onTouchMove):a(z,"mousemove",this._onTouchMove):(a(ve,"dragend",this),a(Ie,"dragstart",this._onDragStart));try{z.selection?I(function(){z.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(t,o){if(G=!1,Ie&&ve){this.nativeDraggable&&(a(z,"dragover",this._handleAutoScroll),a(z,"dragover",be));var n=this.options;t||s(ve,n.dragClass,!1),s(ve,n.ghostClass,!0),l(ve,"transform",""),e.active=this,t&&this._appendGhost(),c(this,Ie,"start",ve,Ie,Ie,De,void 0,o)}else this._nulling()},_emulateDragOver:function(e){if(Fe){if(this._lastX===Fe.clientX&&this._lastY===Fe.clientY&&!e)return;this._lastX=Fe.clientX,this._lastY=Fe.clientY,Re();for(var t=z.elementFromPoint(Fe.clientX,Fe.clientY),o=t;t&&t.shadowRoot;)t=t.shadowRoot.elementFromPoint(Fe.clientX,Fe.clientY),o=t;if(o)do{if(o[F]){var n;if(n=o[F]._onDragOver({clientX:Fe.clientX,clientY:Fe.clientY,target:t,rootEl:o}),n&&!this.options.dragoverBubble)break}t=o}while(o=o.parentNode);ve.parentNode[F]._computeIsAligned(Fe),xe()}},_onTouchMove:function(t,o){if(Be){var n=this.options,a=n.fallbackTolerance,r=n.fallbackOffset,s=t.touches?t.touches[0]:t,i=Ae&&d(Ae),p=Ae&&i&&i.a,c=Ae&&i&&i.d,u=ee&&Ke&&O(Ke),m=(s.clientX-Be.clientX+r.x)/(p||1)+(u?u[0]-V[0]:0)/(p||1),g=(s.clientY-Be.clientY+r.y)/(c||1)+(u?u[1]-V[1]:0)/(c||1),f=t.touches?"translate3d("+m+"px,"+g+"px,0)":"translate("+m+"px,"+g+"px)";if(!e.active&&!G){if(a&&ie(se(s.clientX-this._lastX),se(s.clientY-this._lastY))<a)return;this._onDragStart(t,!0)}o||this._handleAutoScroll(s,!0),He=!0,Fe=s,l(Ae,"webkitTransform",f),l(Ae,"mozTransform",f),l(Ae,"msTransform",f),l(Ae,"transform",f),t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!Ae){var e=this.options.fallbackOnBody?z.body:Ie,t=T(ve,!0,e,!ee),o=l(ve),n=this.options;if(ee){for(Ke=e;"static"===l(Ke,"position")&&"none"===l(Ke,"transform")&&Ke!==z;)Ke=Ke.parentNode;if(Ke!==z){var a=T(Ke,!0);t.top-=a.top,t.left-=a.left}Ke!==z.body&&Ke!==z.documentElement?(Ke===z&&(Ke=fe()),t.top+=Ke.scrollTop,t.left+=Ke.scrollLeft):Ke=fe(),V=O(Ke)}Ae=ve.cloneNode(!0),s(Ae,n.ghostClass,!1),s(Ae,n.fallbackClass,!0),s(Ae,n.dragClass,!0),l(Ae,"box-sizing","border-box"),l(Ae,"margin",0),l(Ae,"top",t.top),l(Ae,"left",t.left),l(Ae,"width",t.width),l(Ae,"height",t.height),l(Ae,"opacity","0.8"),l(Ae,"position",ee?"absolute":"fixed"),l(Ae,"zIndex","100000"),l(Ae,"pointerEvents","none"),e.appendChild(Ae)}},_onDragStart:function(e,t){var o=this,n=e.dataTransfer,i=o.options;Le=A(ve),Le.draggable=!1,Le.style["will-change"]="",this._hideClone(),s(Le,o.options.chosenClass,!1),o._cloneId=I(function(){o.options.removeCloneOnHide||Ie.insertBefore(Le,ve),c(o,Ie,"clone",ve)}),t||s(ve,i.dragClass,!0),t?(k=!0,o._loopId=setInterval(o._emulateDragOver,50)):(r(z,"mouseup",o._onDrop),r(z,"touchend",o._onDrop),r(z,"touchcancel",o._onDrop),n&&(n.effectAllowed="move",i.setData&&i.setData.call(o,n,ve)),a(z,"drop",o),l(ve,"transform","translateZ(0)")),G=!0,o._dragStartId=I(o._dragStarted.bind(o,t,e)),a(z,"selectstart",o),Z&&l(z.body,"user-select","none")},_onDragOver:function(o){function n(t){return t&&(m?p._hideClone():p._showClone(y),p&&(s(ve,Ue?Ue.options.ghostClass:p.options.ghostClass,!1),s(ve,l.ghostClass,!0)),Ue!==y&&y!==e.active?Ue=y:y===e.active&&(Ue=null),S&&y._animate(S,ve),i&&R&&y._animate(R,i)),(i!==ve||ve.animated)&&(i!==r||i.animated)||(ze=null),l.dragoverBubble||o.rootEl||i===z||(y._handleAutoScroll(o),ve.parentNode[F]._computeIsAligned(o)),!l.dragoverBubble&&o.stopPropagation&&o.stopPropagation(),!0}function a(){c(y,Ie,"change",i,r,Ie,De,P(ve,l.draggable),o)}var r=this.el,i=o.target,l=this.options,d=l.group,p=e.active,m=ke===d,f=l.sort,y=this,S,R,x;if(!ae&&(!K||o.rootEl||o.artificialBubble||Se(r,i))){if(void 0!==o.preventDefault&&o.cancelable&&o.preventDefault(),He=!0,i=t(i,l.draggable,r,!0),!!t(o.target,null,ve,!0)||i.animated)return n(!1);if(i!==ve&&(k=!1),p&&!l.disabled&&(m?f||(x=!Ie.contains(ve)):Ue===this||(this.lastPutMode=ke.checkPull(this,p,ve,o))&&d.checkPut(this,p,ve,o))){var v=this._getDirection(o,i);if(S=T(ve),x)return this._hideClone(),Ce=Ie,we?Ie.insertBefore(ve,we):Ie.appendChild(ve),n(!0);var C=_(r);if(!C||E(o,v,r)&&!C.animated){if(C&&r===o.target&&(i=C),i&&(R=T(i)),m?p._hideClone():p._showClone(this),!1!==u(Ie,r,ve,S,i,R,o,!!i))return r.appendChild(ve),Ce=r,Je=null,a(),n(!0);}else if(i&&i!==ve&&i.parentNode===r){var A=0,L=i.sortableMouseAligned,I=ve.parentNode!==r,w="vertical"===v?"top":"left",O=N(i,"top")||N(ve,"top"),M=O?O.scrollTop:void 0,D;if(ze!==i&&(Ye=null,D=T(i)[w],q=!1),me(ve,i,v)&&L||I||O||l.invertSwap||"insert"===Ye||"swap"===Ye?("swap"!==Ye&&(j=l.invertSwap||I),A=h(o,i,v,l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,j,ze===i),Ye="swap"):(A=b(i),Ye="insert"),0===A)return n(!1);Je=null,ze=i,Xe=A,R=T(i);var G=i.nextElementSibling,U=!1;U=1===A;var V=u(Ie,r,ve,S,i,R,o,U);if(!1!==V)return(1===V||-1===V)&&(U=1===V),ae=!0,Y(g,30),m?p._hideClone():p._showClone(this),U&&!G?r.appendChild(ve):i.parentNode.insertBefore(ve,U?G:i),O&&ye(O,0,M-O.scrollTop),Ce=ve.parentNode,void 0===D||j||(We=se(D-T(i)[w])),a(),n(!0)}if(r.contains(ve))return n(!1)}return K&&!o.rootEl&&Pe(r,o,"_onDragOver"),!1}},_animate:function(e,t){var o=this.options.animation;if(o){var n=T(t);if(t===ve&&(Je=n),1===e.nodeType&&(e=T(e)),e.left+e.width/2!==n.left+n.width/2||e.top+e.height/2!==n.top+n.height/2){var a=d(this.el),r=a&&a.a,s=a&&a.d;l(t,"transition","none"),l(t,"transform","translate3d("+(e.left-n.left)/(r?r:1)+"px,"+(e.top-n.top)/(s?s:1)+"px,0)"),Qe=t.offsetWidth,l(t,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),l(t,"transform","translate3d(0,0,0)")}"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=Y(function(){l(t,"transition",""),l(t,"transform",""),t.animated=!1},o)}},_offUpEvents:function(){var e=this.el.ownerDocument;r(z,"touchmove",this._onTouchMove),r(z,"pointermove",this._onTouchMove),r(e,"mouseup",this._onDrop),r(e,"touchend",this._onDrop),r(e,"pointerup",this._onDrop),r(e,"touchcancel",this._onDrop),r(z,"selectstart",this)},_onDrop:function(t){var o=this.el,n=this.options;G=!1,D=!1,j=!1,q=!1,clearInterval(this._loopId),clearInterval(qe),Ee(),v(),clearTimeout(this._dragStartTimer),w(this._cloneId),w(this._dragStartId),r(z,"mousemove",this._onTouchMove),this.nativeDraggable&&(r(z,"drop",this),r(o,"dragstart",this._onDragStart),r(z,"dragover",this._handleAutoScroll),r(z,"dragover",be)),Z&&l(z.body,"user-select",""),this._offUpEvents(),t&&(He&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),Ae&&Ae.parentNode&&Ae.parentNode.removeChild(Ae),(Ie===Ce||Ue&&"clone"!==Ue.lastPutMode)&&Le&&Le.parentNode&&Le.parentNode.removeChild(Le),ve&&(this.nativeDraggable&&r(ve,"dragend",this),m(ve),ve.style["will-change"]="",s(ve,Ue?Ue.options.ghostClass:this.options.ghostClass,!1),s(ve,this.options.chosenClass,!1),c(this,Ie,"unchoose",ve,Ce,Ie,De,null,t),Ie===Ce?ve.nextSibling!==we&&(Ge=P(ve,n.draggable),0<=Ge&&(c(this,Ie,"update",ve,Ce,Ie,De,Ge,t),c(this,Ie,"sort",ve,Ce,Ie,De,Ge,t))):(Ge=P(ve,n.draggable),0<=Ge&&(c(null,Ce,"add",ve,Ce,Ie,De,Ge,t),c(this,Ie,"remove",ve,Ce,Ie,De,Ge,t),c(null,Ce,"sort",ve,Ce,Ie,De,Ge,t),c(this,Ie,"sort",ve,Ce,Ie,De,Ge,t)),Ue&&Ue.save()),e.active&&((null==Ge||-1===Ge)&&(Ge=De),c(this,Ie,"end",ve,Ce,Ie,De,Ge,t),this.save()))),this._nulling()},_nulling:function(){Ie=ve=Ce=Ae=we=Le=Te=Ne=Oe=M.length=qe=je=Ve=Be=Fe=He=Ge=De=ze=Xe=Qe=Je=Ue=ke=e.active=null,de.forEach(function(e){e.checked=!0}),de.length=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":ve&&(this._onDragOver(e),n(e));break;case"selectstart":e.preventDefault();}},toArray:function(){for(var e=[],o=this.el.children,a=0,r=o.length,n=this.options,s;a<r;a++)s=o[a],t(s,n.draggable,this.el,!1)&&e.push(s.getAttribute(n.dataIdAttr)||S(s));return e},sort:function(e){var o={},n=this.el;this.toArray().forEach(function(e,a){var r=n.children[a];t(r,this.options.draggable,n,!1)&&(o[e]=r)},this),e.forEach(function(e){o[e]&&(n.removeChild(o[e]),n.appendChild(o[e]))})},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,o){return t(e,o||this.options.draggable,this.el,!1)},option:function(e,t){var o=this.options;return void 0===t?o[e]:void(o[e]=t,"group"===e&&he(o))},destroy:function(){var e=this.el;e[F]=null,r(e,"mousedown",this._onTapStart),r(e,"touchstart",this._onTapStart),r(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(r(e,"dragover",this),r(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),U.splice(U.indexOf(this.el),1),this.el=e=null},_hideClone:function(){Le.cloneHidden||(l(Le,"display","none"),Le.cloneHidden=!0,Le.parentNode&&this.options.removeCloneOnHide&&Le.parentNode.removeChild(Le))},_showClone:function(e){return"clone"===e.lastPutMode?void(Le.cloneHidden&&(Ie.contains(ve)&&!this.options.group.revertClone?Ie.insertBefore(Le,ve):we?Ie.insertBefore(Le,we):Ie.appendChild(Le),this.options.group.revertClone&&this._animate(ve,Le),l(Le,"display",""),Le.cloneHidden=!1)):void this._hideClone()}};var $e;return a(z,"touchmove",function(t){(e.active||G)&&t.cancelable&&t.preventDefault()}),e.utils={on:a,off:r,css:l,find:p,is:function(e,o){return!!t(e,o,e,!1)},extend:C,throttle:x,closest:t,toggleClass:s,clone:A,index:P,nextTick:I,cancelNextTick:w,detectDirection:pe,getChild:f},e.create=function(t,o){return new e(t,o)},e.version="1.8.4",e})},function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e){e=e||{};var t=e.options||{};if(!(this instanceof a))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(t&&"object"!==n(t))throw new Error("ERROR WRONG_TYPE : options should be an object");this._initialize();var o=this._initContainer(e),r=document.getElementById(t.target)||null;d["default"].call(this,{name:"BoostRelief",element:o,target:r})}o.r(t);var r=o(32),s=o(135),i=o(138),l=o(147),d=o(140),p=r["default"].getLogger("BoostRelief");a.prototype=Object.create(d["default"].prototype,{}),s["default"].assign(a.prototype,l["default"]),a.prototype.constructor=a,a.prototype.setGlobe=function(e){if(!e){for(;this._element.hasChildNodes();)this._element.removeChild(this._element.lastChild);this._element.parentNode.removeChild(this._element)}d["default"].prototype.setGlobe.call(this,e)},a.prototype.setCollapsed=function(e){if(void 0===e)return void p.error("BoostRelief:setCollapsed - missing collapsed parameter");if("boolean"!=typeof e)return void p.error("BoostRelief:setCollapsed - collapsed parameter is not a boolean");var t=this.getCollapsed();if((!e||!t)&&(e||t)){var o=document.getElementById(this._addUID("GPBoostReliefListContainer"));e?(o.style.display="block",document.getElementById(this._addUID("GPshowBoostReliefList")).checked=!0):(o.style.display="none",document.getElementById(this._addUID("GPshowBoostReliefList")).checked=!1)}},a.prototype.getCollapsed=function(){return document.getElementById(this._addUID("GPshowBoostReliefList")).checked},a.prototype._initialize=function(){this._uid=i["default"].generate(),this._layers={},this._callbacks={}},a.prototype._initContainer=function(e){var t=this._createMainContainerElement(),o=this._createMainBoostReliefShowElement(e.collapsed);t.appendChild(o);var n=this._boostReliefListContainer=this._createMainBoostReliefListContainer(),a=this._createAdvancedToolElement(e);n.appendChild(a),t.appendChild(n);var r=this._createMainPictoElement();return t.appendChild(r),n.style.display=e.collapsed?"block":"none",t},a.prototype._onChangeLayerRelief=function(t){var e=parseInt(t.target.value),o=document.getElementById(this._addUID("GPreliefValue"));o.innerHTML="x"+e,this._updateLayersRelief(e)},a.prototype._updateLayersRelief=function(e){function t(e,t){e.scale=t,o.notifyChange(e)}for(var o=this.getGlobe(),n=o.getElevationLayers(),a=0;a<n.length;a++)t(n[a],e)},a.prototype.changeBoost=function(e){var t=document.getElementById(this._addUID("GPreliefValueDiv"));if(!t)return void p.error("BoostRelief:changeBoost - boostRelief slider not loaded");e>t.max&&(e=t.max),e<t.min&&(e=t.min),this._updateLayersRelief(e),t.value=e;var o=document.getElementById(this._addUID("GPreliefValue"));o&&(o.innerHTML="x"+e)},a.prototype._resolveLayerId=function(e){var t=i["default"].name(e);return t.substring(t.indexOf("_ID_")+4)},t["default"]=a},function(e,t,o){"use strict";o.r(t);t["default"]={_addUID:function(e){var t=this._uid?e+"-"+this._uid:e;return t},_createMainContainerElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPboostRelief"),e.className="GPwidget",e},_createMainBoostReliefShowElement:function(e){var t=document.createElement("input");return t.id=this._addUID("GPshowBoostReliefList"),t.type="checkbox",e&&(t.checked=!0),t},_createAdvancedToolElement:function(e){var t=document.createElement("div");t.className="GPlayerAdvancedToolsRelief";for(var o=this._createAdvancedToolReliefElement(e.scale,e.defaultBoost),n=0;n<o.length;n++)t.appendChild(o[n]);return t},_createAdvancedToolReliefElement:function(e,t){var o=[],n=document.createElement("div");n.className="GPlayerRelief",n.title="Relief";var a=document.createElement("input");a.id=this._addUID("GPreliefValueDiv"),a.type="range",e||(e={min:1,max:50,step:1}),a.min=e.min||1,a.max=e.max||50,a.step=e.step||1;var r=1;t&&(r=t),r>a.max&&(r=a.max),r<a.min&&(r=a.min),a.value=r;var s=this;a.addEventListener?a.addEventListener("change",function(t){s._onChangeLayerRelief(t)}):a.attachEvent&&a.attachEvent("onchange",function(t){s._onChangeLayerRelief(t)}),a.addEventListener?a.addEventListener("input",function(t){s._onChangeLayerRelief(t)}):a.attachEvent&&a.attachEvent("oninput",function(t){s._onChangeLayerRelief(t)}),n.appendChild(a);var i=document.createElement("div");i.id=this._addUID("GPreliefValueDiv"),i.className="GPlayerReliefValue";var l=document.createElement("span");return l.id=this._addUID("GPreliefValue"),l.innerHTML="x1",i.appendChild(l),o.push(n),o.push(i),o},_createMainBoostReliefListContainer:function(){var e=document.createElement("div");return e.id=this._addUID("GPBoostReliefListContainer"),e.className="GPpanel",e},_createMainPictoElement:function(){var e=this,t=document.createElement("label");t.id=this._addUID("GPshowBoostReliefListPicto"),t.className="GPshowAdvancedToolPicto",t.htmlFor=this._addUID("GPshowBoostReliefList"),t.title="Afficher/Masquer le control d'exageration du relief";var o=document.createElement("span");return o.id=this._addUID("GPshowBoostReliefOpenClose"),o.className="GPshowAdvancedToolOpen",t.addEventListener("click",function(){document.getElementById(e._addUID("GPBoostReliefListContainer")).style.display=document.getElementById(e._addUID("GPshowBoostReliefList")).checked?"none":"block"}),t.appendChild(o),t}}},function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e){e=e||{};var t=e.options||{};if(!(this instanceof a))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(t&&"object"!==n(t))throw new Error("ERROR WRONG_TYPE : options should be an object");this._initialize(t);var o=this._initContainer(t);c["default"].call(this,{name:"Attributions",element:o,target:t.target,position:t.position})}o.r(t);var r=o(133),s=o(32),i=o(135),l=o(138),d=o(149),p=o(150),c=o(140),u=s["default"].getLogger("Attributions");a.prototype=Object.create(c["default"].prototype,{}),i["default"].assign(a.prototype,p["default"]),a.prototype.constructor=a,a.prototype.setGlobe=function(e){if(e){var t=this;this._callbacks.onPreRenderCallBack=function(o){var e=o.colorLayersId.concat(o.elevationLayersId);t._inRangeUpdate(e,o.extent)},e.listen(r["default"].EVENTS.PRE_RENDER,this._callbacks.onPreRenderCallBack),e.preRenderEventFetchViewExtent(),e.preRenderEventFetchLayersDisplayed()}else{for(this._globe.forget(r["default"].EVENTS.PRE_RENDER,this._callbacks.onPreRenderCallBack);this._element.hasChildNodes();)this._element.removeChild(this._element.lastChild);this._element.parentNode.removeChild(this._element)}c["default"].prototype.setGlobe.call(this,e)},a.prototype.setCollapsed=function(e){if(void 0===e)return void u.error("Attributions:setCollapsed - missing collapsed parameter");var t=this.getCollapsed();e&&t||!e&&!t||(document.getElementById(this._addUID("GPshowAttributionsList")).checked=!e)},a.prototype.getCollapsed=function(){return!document.getElementById(this._addUID("GPshowAttributionsList")).checked},a.prototype._initialize=function(e){this._uid=l["default"].generate(),this._AttributionContainer=null,this._callbacks={},this._options=e},a.prototype._initContainer=function(e){var t=this._createMainContainerElement(),o=this._createMainAttributionsShowElement();t.appendChild(o),e.collapsed||(o.checked="checked");var n=this._attributionListContainer=this._createMainAttributionsListContainer(),a=this._createAttributionsList();n.appendChild(a),t.appendChild(n);var r=this._createMainPictoElement(e.collapsed);return t.appendChild(r),t},a.prototype._inRangeUpdate=function(e,t){for(var o=this.getGlobe(),n=1/o.getScale(),a=new Map,r=0;r<e.length;r++){var s=o.getLayerById(e[r]),i=s.source.attribution;if(i)for(var l=0;l<i.length;l++)if(!a.has(i[l].name)){if(!i[l].constraints||!i[l].constraints[0]){a.set(i[l].name,i[l]);continue}if(i[l].constraints[0].minScaleDenominator)if(i[l].constraints[0].minScaleDenominator===i[l].constraints[0].maxScaleDenominator){var p=d["default"].getZoomLevelFromScaleDenominator(i[l].constraints[0].minScaleDenominator),c=(this._resolutionsWGS84[p]+this._resolutionsWGS84[p-1])/(2*28e-5),u=(this._resolutionsWGS84[p]+this._resolutionsWGS84[p+1])/(2*28e-5);if(!(c>n&&n>u))continue}else if(!(i[l].constraints[0].minScaleDenominator<n&&n<i[l].constraints[0].maxScaleDenominator))continue;if(i[l].constraints[0].bbox){var m=i[l].constraints[0].bbox.left<=t.east&&t.west<=i[l].constraints[0].bbox.right,g=i[l].constraints[0].bbox.bottom<=t.north&&t.south<=i[l].constraints[0].bbox.top;m&&g&&a.set(i[l].name,i[l])}else i[l].constraints[0].bbox||a.set(i[l].name,i[l])}}this._updateAttributionListContainer(a)},a.prototype._updateAttributionListContainer=function(e){var t=document.getElementById(this._addUID("GPAttributionsList"));document.getElementById(this._addUID("GPAttributionsList")).parentNode.removeChild(t);var o=this._createAttributionsList();e.forEach(function(e){var t=document.createElement("li"),n=document.createElement("a");n.href=e.url,n.innerHTML=e.name+"&nbsp",n.target="_blank",t.id=e.name.replace(/\s/g,""),t.appendChild(n),o.appendChild(t)}),this._attributionListContainer.appendChild(o)},a.prototype._resolutionsWGS84={0:156543.033928041,1:78271.51696402048,2:39135.758482010235,3:19567.87924100512,4:9783.93962050256,5:4891.96981025128,6:2445.98490512564,7:1222.99245256282,8:611.49622628141,9:305.7481131407048,10:152.8740565703525,11:76.43702828517624,12:38.21851414258813,13:19.10925707129406,14:9.554628535647032,15:4.777314267823516,16:2.388657133911758,17:1.194328566955879,18:.5971642834779395,19:.2985821417389697,20:.1492910708694849,21:.0746455354347424},t["default"]=a},function(e,t,o){"use strict";o.r(t);t["default"]={getZoomLevelFromScaleDenominator:function(e,t){var o={};switch(t){case"EPSG:2154":o={0:104579.224549894,1:52277.5323537905,2:26135.4870785954,3:13066.8913818,4:6533.2286041135,5:3266.5595244627,6:1633.2660045974,7:816.629554986,8:408.3139146768,9:204.1567415109,10:102.0783167832,11:51.0391448966,12:25.5195690743,13:12.7597836936,14:6.379891636,15:3.1899457653,16:1.5949728695,17:.7974864315,18:.3987432149,19:.1993716073,20:.0996858037,21:.0498429018};break;default:o={0:156543.033928041,1:78271.51696402048,2:39135.758482010235,3:19567.87924100512,4:9783.93962050256,5:4891.96981025128,6:2445.98490512564,7:1222.99245256282,8:611.49622628141,9:305.7481131407048,10:152.8740565703525,11:76.43702828517624,12:38.21851414258813,13:19.10925707129406,14:9.554628535647032,15:4.777314267823516,16:2.388657133911758,17:1.194328566955879,18:.5971642834779395,19:.2985821417389697,20:.1492910708694849,21:.0746455354347424};}for(var n in o)if(o.hasOwnProperty(n)&&o[n]<=28e-5*e)return n=parseInt(n,10),n;return 0},getAttributions:function(e){var t=e.zoom,o=[];if(null!=e.originators&&e.visibility)for(var n=0,a=e.originators.length,r;n<a;n++){r=!0;for(var s=e.originators[n],i=e.originators[n].constraints||[],l=0,d=i.length,p;l<d;l++){p=i[l],r=!0;var c=this.getZoomLevelFromScaleDenominator(p.maxScaleDenominator,e.crs),u=this.getZoomLevelFromScaleDenominator(p.minScaleDenominator,e.crs)||21;c&&c>t&&(r=!1),r&&null!==u&&u<t&&(r=!1);var m=p.bbox;if(r&&m){r=!1;var g=e.extent;if(g){var f=[m.top,m.left,m.bottom,m.right];if(this.intersects(g,f)){r=!0;break}}}}if(r){var y=s.logo,_=s.url,E=s.name?s.name:"",h=s.attribution,b=document.createElement("div");b.className="gp-control-attribution";var S=null;S=document.createElement("a"),S.className="gp-control-attribution-link",S.target="_blank",b.appendChild(S),_&&(S.href=_);var P=null;!!y?(P=document.createElement("img"),S?(P.className="gp-control-attribution-image",S.appendChild(P)):(P.className="",b.appendChild(P)),P.src=y,P.title=h||E,P.style.height="30px",P.style.width="30px"):E?S.textContent=E:h?S.textContent=h:_?S.textContent=_:S.textContent="",o.push(b.innerHTML+" ")}}return o},intersects:function(e,t){var o=e[1]<=t[3]&&t[1]<=e[3],n=e[2]<=t[0]&&t[2]<=e[0];return o&&n}}},function(e,t,o){"use strict";o.r(t);t["default"]={_addUID:function(e){var t=this._uid?e+"-"+this._uid:e;return t},_createMainContainerElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPAttribution"),e.className="GPwidget",e},_createMainAttributionsShowElement:function(){var e=document.createElement("input");return e.id=this._addUID("GPshowAttributionsList"),e.type="checkbox",e},_createAttributionsList:function(){var e=document.createElement("ul");return e.id=this._addUID("GPAttributionsList"),e},_createMainAttributionsListContainer:function(){var e=document.createElement("div");return e.id=this._addUID("GPAttributionsListContainer"),e},_createMainPictoElement:function(e){var t=this,o=document.createElement("label");o.id=this._addUID("GPshowAttributionsListPicto"),o.className="GPshowAdvancedToolPicto",o.htmlFor=this._addUID("GPshowAttributionsList"),o.title="Afficher/masquer les attributions";var n=document.createElement("span");return n.id=this._addUID("GPshowAttributionsListOpenClose"),n.className="GPshowAdvancedToolOpen",n.innerHTML=e?"i":"\xBB",n.addEventListener("click",function(){n.innerHTML=document.getElementById(t._addUID("GPshowAttributionsList")).checked?"i":"\xBB"}),o.appendChild(n),o}}},function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e){if(!(this instanceof a))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if("object"!==n(e))throw new Error("ERROR WRONG_TYPE : options should be an object");this._initialize();var t=this._initContainer();d["default"].call(this,{name:"GraphicScale",element:t,target:e.target,position:e.position})}o.r(t);var r=o(133),s=o(135),i=o(138),l=o(152),d=o(140);a.prototype=Object.create(d["default"].prototype,{}),s["default"].assign(a.prototype,l["default"]),a.prototype.constructor=a,a.prototype.setGlobe=function(e){if(e){var t=this;this._callbacks.onChangedViewCallback=function(){var o=e.pixelsToMeters(200);o=Math.floor(o);var n=Math.pow(10,o.toString().length-1);o=Math.round(o/n)*n;var a=e.metersToPixels(o),r="m";1e3<=o&&(o/=1e3,r="km"),t.getElement().innerHTML=o+" "+r,t.getElement().style.width=a+"px"},e.isInitialized()?this._callbacks.onChangedViewCallback():e.listen(r["default"].EVENTS.GLOBE_INITIALIZED,this._callbacks.onChangedViewCallback),e.listen(r["default"].EVENTS.RANGE_CHANGED,this._callbacks.onChangedViewCallback)}else if(null==e){for(this._globe.forget(r["default"].EVENTS.GLOBE_INITIALIZED,this._callbacks.onChangedViewCallback),this._globe.forget(r["default"].EVENTS.RANGE_CHANGED,this._callbacks.onChangedViewCallback);this.getElement().hasChildNodes();)this.getElement().removeChild(this.getElement().lastChild);this.getElement().parentNode.removeChild(this.getElement())}d["default"].prototype.setGlobe.call(this,e)},a.prototype._initialize=function(){this._uid=i["default"].generate(),this._ScaleContainer=null,this._callbacks={}},a.prototype._initContainer=function(){var e=this._createMainContainerElement();return e},t["default"]=a},function(e,t,o){"use strict";o.r(t);t["default"]={_addUID:function(e){var t=this._uid?e+"-"+this._uid:e;return t},_createMainContainerElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPscaleContainer"),e.className="GPwidget",e}}},function(e,t,o){"use strict";function n(e){"@babel/helpers - typeof";return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e){if(e=e||{},!(this instanceof a))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(e&&"object"!==n(e))throw new Error("ERROR WRONG_TYPE : options should be an object");this._initialize();var t=this._initContainer();this._options=e,d["default"].call(this,{name:"Overview",element:t,target:e.target,position:e.position})}o.r(t);var r=o(133),s=o(135),i=o(138),l=o(154),d=o(140);a.prototype=Object.create(d["default"].prototype,{}),s["default"].assign(a.prototype,l["default"]),a.prototype.constructor=a,a.prototype.setGlobe=function(e){if(e){var t=e.getCenter(),o=new r["default"](this._element,t,{maxSubdivisionLevel:6,sseSubdivisionThreshold:3,noControls:!0});o.setBackground();var n=function(){var t=e.getGlobeView().camera.camera3D.position.length(),n=Math.min(Math.max(t,6650000),3e7),a=o.getGlobeView().camera.camera3D,r=e.getGlobeView().controls.getCameraTargetPosition();a.position.copy(r).setLength(n),a.lookAt(r),o.notifyChange(a)};e.listen(r["default"].EVENTS.AFTER_RENDER,n),e.isInitialized()?n():e.listen(r["default"].EVENTS.GLOBE_INITIALIZED,n);var a=this._options.layer;o.addLayer(a),this._globeObj=o}else if(null==e){for(;this.getElement().hasChildNodes();)this.getElement().removeChild(this.getElement().lastChild);this.getElement().parentNode.removeChild(this.getElement())}d["default"].prototype.setGlobe.call(this,e)},a.prototype._initialize=function(){this._uid=i["default"].generate(),this._MiniGlobeContainer=null,this._callbacks={}},a.prototype._initContainer=function(){var e=this._createMainContainerElement();return e},t["default"]=a},function(e,t,o){"use strict";o.r(t);t["default"]={_addUID:function(e){var t=this._uid?e+"-"+this._uid:e;return t},_createMainContainerElement:function(){var e=document.createElement("div");return e.id=this._addUID("GPminiglobeContainer"),e.className="GPwidget",e.style.width="100px",e.style.height="100px",e}}},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if("string"!=typeof e.layer)throw new Error("ERROR WRONG TYPE : layer");if("undefined"==typeof e.ssl&&(e.ssl=!0),!s["default"].isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html");var t=s["default"].getLayerId(e.layer,"WMTS");if(t&&s["default"].configuration.getLayerConf(t)){var o={},i=s["default"].getLayerParams(e.layer,"WMTS",e.apiKey);"EPSG:3857"===i.projection&&i.extent?i.extent=new p.Extent("EPSG:4326",i.extent.left,i.extent.right,i.extent.bottom,i.extent.top).as("EPSG:3857"):(i.projection="EPSG:4326",i.extent=new p.Extent("EPSG:4326",i.extent.left,i.extent.right,i.extent.bottom,i.extent.top)),0===Object.entries(i.tileMatrixSetLimits).length&&i.tileMatrixSetLimits.constructor===Object&&(i.tileMatrixSetLimits=void 0);var d=!1===e.ssl?"http://":"https://";return o.id=t,o.source=new p.WMTSSource({protocol:"wmts",url:i.url.replace(/(http|https):\/\//,d),networkOptions:{crossOrigin:"omit"},updateStrategy:{type:0,options:{}},projection:i.projection,attribution:i.originators,name:e.layer,format:i.format,tileMatrixSet:i.TMSLink,tileMatrixSetLimits:i.tileMatrixSetLimits,extent:{west:i.extent.west,east:i.extent.east,south:i.extent.south,north:i.extent.north}}),o.source.url=a["default"].Helper.normalyzeUrl(o.source.url,{"gp-itowns-ext":l.itownsExtVersion||l.version},!1),r["default"].mergeParams(o,e.itownsParams),o.legends=i.legends,o.metadata=i.metadata,o.description=i.description,o.title=i.title,o.quicklookUrl=i.quicklookUrl,new p.ColorLayer(o.id,o)}u.error("ERROR layer id (layer name: "+e.layer+" / service: WMTS ) was not found !?")}o.r(t);var a=o(34),r=o(135),s=o(137),i=o(32),l=o(1),d=o.t(1,1),p=o(134),c=o.n(p),u=i["default"].getLogger("wmtsLayer");n.prototype.constructor=n,t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if("string"!=typeof e.layer)throw new Error("ERROR WRONG TYPE : layer");if("undefined"==typeof e.ssl&&(e.ssl=!0),!s["default"].isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html");var t=s["default"].getLayerId(e.layer,"WMS");if(t&&s["default"].configuration.getLayerConf(t)){var o={},i=s["default"].getLayerParams(e.layer,"WMS",e.apiKey);i.extent="EPSG:3857"===i.projection&&i.extent?new p.Extent("EPSG:4326",i.extent.left,i.extent.right,i.extent.bottom,i.extent.top).as("EPSG:3857"):new p.Extent("EPSG:4326",i.extent.left,i.extent.right,i.extent.bottom,i.extent.top);var d=!1===e.ssl?"http://":"https://";return o.id=t,o.source=new p.WMSSource({protocol:"wms",version:i.version,attribution:i.originators,url:i.url.replace(/(http|https):\/\//,d),name:e.layer,projection:i.projection,style:"",heightMapWidth:256,waterMask:!1,networkOptions:{crossOrigin:"omit"},updateStrategy:{type:0,options:{}},format:i.format,extent:{west:i.extent.west,east:i.extent.east,south:i.extent.south,north:i.extent.north}}),o.source.url=a["default"].Helper.normalyzeUrl(o.source.url,{"gp-itowns-ext":l.itownsExtVersion||l.version},!1),r["default"].mergeParams(o,e.itownsParams),o.legends=i.legends,o.metadata=i.metadata,o.description=i.description,o.title=i.title,o.quicklookUrl=i.quicklookUrl,new p.ColorLayer(o.id,o)}u.error("ERROR layer id (layer name: "+e.layer+" / service: WMS ) was not found !?")}o.r(t);var a=o(34),r=o(135),s=o(137),i=o(32),l=o(1),d=o.t(1,1),p=o(134),c=o.n(p),u=i["default"].getLogger("wmsLayer");n.prototype.constructor=n,t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if("string"!=typeof e.layer)throw new Error("ERROR WRONG TYPE : layer");if("undefined"==typeof e.ssl&&(e.ssl=!1),!s["default"].isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html");var t=s["default"].getLayerId(e.layer,"WMTS");if(t&&s["default"].configuration.getLayerConf(t)){var o={},i=s["default"].getLayerParams(e.layer,"WMTS",e.apiKey);"EPSG:3857"===i.projection&&i.extent?i.extent=new p.Extent("EPSG:4326",i.extent.left,i.extent.right,i.extent.bottom,i.extent.top).as("EPSG:3857"):(i.projection="EPSG:4326",i.extent=new p.Extent("EPSG:4326",i.extent.left,i.extent.right,i.extent.bottom,i.extent.top));var d="undefined"==typeof window?"undefined"==typeof self?null:self:window,c=d?d.location&&d.location.protocol&&0===d.location.protocol.indexOf("https:")?"https://":"http://":e.ssl?"https://":"http://";return o.id=t,o.noDataValue=-99999,o.updateStrategy={type:0,options:{groups:[11,14]}},o.source=new p.WMTSSource({protocol:"wmts",url:i.url.replace(/(http|https):\/\//,c),networkOptions:{crossOrigin:"omit"},attribution:i.originators,projection:i.projection,name:e.layer,format:"image/x-bil;bits=32",tileMatrixSet:i.TMSLink,tileMatrixSetLimits:i.tileMatrixSetLimits,extent:{west:i.extent.west,east:i.extent.east,south:i.extent.south,north:i.extent.north}}),o.source.url=a["default"].Helper.normalyzeUrl(o.source.url,{"gp-itowns-ext":l.itownsExtVersion||l.version},!1),r["default"].mergeParams(o,e.itownsParams),o.legends=i.legends,o.metadata=i.metadata,o.description=i.description,o.title=i.title,o.quicklookUrl=i.quicklookUrl,new p.ElevationLayer(o.id,o)}u.log("[source WMTS] ERROR : "+e.layer+" cannot be found in Geoportal Configuration. Make sure that this resource is included in your contract key.")}o.r(t);var a=o(34),r=o(135),s=o(137),i=o(32),l=o(1),d=o.t(1,1),p=o(134),c=o.n(p),u=i["default"].getLogger("elevationLayer");n.prototype.constructor=n,t["default"]=n},function(e,t,o){"use strict";function n(e){if(!(this instanceof n))throw new TypeError("ERROR CLASS_CONSTRUCTOR");if(!e.layer)throw new Error("ERROR PARAM_MISSING : layer");if("string"!=typeof e.layer)throw new Error("ERROR WRONG TYPE : layer");if(!r["default"].isConfigLoaded())throw new Error("ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html");var t=r["default"].getLayerId(e.layer,"TMS");if(t&&r["default"].configuration.getLayerConf(t)){var o={},a=r["default"].getLayerParams(e.layer,"TMS",e.apiKey),i=!1===e.ssl?"http://":"https://";return o.id=t,o.source=new s.VectorTilesSource({style:a.url.replace(/(http|https):\/\//,i),url:e.urlService,attribution:e.attributions,filter:e.filter,zoom:e.zoom}),o.isValidData=function(){return!1},new s.ColorLayer(o.id,o)}l.error("ERROR layer id (layer name: "+e.layer+" / service: TMS ) was not found !?")}o.r(t);var a=o(32),r=o(137),s=o(134),i=o.n(s),l=a["default"].getLogger("vectorTileLayer");n.prototype.constructor=n,t["default"]=n},function(e,t,o){"use strict";o.r(t);var n=o(34);(function(){var e=document.getElementsByTagName("script"),t=e[e.length-1].getAttribute("data-key");if(t){var o=t.split(/;|,|\|/);if(t&&1<o.length){for(var a=[],r=0;r<o.length;r++)a.push(o[r]);t=a}}var s=e[e.length-1].getAttribute("data-url"),l=e[e.length-1].getAttribute("data-timeout"),d=function(){},p=function(t){throw new Error("Configuration load failed : "+t.message)};if(t||s){var c={apiKey:t,onSuccess:d,onFailure:p};s&&(c.serverUrl=s,c.callbackSuffix=""),l&&(c.timeOut=l),n["default"].Config||n["default"].Services.getConfig(c)}})()},function(e,t,o){"use strict";o.r(t);var n=o(32);t["default"]={proxifyUrl:function(e,t){var o=n["default"].getLogger("proxifyUrl");if(!t||!t.hasOwnProperty("proxyUrl")||null===t.proxyUrl||0===t.proxyUrl.trim().length)return e;if(t.noProxyDomains&&Array.isArray(t.noProxyDomains)&&0<t.noProxyDomains.length)for(var a in t.noProxyDomains)if(o.trace("[ProxyUtils] proxifyUrl : analyzing "+t.noProxyDomains[a]),-1!==e.indexOf(t.noProxyDomains[a]))return o.info("[ProxyUtils] proxifyUrl : "+e+" found in noProxyDomains list ("+t.noProxyDomains[a]+")."),e;return t.proxyUrl+encodeURIComponent(e)}}},function(e,t,o){"use strict";o.r(t);t["default"]={rgbaToHex:function(e){function t(e){if(255<e)throw new Error("'"+e+"'' is greater than 255(0xff);");var t=(+e).toString(16);return("0"+t).slice(-2)}var o=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(0?.?\d+)\s*)?\)/.exec(e);if(!o)throw new Error("Invalid format: "+e);var n=o[1],a=o[2],r=o[3],s=o[4],i=[t(n),t(a),t(r)],l={};return l.hex="#"+i.join(""),s&&(l.opacity=parseFloat(s)),l},hexToRgba:function(e,t){if(!e)throw new Error("Invalid format");e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,o,n){return t+t+o+o+n+n});var o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);o=o?{r:parseInt(o[1],16),g:parseInt(o[2],16),b:parseInt(o[3],16)}:null;var n=o?"rgba("+o.r+", "+o.g+", "+o.b+", "+t+")":null;return n}}},function(e,t,o){"use strict";o.r(t);t["default"]={modulo:function(e,t){var o=e%t;return 0>o*t?o+t:o},decimalToDMS:function(e,t,o){var n=this.modulo(e+180,360)-180,a=Math.abs(3600*n),r=Math.pow(10,o||0),s=Math.floor(a/3600),i=Math.floor((a-3600*s)/60),l=a-3600*s-60*i;l=Math.ceil(l*r)/r,60<=l&&(l=0,i+=1),60<=i&&(i=0,s+=1);var d=t.charAt(0>n?1:0);return{d:s,m:i,s:l,direction:d}},toInteger:function(e,t){var o=parseInt(e,t||10);return!isNaN(o)&&isFinite(o)?o:null},isInteger:function(e){if(isNaN(e))return!1;var t=parseFloat(e);return(0|t)===t},toFloat:function(e){var t=parseFloat(e);return!isNaN(t)&&isFinite(t)?t:null}}}])});